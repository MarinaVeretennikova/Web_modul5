  <HTML>
  <HEAD>
  
  <TITLE>Справочное руководство по MySQL версии 4.1.0-alpha. - 2  Установка MySQL</TITLE>
   <style> code {color:purple} tt {color:green} samp {color:navy} pre {color:maroon} </style> <meta http-equiv="Content-Type" content="text/html; charset=koi8-r">
  </HEAD>
  <BODY BGCOLOR=white TEXT=#000000 LINK=#101090 VLINK=#7030B0>
Go to the <A HREF="manual.ru_Introduction.html">first</A>, <A HREF="manual.ru_Introduction.html">previous</A>, <A HREF="manual.ru_Tutorial.html">next</A>, <A HREF="manual.ru_Concept_Index.html">last</A> section, <A HREF="manual.ru_toc.html">table of contents</A>.
<P><HR><P>


<H1><A NAME="Installing" HREF="manual.ru_toc.html#Installing">2  Установка MySQL</A></H1>

<P>
<A NAME="IDX170"></A>
<A NAME="IDX171"></A>

</P>

<P>
В этом разделе описаны получение и установка MySQL:

</P>

<ul>
<LI>

Список сайтов, с которых можно получить MySQL, See section <A HREF="manual.ru_Installing.html#Getting_MySQL">2.2.1  Как получить MySQL</A>.
<LI>

Чтобы узнать о поддерживаемых платформах, See section <A HREF="manual.ru_Installing.html#Which_OS">2.2.5  Операционные системы, поддерживаемые MySQL</A>. Необходимо иметь в виду, что не все поддерживаемые
системы одинаково хорошо подходят для запуска MySQL: одни из них
гораздо устойчивее и эффективнее, чем другие (за более подробной
информацией следует обращаться к разделу section <A HREF="manual.ru_Installing.html#Which_OS">2.2.5  Операционные системы, поддерживаемые MySQL</A>).
<LI>

Некоторые версии MySQL доступны как в виде бинарного дистрибутива, так
и в виде дистрибутива исходного кода. Помимо этого, всем, кто желает
ознакомиться с нашими последними разработками и помочь нам тестировать
новый код, мы обеспечиваем открытый доступ к нашему текущему дереву
исходных кодов. Чтобы определить, какую версию и тип дистрибутива вам
следует использовать, See section <A HREF="manual.ru_Installing.html#Which_version">2.2.6  Какую версию MySQL использовать</A>. Если вы сомневаетесь в том, какую
версию выбрать, лучше предпочесть бинарный дистрибутив.
<LI>

Инструкции по установке для бинарного дистрибутива и для дистрибутива
исходного кода находятся в разделах section <A HREF="manual.ru_Installing.html#Installing_binary">2.2.10  Установка бинарного дистрибутива MySQL</A> и See section <A HREF="manual.ru_Installing.html#Installing_source">2.3  Установка исходного дистрибутива MySQL</A>. В каждый набор инструкций
включен раздел с описанием специфичных для различных операционных
систем проблем, с которыми вы можете столкнуться.
<LI>

Чтобы ознакомиться с послеустановочными процедурами, See section <A HREF="manual.ru_Installing.html#Post-installation">2.4  Послеустановочные настройка и тестирование</A>. Эти
действия применимы при установке MySQL с использованием как бинарного
дистрибутива, так и дистрибутива исходного кода.
</ul>



<H2><A NAME="Quick_Standard_Installation" HREF="manual.ru_toc.html#Quick_Standard_Installation">2.1  Быстрая стандартная установка MySQL</A></H2>



<H3><A NAME="Linux-RPM" HREF="manual.ru_toc.html#Linux-RPM">2.1.1  Установка MySQL на Linux</A></H3>

<P>
<A NAME="IDX172"></A>
<A NAME="IDX173"></A>
<A NAME="IDX174"></A>

</P>
<P>
Для установки MySQL на Linux рекомендуется применять пакеты RPM. В
настоящее время RPM для MySQL создаются на операционной системе SuSE Linux 7.3,
но они должны работать также и для других версий Linux,
которые поддерживают <code>rpm</code> и используют <code>glibc</code>.

</P>
<P>
В случае возникновения проблем с файлом RPM (например, если вы получили
ошибку ``<code>Sorry, the host 'xxxx' could not be looked up</code>''), обращайтесь к
разделу See section <A HREF="manual.ru_Installing.html#Binary_notes-Linux">2.6.1.1  Примечания к бинарным дистрибутивам Linux</A>.

</P>
<P>
Доступны для использования следующие RPM-файлы:

</P>

<ul>
<LI><code>MySQL-server-VERSION.i386.rpm</code>.

Сервер MySQL. Если вам нужно только подключаться к серверу MySQL, запущенному
на другом компьютере, этот файл не требуется. Обратите внимание, что выхода
4.0.10 этот пакет назывался <code>MySQL-VERSION.i386.RPM</code>.

<LI><code>MySQL-client-VERSION.i386.rpm</code>.

Стандартные клиентские программы MySQL.
Установка этого пакета требуется всегда.

<LI><code>MySQL-bench-VERSION.i386.rpm</code>.

Тесты и контрольные задачи. Для файла
требуется наличие модулей Perl и msql-mysql-modules.

<LI><code>MySQL-devel-VERSION.i386.rpm</code>.

Библиотеки и включаемые файлы,
необходимые для компилирования других клиентов MySQL, таких как модули
Perl.

<LI><code>MySQL-shared-VERSION.i386.rpm</code>

Этот пакет содержит динамические библиотеки (<code>libmysqlclient.so*</code>), 
нужные для некоторых языков программирования или приложений для того, чтобы
работать с MySQL.

<LI><code>MySQL-embedded-VERSION.i386.rpm</code>

Встраиваемая библиотека сервера MySQL (MySQL 4.x и более новые).

<LI><code>MySQL-VERSION.src.rpm</code>.

Этот файл содержит исходный код для всех
предыдущих пакетов. Файл также можно использовать для создания файлов
RPM для других архитектур (например Alpha или SPARC).
</ul>

<P>
Для просмотра всех файлов в пакете RPM выполните команду:

</P>

<pre>
shell&#62; rpm -qpl MySQL-VERSION.i386.rpm
</pre>

<P>
Для выполнения стандартной минимальной установки запустите команду:

</P>

<pre>
shell&#62; rpm -i MySQL-server-VERSION.i386.rpm MySQL-client-VERSION.i386.rpm
</pre>

<P>
Для установки только клиентского пакета выполните команду:

</P>

<pre>
shell&#62; rpm -i MySQL-client-VERSION.i386.rpm
</pre>

<P>
RPM помещает данные в <tt>`/var/lib/mysql'</tt> и создает соответствующие вхождения
в <tt>`/etc/init.d/'</tt> для автоматического запуска сервера во время начальной
загрузки (в случае, если у вас имеется предыдущая инсталляция, можно
создать копию ранее установленного файла запуска MySQL, чтобы изменения в
нем не были утеряны.)

</P>
<P>
Если вы хотите установить MySQL RPM на старших версиях Linux, которые не поддерживают
init-скрипты в <tt>`/etc/init.d'</tt> (непосредственно или посредством символической ссылки),
вам следует создать символическую ссылку на старое расположение перед тем, как устанавливать 
RPM: 

</P>

<pre>
shell&#62; cd /etc ; ln -s rc.d/init.d .
</pre>

<P>
Однако, все современные поставки Linux должны поддерживать эту схему каталогов, т.к. 
это требование стандарта LSB (Linux Standard Base). 

</P>
<P>
После установки RPM, <code>mysqld</code> должен заработать и вы можете сразу приступать к
использованию MySQL.

</P>

<P>
See section <A HREF="manual.ru_Installing.html#Post-installation">2.4  Послеустановочные настройка и тестирование</A>.

</P>
<P>
Если при установке возникнут проблемы, то за более подробной информацией
следует обращаться к главе, в которой описывается установка из бинарного
дистрибутива. See section <A HREF="manual.ru_Installing.html#Installing_binary">2.2.10  Установка бинарного дистрибутива MySQL</A>.

</P>


<H3><A NAME="Windows_installation" HREF="manual.ru_toc.html#Windows_installation">2.1.2  Установка MySQL на Windows</A></H3>

<P>
Имеются два следующих типа дистрибутивов сервера MySQL для Windows:

</P>

<ol>
<LI>

Бинарный дистрибутив, в состав которого входит программа установки;
она устанавливает все, что нужно, так что можно сразу же запускать
сервер.
<LI>

Дистрибутив исходного кода, в котором содержится весь код и файлы
поддержки для создания исполняемых файлов с использованием компилятора
VC++ 6.0. See section <A HREF="manual.ru_Installing.html#Windows_source_build">2.3.7  Дистрибутив исходного кода для Windows</A>.
</ol>

<P>
В общем случае следует отдавать предпочтение бинарному дистрибутиву.

</P>
<P>
Вам потребуется:

<ul>
<LI>

32-разрядная операционная система Windows, такая как 9x, Me, NT, 2000
или XP. Под управлением семейства NT (NT, Windows 2000 и XP) сервер
MySQL можно запускать как сервис. See section <A HREF="manual.ru_Installing.html#NT_start">2.6.2.2  Запуск MySQL на Windows NT, 2000 или XP</A>. Если предполагается работать с таблицами
размером более 4 Гб, необходимо установить MySQL на файловую систему
NTFS или более новую. При создании таблиц не забывайте использовать
<code>MAX_ROWS</code> и <code>AVG_ROW_LENGTH</code>. See section <A HREF="manual.ru_Reference.html#CREATE_TABLE">6.5.3  Синтаксис оператора <code>CREATE TABLE</code></A>.
<LI>

Поддержка протокола TCP/IP.
<LI>

Копия бинарного кода MySQL или дистрибутив для Windows, который может
быть загружен с <a HREF="http://www.mysql.com/downloads/">http://www.mysql.com/downloads/</a>.

Примечание:
дистрибутив поставляется в виде архивных файлов, сжатых архиватором
ZIP. Во избежание повреждения файлов в процессе загрузки мы
рекомендуем использовать адекватный клиент FTP с возможностью
возобновления загрузки.
<LI>

Архиватор <code>ZIP</code> для распаковки файла дистрибутива.
<LI>

Достаточно места на жестком диске для распаковки, установки и создания
баз данных в соответствии с вашими требованиями.
<LI>

Если вы планируете подключаться к серверу MySQL через <code>ODBC</code>, то
понадобится драйвер <code>MyODBC</code>. See section <A HREF="manual.ru_Clients.html#ODBC">8.3  Поддержка ODBC в MySQL</A>.
</ul>



<H4><A NAME="Windows_binary_installation" HREF="manual.ru_toc.html#Windows_binary_installation">2.1.2.1  Установка бинарного кода</A></H4>


<ol>
<LI>

Если вы работаете на сервере NT/2000/XP, войдите в систему как
пользователь с привилегиями администратора.
<LI>

Если вы производите модернизацию более ранней установки MySQL, то
необходимо остановить сервер. Если сервер работает как сервис, то
применяйте следующую команду:


<pre>
C:\&#62; NET STOP MySQL
</pre>

В остальных случаях используйте:


<pre>
C:\mysql\bin&#62; mysqladmin -u root shutdown
</pre>

<LI>

Если вы хотите изменить исполняемый файл сервера (т.е. -max или -nt),
необходимо также удалить сервис:


<pre>
C:\mysql\bin&#62; mysqld-max-nt --remove
</pre>

<LI>

Разархивируйте файл дистрибутива во временном каталоге.
<LI>

Запустите файл <tt>`setup.exe'</tt>, чтобы начать процесс установки. Если вы
хотите установить программу в иной каталог, чем заданный по умолчанию
<tt>`c:\mysql'</tt>, то используйте кнопку <code>Browse</code> для указания выбранного вами
каталога.
<LI>

Завершите процесс установки.
</ol>



<H4><A NAME="Windows_prepare_environment" HREF="manual.ru_toc.html#Windows_prepare_environment">2.1.2.2  Подготовка конфигурации MySQL для Windows</A></H4>

<P>
Начиная с версии MySQL 3.23.38, дистрибутив для Windows включает в себя
как обычный бинарный код, так и бинарный код сервера <code>MySQL-Max</code>. Ниже
приводится список различных серверов MySQL, которые можно использовать:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><strong>Бинарный код</strong> </TD><TD> <strong>Описание</strong>
</TD></TR>
<TR><TD><code>mysqld</code> </TD><TD> Скомпилирован с полным набором возможностей отладки и автоматической проверки выделения памяти, символических ссылок, таблиц InnoDB и BDB.
</TD></TR>
<TR><TD><code>mysqld-opt</code> </TD><TD> Оптимизированный бинарный код без поддержки транзакционных таблиц.
</TD></TR>
<TR><TD><code>mysqld-nt</code> </TD><TD> Оптимизированный бинарный код для NT/2000/XP с поддержкой именованных каналов. Можно запустить эту версию на Windows 9x/Me, но в этом случае не создаются именованные каналы и необходимо иметь установленный протокол TCP/IP.
</TD></TR>
<TR><TD><code>mysqld-max</code> </TD><TD> Оптимизированный бинарный код с поддержкой символических ссылок и таблиц InnoDB и BDB.
</TD></TR>
<TR><TD><code>mysqld-max-nt</code> </TD><TD> Подобен <code>mysqld-max</code>, но скомпилирован с поддержкой именованных каналов.
</TD></TR>
</TABLE>

<P>
Начиная с версии 3.23.50, именованные каналы доступны только при запуске
mysqld с <code>--enable-named-pipe</code>.

</P>
<P>
Все бинарные коды оптимизированы под процессор Pentium Pro, но должны
работать на любом процессоре Intel &#62;= i386.

</P>
<P>
При следующих обстоятельствах для того чтобы задать вашу конфигурацию
MySQL будет необходимо использовать файл опций:

<ul>
<LI>

Если каталоги установки или данных отличаются от заданных по умолчанию
местоположений (<tt>`c:\mysql'</tt> и <tt>`c:\mysql\data'</tt>).
<LI>

Если вы хотите использовать один из следующих серверов:

<ul>
<LI>mysqld.exe

<LI>mysqld-max.exe

<LI>mysqld-max-nt.exe

</ul>

<LI>

Если вам требуется выполнить настройку установочных параметров
сервера.
</ul>

<P>
Обычно для редактирования файла опций <tt>`my.ini'</tt> можно использовать инструмент
<code>WinMySQLAdmin</code>. В этом случае остальную часть данного раздела вы можете
пропустить.

</P>
<P>
Существует два файла опций с одинаковыми функциями: <tt>`my.cnf'</tt> и <tt>`my.ini'</tt>.
Однако во избежание недоразумений лучше всего использовать только один из
них. Оба файла представляют собой простой текст. Если вы собираетесь
использовать файл <tt>`my.cnf'</tt>, то его следует создать в корневом каталоге
диска C, если <tt>`my.ini'</tt> - то в системном каталоге Windows (это обычно
что-либо вроде <tt>`C:\WINDOWS'</tt> или <tt>`C:\WINNT'</tt>; его точное местоположение
можно определить по значению переменной окружения <code>windir</code>). MySQL сначала
ищет файл <tt>`my.ini'</tt>, а затем <tt>`my.cnf'</tt>.

</P>
<P>
Если на вашем компьютере используется начальный загрузчик, в котором диск
C не является загрузочным диском, то следует работать только с файлом
<tt>`my.ini'</tt>. Инструментальная программа <code>WinMySQLAdmin</code>, если она у вас
применяется, также использует только файл <tt>`my.ini'</tt> (файл помощи с
инструкциями по использованию этого инструмента находится в каталоге
<tt>`\mysql\bin'</tt>).

</P>
<P>
Используя <code>notepad.exe</code>, создайте файл опций и отредактируйте раздел
<code>[mysqld]</code>, указав значения параметров <code>basedir</code> и <code>datadir</code>:

<pre>
[mysqld]
# set basedir to installation path, e.g., c:/mysql
basedir=the_install_path
# set datadir to location of data directory,
# e.g., c:/mysql/data or d:/mydata/data
datadir=the_data_path
</pre>

<P>
Следует учитывать, что в Windows имена путей должны указываться в файле
опций с использованием предпочтительно прямых слешей, а не обратных. Если
вы применяете обратные слеши, то их необходимо дублировать.

</P>
<P>
Чтобы использовать каталог данных, отличный от заданного по умолчанию
<tt>`c:\mysql\data'</tt>, необходимо скопировать все содержимое каталога
<tt>`c:\mysql\data'</tt> в новое местоположение.

</P>
<P>
Если вы хотите работать с транзакционными таблицами <code>InnoDB</code>, то необходимо
вручную создать два новых каталога для хранения данных таблиц <code>InnoDB</code> и
журнальных файлов - т.е. <tt>`c:\ibdata'</tt> и <tt>`c:\iblogs'</tt>. Помимо этого
потребуется добавить несколько дополнительных строк в файле опций. См.
раздел See section <A HREF="manual.ru_Table_types.html#InnoDB_start">7.5.2  Параметры запуска InnoDB</A>.

</P>
<P>
Если же работу с таблицами <code>InnoDB</code> вы не планируете, следует в файле опций
добавьте опцию <code>skip-innodb</code>.

</P>
<P>
Теперь вы готовы тестировать запуск сервера.

</P>


<H4><A NAME="Windows_server_first_start" HREF="manual.ru_toc.html#Windows_server_first_start">2.1.2.3  Первый запуск сервера</A></H4>

<P>
Тестирование лучше всего производить из окна оболочки DOS, поскольку
сообщения о состоянии, которые выводит сервер, появляются в окне DOS. Если
с вашей конфигурацией что-нибудь не так, то при помощи этих сообщений
будет легче идентифицировать и устранить любые проблемы.

</P>
<P>
Убедитесь, что находитесь в каталоге, где расположен сервер, затем введите
следующую команду:

</P>

<pre>
C:\mysql\bin&#62; mysqld-max --standalone
</pre>

<P>
При запуске сервера вы должны увидеть следующие сообщения:

</P>

<pre>
InnoDB: The first specified datafile c:\ibdata\ibdata1 did not exist:
InnoDB: a new database to be created!
InnoDB: Setting file c:\ibdata\ibdata1 size to 209715200
InnoDB: Database physically writes the file full: wait...
InnoDB: Log file c:\iblogs\ib_logfile0 did not exist: new to be created
InnoDB: Setting log file c:\iblogs\ib_logfile0 size to 31457280
InnoDB: Log file c:\iblogs\ib_logfile1 did not exist: new to be created
InnoDB: Setting log file c:\iblogs\ib_logfile1 size to 31457280
InnoDB: Log file c:\iblogs\ib_logfile2 did not exist: new to be created
InnoDB: Setting log file c:\iblogs\ib_logfile2 size to 31457280
InnoDB: Doublewrite buffer not found: creating new
InnoDB: Doublewrite buffer created
InnoDB: creating foreign key constraint system tables
InnoDB: foreign key constraint system tables created
011024 10:58:25 InnoDB: Started
</pre>

<P>
Чтобы получить дальнейшую информацию о работе MySQL под Windows,
обращайтесь к разделу See section <A HREF="manual.ru_Installing.html#Windows">2.6.2  Примечания к Windows</A>.

</P>



<H3><A NAME="Mac_OS_X_installation" HREF="manual.ru_toc.html#Mac_OS_X_installation">2.1.3  Установка MySQL на MacOS X</A></H3>

<P>
<A NAME="IDX175"></A>
<A NAME="IDX176"></A>

</P>
<P>
Начиная с MySQL 4.0.11, вы можете поставить MySQL на Mac OS X 10.2 ("Jaguar") используя
родной формат пакетов <code>PKG</code> вместо бинарного tar-архива. Обратите внимание, что
более старые версии Mac OS X (скажем, 10.1.x) не поддерживаются этим пакетом. 

</P>
<P>
Пакет находится внутри файла образа диска (<code>.dmg</code>), который вам сначала
следует смонтировать двойным щелчком мышки на его иконке в Finder. Образ должен
быть смонтирован и вы увидите его содержимое. 

</P>
<P>
<strong>Внимание</strong>: Перед тем как продолжить инсталляцию, убедитесь, что другие сервера 
MySQL не работают на этом компьютере!

</P>
<P>
Пожалуйста, остановите все запущенные копии MySQL перед тем, как продолжать. Для этого используйте
или приложение MySQL Manager (на Mac OS X Server) или с помощью
<code>mysqladmin shutdown</code> в командной строке.

</P>
<P>
Для того чтобы поставить MySQL PKG, дважды щелкните мышкой на иконке пакета. Это действие
запустит инсталлятор пакетов Mac OS, который и проведет вас через процесс установки MySQL. 

</P>
<P>
Пакет поставит себя в 
<tt>`/usr/local/mysql-&#60;версия&#62;'</tt> и также поставит символическую ссылку 
<tt>`/usr/local/mysql'</tt>, указывающую на новое месторасположение. Если каталог с именем
<tt>`/usr/local/mysql'</tt> уже существует, он будет вначале переименован в 
<tt>`/usr/local/mysql.bak'</tt>. Кроме того, будут установлены таблицы привилегий MySQL путем
выполнения <code>mysql_install_db</code> после инсталляции.

</P>
<P>
Схема инсталляции похожа на ту, которая используется в бинарной поставке: все
исполняемые файлы MySQL будут расположены по пути <tt>`/usr/local/mysql/bin'</tt>,
сокет будет расположен в <tt>`/etc/mysql.sock'</tt>.  See section <A HREF="manual.ru_Installing.html#Installation_layouts">2.2.7  Схемы установки</A>.

</P>
<P>
Необходимо чтобы существовал пользователь с именем <code>mysql</code> (который должен существовать 
по умолчанию в каждой поставке Mac OS X 10.2 и выше).

</P>
<P>
Если вы используете Mac OS X Server, у вас уже есть работающая копия MySQL: 

</P>

<ul>
<LI>

Mac OS X Server 10.2-10.2.2 идет с MySQL 3.23.51 в поставке
<LI>

Mac OS X Server 10.2.3 и 10.2.4 поставляется с MySQL 3.23.53
</ul>

<P>
Этот раздел руководства покрывает вопросы инсталляции только  официального
пакета PKG для Mac OS X.  Сначала прочитайте руководство Apple по установке
MySQL, пожалуйста (запустите приложение "Help View", выберите "Mac OS X
Server", сделайте поиск слова "MySQL" и прочитайте раздел под названием
"Installing MySQL"). 

</P>
<P>
Учтите, что преинсталлированные пакеты MySQL на Mac OS X Server запускаются с
помощью команды <code>safe_mysqld</code> вместо <code>mysqld_safe</code>!

</P>
<P>
Если вы ранее использовали пакеты MySQL Марка Лиянажа (Marc Liyanage) с сайта
<a HREF="http://www.entropy.ch">http://www.entropy.ch</a>, вы можете просто следовать инструкциям по
обновлению пакетов используя схему расположения, как указано на его страничках. 

</P>
<P>
Если вы обновляете MySQL с версии, собранной Марком или с предустановленной
версии из поставки Mac OS X Server, на официальную сборку от MySQL - вам
следует также преобразовать существующие таблицы привилегий MySQL.
See section <A HREF="manual.ru_Installing.html#Upgrading-from-3.23">2.5.2  Модернизация с версии 3.23 до версии 4.0</A>.

</P>
<P>
После инсталляции вы можете запустить MySQL выполняя следующие команды в терминальном
окне. Обратите внимание, что вам нужны привилегии администратора для выполнения этой
задачи. 

</P>

<pre>
shell&#62; cd /usr/local/mysql
shell&#62; sudo ./bin/mysqld_safe
(Введите ваш пароль)
(Нажмите CTRL+Z)
shell&#62; bg
(Нажмите CTRL+D для выхода из оболочки)
</pre>

<P>
Теперь вы сможете подключиться к серверу MySQL, скажем, запустив 
<tt>`/usr/local/mysql/bin/mysql'</tt>.

</P>
<P>
Для того, чтобы MySQL автоматически запускался при загрузке, вы можете 
взять MySQL StartupItem Марка по этому адресу: 

</P>
<P>
<a HREF="http://www2.entropy.ch/download/mysql-startupitem.pkg.tar.gz">http://www2.entropy.ch/download/mysql-startupitem.pkg.tar.gz</a>

</P>
<P>
Мы планируем в ближайшее время добавить StartupItem в официальный пакет 
MySQL в ближайшее время. 

</P>
<P>
Заметьте, что инсталляция нового пакета MySQL не удаляет каталог более старой
инсталляции. К сожалению, инсталлятор в Mac OS X еще не предоставляет нужной 
функциональности для того, чтобы корректно обновить существующие в системе
пакеты.

</P>
<P>
После того, как вы скопировали файлы данных MySQL с предыдущего месторасположения,
и успешно запустили новую версию, вы можете удалить старую инсталляцию. 
Кроме того, вы можете удалить старые каталоги Package Receipt, 
расположенные здесь: <tt>`/Library/Receipts/mysql-&#60;version&#62;.pkg'</tt>.

</P>



<H2><A NAME="General_Installation_Issues" HREF="manual.ru_toc.html#General_Installation_Issues">2.2  Общие вопросы инсталляции</A></H2>



<H3><A NAME="Getting_MySQL" HREF="manual.ru_toc.html#Getting_MySQL">2.2.1  Как получить MySQL</A></H3>

<P>
<A NAME="IDX177"></A>
<A NAME="IDX178"></A>
<A NAME="IDX179"></A>
<A NAME="IDX180"></A>
<A NAME="IDX181"></A>
<A NAME="IDX182"></A>
<A NAME="IDX183"></A>

</P>
<P>
Информацию о текущей версии и инструкции по ее загрузке можно получить на
домашней странице MySQL (<a HREF="http://www.mysql.com/">http://www.mysql.com/</a>).

</P>
<P>
Наш главный зеркальный сайт - <a HREF="http://mirrors.sunsite.dk/mysql/">http://mirrors.sunsite.dk/mysql/</a> 

</P>
<P>
Если вы заинтересованы в организации зеркального сайта MySQL, то можете
анонимно зеркалировать нас программой rsync с адреса
<code>rsync://sunsite.dk/ftp/mirrors/mysql/</code>. Просьба отправить нам письмо по
адресу <code>webmaster@mysql.com</code>, чтобы уведомить нас о том, что ваш зеркальный
сайт следует добавить в представленный ниже список.

</P>
<P>
Если возникнут проблемы с загрузкой с нашего главного сайта, пробуйте
использовать один из следующих зеркальных сайтов.

</P>
<P>
О недействительных или устаревших зеркальных сайтах просьба сообщать по
адресу <code>webmaster@mysql.com</code>.

</P>
<P>
For a complete upto-date list of MySQL web/download mirrors, see
<a HREF="http://www.mysql.com/downloads/mirrors.html">http://www.mysql.com/downloads/mirrors.html</a>.
There you will also find information about becoming a MySQL mirror
site and how to report a bad or out-of-date mirror.

</P>



<H3><A NAME="Verifying_Package_Integrity" HREF="manual.ru_toc.html#Verifying_Package_Integrity">2.2.2  Проверка целостности пакетов с помощью <code>MD5 Checksums</code> или <code>GnuPG</code></A></H3>

<P>
После того, как вы загрузили нужный вам пакет MySQL, и перед тем как вы будете
его устанавливать, вам следует убедиться в том, что он в сохранности и не был 
кем-либо изменен.

</P>
<P>
MySQL AB предоставляет два способа проверить пакет: контрольная сумма <code>MD5</code> 
и криптографическая подпись с использованиемп <code>GnuPG</code>, <code>GNU Privacy Guard</code>.

</P>

<H3>2.2.3  Проверка контрольной суммы <code>MD5</code></H3>

<P>
После того как вы загрузили пакет, вы должны проверить, соответствует ли
контрольная сумма MD5 загруженного пакета той, что указана на страничке
загрузки пакетов. У каждого пакета своя контрольная сумма, которую вы можете
проверить такой командой:

</P>

<pre>
shell&#62; md5sum &#60;пакет&#62;
</pre>

<P>
Однако не все операционные системы поддерживают команду <code>md5sum</code> - на некоторых
она просто называется <code>md5</code>, а в других она вовсе не поставляется. На Linux
эта команда является частью <code>GNU Text Utilities</code>, которые доступны для множества
разных платформ. 

</P>
<P>
Вы можете загрузить исходный код по адресу 
<a HREF="http://www.gnu.org/software/textutils/">http://www.gnu.org/software/textutils/</a>. Если у вас уже установлен 
<code>OpenSSL</code>, вы также можете использовать команду <code>openssl md5
&#60;пакет&#62;</code>. Реализация <code>md5</code> для DOS/Windows доступна по адресу 
<a HREF="http://www.fourmilab.ch/md5/">http://www.fourmilab.ch/md5/</a>.

</P>

<P>
Пример:

<pre>
shell&#62; md5sum mysql-standard-4.0.10-gamma-pc-linux-i686.tar.gz
155836a7ed8c93aee6728a827a6aa153
                mysql-standard-4.0.10-gamma-pc-linux-i686.tar.gz
</pre>

<P>
Вы должны удостовериться, что результирующая контрольная сумма соответствует
той, что указана на страничке загрузки возле соответствующего пакета. 

</P>
<P>
Множество зеркальных сайтов также предоставляют файл с именем <tt>`MD5SUMS'</tt>,
который также содержит <code>MD5</code> контрольные суммы всех файлов из каталога
<tt>`Downloads'</tt>.  Однако заметьте, что этот файл достаточно легко изменить и
это не самый надежный метод проверки целостности пакета. Если вы в сомнениях,
вы должны посмотреть на другие зеркала и сравнить увиденное. 

</P>

<H3>2.2.4  Проверка подписи с использованием <code>GnuPG</code></H3>

<P>
Гораздо более надежный метод проверки целостности пакета это использование
криптографически сигнатур. MySQL AB использует ПО <code>GNU Privacy Guard</code>
(<code>GnuPG</code>), открытая альтернатива весьма известному пакету <code>Pretty Good
Privacy</code> (<code>PGP</code>) Фила Циммермана (Phil Zimmermann).
См. <a HREF="http://www.gnupg.org/">http://www.gnupg.org/</a> и <a HREF="http://www.openpgp.org/">http://www.openpgp.org/</a>
для более подробной информации про OpenPGP/GnuPG и как его получить и поставить на 
вашей системе. Большинство поставок Linux уже идут с GnuPG прямо в поставке. 

</P>
<P>
Начиная с MySQL 4.0.10 (Февраль 2003), MySQL AB начала подписывать
загружаемые пакеты с помощью <code>GnuPG</code>.  Криптографические сигнатуры являются 
гораздо более надежным методом проверки целостности и аутентичности файла. 

</P>
<P>
Для проверки подписи конкретного пакета, вам в первую очередь следует
получить копию публичного ключа GPG <a HREF="mailto:build@mysql.com">build@mysql.com</a>. Вы можете
либо взять этот ключ прямо отсюда, либо взять его на 
<a HREF="http://www.keyserver.net/">http://www.keyserver.net/</a>.

</P>

<pre>
Key ID:
pub  1024D/5072E1F5 2003-02-03
     MySQL Package signing key (www.mysql.com) &#60;build@mysql.com&#62;
Fingerprint: A4A9 4068 76FC BD3C 4567  70C8 8C71 8D3B 5072 E1F5

Public Key (ASCII-armored):

-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: GnuPG v1.0.6 (GNU/Linux)
Comment: For info see http://www.gnupg.org

mQGiBD4+owwRBAC14GIfUfCyEDSIePvEW3SAFUdJBtoQHH/nJKZyQT7h9bPlUWC3
RODjQReyCITRrdwyrKUGku2FmeVGwn2u2WmDMNABLnpprWPkBdCk96+OmSLN9brZ
fw2vOUgCmYv2hW0hyDHuvYlQA/BThQoADgj8AW6/0Lo7V1W9/8VuHP0gQwCgvzV3
BqOxRznNCRCRxAuAuVztHRcEAJooQK1+iSiunZMYD1WufeXfshc57S/+yeJkegNW
hxwR9pRWVArNYJdDRT+rf2RUe3vpquKNQU/hnEIUHJRQqYHo8gTxvxXNQc7fJYLV
K2HtkrPbP72vwsEKMYhhr0eKCbtLGfls9krjJ6sBgACyP/Vb7hiPwxh6rDZ7ITnE
kYpXBACmWpP8NJTkamEnPCia2ZoOHODANwpUkP43I7jsDmgtobZX9qnrAXw+uNDI
QJEXM6FSbi0LLtZciNlYsafwAPEOMDKpMqAK6IyisNtPvaLd8lH0bPAnWqcyefep
rv0sxxqUEMcM3o7wwgfN83POkDasDbs3pjwPhxvhz6//62zQJ7Q7TXlTUUwgUGFj
a2FnZSBzaWduaW5nIGtleSAod3d3Lm15c3FsLmNvbSkgPGJ1aWxkQG15c3FsLmNv
bT6IXQQTEQIAHQUCPj6jDAUJCWYBgAULBwoDBAMVAwIDFgIBAheAAAoJEIxxjTtQ
cuH1cY4AnilUwTXn8MatQOiG0a/bPxrvK/gCAJ4oinSNZRYTnblChwFaazt7PF3q
zIhMBBMRAgAMBQI+PqPRBYMJZgC7AAoJEElQ4SqycpHyJOEAn1mxHijft00bKXvu
cSo/pECUmppiAJ41M9MRVj5VcdH/KN/KjRtW6tHFPYhMBBMRAgAMBQI+QoIDBYMJ
YiKJAAoJELb1zU3GuiQ/lpEAoIhpp6BozKI8p6eaabzF5MlJH58pAKCu/ROofK8J
Eg2aLos+5zEYrB/LsrkCDQQ+PqMdEAgA7+GJfxbMdY4wslPnjH9rF4N2qfWsEN/l
xaZoJYc3a6M02WCnHl6ahT2/tBK2w1QI4YFteR47gCvtgb6O1JHffOo2HfLmRDRi
Rjd1DTCHqeyX7CHhcghj/dNRlW2Z0l5QFEcmV9U0Vhp3aFfWC4Ujfs3LU+hkAWzE
7zaD5cH9J7yv/6xuZVw411x0h4UqsTcWMu0iM1BzELqX1DY7LwoPEb/O9Rkbf4fm
Le11EzIaCa4PqARXQZc4dhSinMt6K3X4BrRsKTfozBu74F47D8Ilbf5vSYHbuE5p
/1oIDznkg/p8kW+3FxuWrycciqFTcNz215yyX39LXFnlLzKUb/F5GwADBQf+Lwqq
a8CGrRfsOAJxim63CHfty5mUc5rUSnTslGYEIOCR1BeQauyPZbPDsDD9MZ1ZaSaf
anFvwFG6Llx9xkU7tzq+vKLoWkm4u5xf3vn55VjnSd1aQ9eQnUcXiL4cnBGoTbOW
I39EcyzgslzBdC++MPjcQTcA7p6JUVsP6oAB3FQWg54tuUo0Ec8bsM8b3Ev42Lmu
QT5NdKHGwHsXTPtl0klk4bQk4OajHsiy1BMahpT27jWjJlMiJc+IWJ0mghkKHt92
6s/ymfdf5HkdQ1cyvsz5tryVI3Fx78XeSYfQvuuwqp2H139pXGEkg0n6KdUOetdZ
Whe70YGNPw1yjWJT1IhMBBgRAgAMBQI+PqMdBQkJZgGAAAoJEIxxjTtQcuH17p4A
n3r1QpVC9yhnW2cSAjq+kr72GX0eAJ4295kl6NxYEuFApmr1+0uUq/SlsQ==
=YJkx
-----END PGP PUBLIC KEY BLOCK-----
</pre>

<P>
Вы можете импортировать этот ключ в ваш публичный репозитарий ключей (public keyring) 
используя <code>gpg --import</code>. См. документацию на <code>GPG</code> для более подробной информации 
о том, как работать с публичными ключами. 

</P>
<P>
После того, как вы загрузили и импортирлвали публичный ключ сборки, 
вы можете загрузить выбранный вами пакет MySQL и соответствующую подпись, 
доступную на той же страничке загрузки. 

</P>
<P>
Файл сигнатуры имеет расширение <tt>`.asc'</tt>. Например, 
сигнатура для <tt>`mysql-standard-4.0.10-gamma-pc-linux-i686.tar.gz'</tt>
будет <tt>`mysql-standard-4.0.10-gamma-pc-linux-i686.tar.gz.asc'</tt>.
Удостоверьтесь, чтобы оба файла находятся в том же самом каталоге и затем
запустите такую команду для проверки сигнатуры файла: 

</P>

<pre>
shell&#62; gpg --verify &#60;package&#62;.asc

Example:

shell&#62; gpg --verify mysql-standard-4.0.10-gamma-pc-linux-i686.tar.gz.asc
gpg: Warning: using insecure memory!
gpg: Signature made Mon 03 Feb 2003 08:50:39 PM MET using DSA key ID 5072E1F5
gpg: Good signature from
     "MySQL Package signing key (www.mysql.com) &#60;build@mysql.com&#62;"
</pre>

<P>
Сообщение "Good signature" сообщает вам о том, что все в порядке. 

</P>
<P>
Для пакетов <code>RPM</code>, отдельного файла подписи не предоставляется - пакеты <code>RPM</code> уже
сами по себе имеют встроенную поддержку подписей <code>GPG</code> и контрольных сумм <code>MD5</code>. Вы можете 
проверить их такой командой: 

</P>

<pre>
shell&#62; rpm --checksig &#60;package&#62;.rpm
</pre>

<P>
Пример:

</P>

<pre>
shell&#62; rpm --checksig MySQL-server-4.0.10-0.i386.rpm
MySQL-server-4.0.10-0.i386.rpm: md5 gpg OK
</pre>

<P>
<strong>Внимание:</strong> Если вы используете RPM 4.1 и он сообщает следующее: <code>(GPG)
NOT OK (MISSING KEYS: GPG#5072e1f5)</code> (даже несмотря на то, что вы импортировали
ключ в ваш публичный репозиторий ключей GPG, keyring) - вам следует 
импортировать ключ в репозиторий ключей RPM. 
RPM 4.1 больше не использует ваш репозиторий ключей GPG (и GPG вообще), но
поддерживает свой репозиторий, поскольку RPM - это общесистемная утилита, а 
репозиторий ключей GPG - это специфичный для пользователя файл). 
Чтобы импортировать публичный ключ MySQL в RPM, используйте вот такую команду: 

</P>

<pre>
shell&#62; rpm --import &#60;pubkey&#62;
</pre>

<P>
Пример:

</P>

<pre>
shell&#62; rpm --import mysql_pubkey.asc
</pre>

<P>
Если вдруг вы заметите что контрольные суммы MD5 или подпись GPG не совпадают,
попробуйте в первую очередь загрузить соответствующий пакет еще один раз, может 
быть, даже с другого сервера. Если вы не сможете успешно удостовериться
в целостности пакета, пожалуйста, сообщите нам о подобных инцидентах, включая
полное имя пакета и адрес сайта, с которого вы пытались загрузить пакет, на адрес
<a HREF="mailto:webmaster@mysql.com">webmaster@mysql.com</a> или <a HREF="mailto:build@mysql.com">build@mysql.com</a>.

</P>


<H3><A NAME="Which_OS" HREF="manual.ru_toc.html#Which_OS">2.2.5  Операционные системы, поддерживаемые MySQL</A></H3>

<P>
<A NAME="IDX184"></A>
<A NAME="IDX185"></A>
<A NAME="IDX186"></A>
<A NAME="IDX187"></A>

</P>
<P>
Мы применяем GNU Autoconf, что дает возможность переносить MySQL на все
современные системы с работающими потоками Posix и компилятором C++ (чтобы
скомпилировать только код клиента, требуется только компилятор C++ без
использования потоков). Для себя мы используем и разрабатываем программное
обеспечение в основном на Sun Solaris (версий 2.5 - 2.7) и SuSE Linux
версии 7.x.

</P>
<P>
Следует учитывать, что для многих операционных систем поддержка
собственных потоков работает только в самых последних версиях. Согласно
полученным нами сообщениям, MySQL успешно компилируется на следующих
комбинациях операционных систем и потоковых пакетов:

</P>

<ul>
<LI>

AIX 4.x, 5.x с собственными потоками. См.раздел See section <A HREF="manual.ru_Installing.html#IBM-AIX">2.6.6.4  Примечания к IBM-AIX</A>.
<LI>

Amiga.
<LI>

BSDI 2.x с пакетом MIT-pthreads. See section <A HREF="manual.ru_Installing.html#BSDI">2.6.4.5  Примечания к BSD/OS версий 2.x</A>.
<LI>

BSDI 3.0, 3.1 и 4.x с собственными потоками. See section <A HREF="manual.ru_Installing.html#BSDI">2.6.4.5  Примечания к BSD/OS версий 2.x</A>.
<LI>

DEC Unix 4.x с собственными потоками. See section <A HREF="manual.ru_Installing.html#Alpha-DEC-UNIX">2.6.6.6  Примечания к Alpha-DEC-UNIX (Tru64)</A>.
<LI>

FreeBSD 2.x с пакетом MIT-pthreads. See section <A HREF="manual.ru_Installing.html#FreeBSD">2.6.4.1  Примечания к FreeBSD</A>.
<LI>

FreeBSD 3.x и 4.x с собственными потоками. See section <A HREF="manual.ru_Installing.html#FreeBSD">2.6.4.1  Примечания к FreeBSD</A>.
<LI>

HP-UX 10.20 с пакетом MIT-pthreads или пакетом DCE-threads. See section <A HREF="manual.ru_Installing.html#HP-UX_10.20">2.6.6.2  Примечания к HP-UX версии 10.20</A>.
<LI>

HP-UX 11.x с собственными потоками. See section <A HREF="manual.ru_Installing.html#HP-UX_11.x">2.6.6.3  Примечания к HP-UX версий 11.x</A>.
<LI>

Linux 2.0+ с  потоками LinuxThreads 0.7.1+ или  glibc 2.0.7+. См.
раздел See section <A HREF="manual.ru_Installing.html#Linux">2.6.1  Примечания к Linux (Все версии Linux)</A>.
<LI>

Mac OS X. See section <A HREF="manual.ru_Installing.html#Mac_OS_X">2.6.5  Примечания к Mac OS X</A>.
<LI>

NetBSD 1.3/1.4 Intel и NetBSD 1.3 Alpha (требует GNU make). See section <A HREF="manual.ru_Installing.html#NetBSD">2.6.4.2  Примечания к NetBSD</A>.
<LI>

OpenBSD &#62; 2.5 с собственными потоками. OpenBSD &#60; 2.5 с 
пакетом MIT-pthreads. See section <A HREF="manual.ru_Installing.html#OpenBSD">2.6.4.3  Примечания к OpenBSD 2.5</A>.
<LI>

OS/2 Warp 3, FixPack 29 и OS/2 Warp 4, FixPack 4. See section <A HREF="manual.ru_Installing.html#OS_2">2.6.7  Примечания к OS/2</A>.
<LI>

SGI Irix 6.x с собственными потоками. See section <A HREF="manual.ru_Installing.html#SGI-Irix">2.6.6.8  Примечания к SGI Irix</A>.
<LI>

Solaris 2.5 и выше с собственными потоками на SPARC и x86. 
See section <A HREF="manual.ru_Installing.html#Solaris">2.6.3  Примечания к Solaris</A>.
<LI>

SunOS 4.x с пакетом MIT-pthreads. See section <A HREF="manual.ru_Installing.html#Solaris">2.6.3  Примечания к Solaris</A>.
<LI>

Caldera (SCO) OpenServer с последним портом пакета FSU Pthreads.
See section <A HREF="manual.ru_Installing.html#Caldera">2.6.6.9  Примечания к Caldera (SCO)</A>.
<LI>

Caldera (SCO) UnixWare 7.0.1. See section <A HREF="manual.ru_Installing.html#Caldera_Unixware">2.6.6.10  Примечания к Caldera (SCO) Unixware Version 7.0</A>.
<LI>

Tru64 Unix
<LI>

Windows 9x, Me, NT, 2000 и XP. See section <A HREF="manual.ru_Installing.html#Windows">2.6.2  Примечания к Windows</A>.
</ul>

<P>
Следует отметить, что не на всех платформах MySQL функционирует одинаково
хорошо. Насколько  подходит определенная платформа для высоконагружаемого
многоцелевого сервера MySQL, определяется следующими факторами:

</P>

<ul>
<LI>

Общая стабильность потоковой библиотеки. Платформа может иметь
отличную репутацию в других отношениях, но если в коде, который
вызывается MySQL, потоковая библиотека нестабильна, то, даже если все
остальное прекрасно, стабильность MySQL будет определяться
стабильностью потоковой библиотеки.
<LI>

Способность ядра и/или библиотеки потоков пользоваться преимуществом
симметричной многопроцессорной обработки (<code>SMP</code>) на  многопроцессорных
системах. Другими словами, при создании процессом потока для этого
потока должна быть возможность работать на ином центральном процессоре
(CPU), чем исходный процесс.
<LI>

Способность библиотеки ядра и/или потоков запускать много потоков,
которые приобретают/освобождают синхронизирующий флаг в небольшой
критической области, часто без излишних переключений контекста. Иными
словами, если реализация <code>pthread_mutex_lock()</code> является очень 
``уступающей'' время центрального процессора, это значительно 
вредит MySQL. Если не принять во внимание данное обстоятельство, то
использование добавочных центральных процессоров сделает MySQL
существенно медленнее.
<LI>

Общая стабильность/производительность файловой системы.
<LI>

Способность файловой системы работать с большими файлами вообще и
работать с ними эффективно в случае больших таблиц.
<LI>

Наш, т.е. разработчиков, уровень компетенции в том, что касается
данной платформы. Для платформ, которые мы знаем хорошо, мы вводим в
MySQL специфические для платформы оптимизации/исправления, доступные
во время компиляции. Кроме того, мы можем также дать совет по
оптимальной для MySQL конфигурации вашей системы.
<LI>

Выполненный нами у себя объем тестирования подобных конфигураций.
<LI>

Количество пользователей, успешно применяющих MySQL на данной
платформе в подобных конфигурациях. Если это количество велико, то
шансы получить некоторые специфические для данной платформы сюрпризы,
намного меньше.
</ul>

<P>
В соответствии с предыдущими критериями наилучшими платформами с этой
точки зрения для функционирования MySQL являются: x86 под управлением SuSE
Linux 7.1, с ядром 2.4 и ReiserFS (или любой подобный дистрибутив Linux) и
SPARC под управлением Solaris 2.7 или 2.8. FreeBSD оказывается третьей, но
мы в самом деле надеемся, что эта платформа войдет в число лучших, как
только станет совершеннее потоковая библиотека. Мы также надеемся, что, с
некоторого момента, мы сможем включить в высшую категорию все остальные
платформы, на которых MySQL компилируется и функционирует нормально, но не
с тем же уровнем стабильности и производительности. Это потребует
некоторых усилий с нашей стороны в сотрудничестве с разработчиками
компонентов операционных систем и библиотек, от которых зависит MySQL.
Если вы заинтересованы в улучшении тех или иных компонентов, у вас есть
возможность оказать влияние на их разработку и вы нуждаетесь в подробных
инструкциях по поводу того, что нужно MySQL, чтобы работать лучше, пошлите
письмо по адресу <a HREF="mailto:internals@lists.mysql.com">internals@lists.mysql.com</a>.

</P>
<P>
Просьба к вам: на основании приведенных выше сравнительных характеристик
не делать выводов о том, что какая-либо операционная система лучше или
хуже другой в общем. Мы говорим о выборе определенной операционной системы
для конкретной цели - для работы MySQL, и сравниваем платформы только в
таком смысле. С этой точки зрения результат такого сравнения был бы
другим, если бы мы включили в него больше пунктов. И в некоторых случаях
причина того, что одна операционная система лучше, чем другая, может
заключаться всего лишь в том, что в тестирование и оптимизацию этой
конкретной платформы было вложено гораздо больше усилий. Мы просто
констатируем наши наблюдения, чтобы помочь вам принять решение - на какой
платформе использовать MySQL в вашей системе.

</P>


<H3><A NAME="Which_version" HREF="manual.ru_toc.html#Which_version">2.2.6  Какую версию MySQL использовать</A></H3>

<P>
<A NAME="IDX188"></A>
<A NAME="IDX189"></A>
<A NAME="IDX190"></A>
<A NAME="IDX191"></A>

</P>
<P>
Во-первых, нужно принять решение о том, что именно вам требуется - самый
свежий экспериментальный выпуск или последняя устойчивая версия:

<ul>
<LI>

Если вы собираетесь использовать MySQL впервые или пытаетесь выполнить
перенос MySQL на некоторую систему, для которой нет бинарного
дистрибутива, то обычно мы рекомендуем начинать со стабильной версии
(в настоящее время это версия 3.23). Следует иметь в виду, что все
релизы MySQL проверяются с помощью тестов производительности MySQL и
набора всесторонних тестов перед каждым выпуском (даже для
экспериментальных выпусков).
<LI>

Если же вы работаете со старой системой и желаете ее модернизировать,
но хотите избежать возможных нестыковок при модернизации, то
необходимо проводить замену на самую новую версию в той же ветви,
которую вы используете (где только последний номер версии более новый,
чем у вашей). В таких версиях мы стараемся исправлять только
критические ошибки и делать только небольшие, относительно безопасные
изменения.
</ul>

<P>
Во-вторых, нужно принять решение, хотите ли вы использовать дистрибутив
исходного кода или бинарный дистрибутив. В большинстве случаев лучше
остановить свой выбор на бинарном дистрибутиве, если такой существует для
вашей платформы, так как обычно его проще установить, чем дистрибутив
исходного кода.

</P>
<P>
Установка из исходного кода может оказаться более предпочтительной в
следующих случаях:

<ul>
<LI>

Если необходимо инсталлировать MySQL в некотором явно заданном
местоположении (стандартные бинарные поставки являются ``готовыми к
запуску'' в любом месте, но, возможно, вам потребуется еще большая
гибкость).
<LI>

Чтобы удовлетворить различные требования пользователей, мы поставляем
две разных бинарных версии: одна скомпилирована с обработчиками
нетранзакционных таблиц (небольшой, быстрый бинарный код), а вторая
сконфигурирована с наиболее важными возможностями расширения, такими,
как поддерживающие транзакции таблицы. Обе версии компилируются из
одного и того же исходного кода. Все собственные клиенты <code>MySQL</code> могут
подключаться к обеим версиям.

Бинарный дистрибутив расширенной версии
MySQL маркируется суффиксом <code>-max</code> и конфигурируется с теми же опциями,
что и <code>mysqld-max</code>. See section <A HREF="manual.ru_MySQL_Database_Administration.html#mysqld-max">4.7.5  <code>mysqld-max</code>, расширенный сервер <code>mysqld</code></A>.

Если  вы  хотите  использовать  пакет RPM <code>MySQL-Max</code>, то сначала 
следует  установить стандартный пакет <code>MySQL</code> RPM.
<LI>

Если вам нужно сконфигурировать <code>mysqld</code> с некоторыми дополнительными
свойствами, которые отсутствуют в стандартных бинарных дистрибутивах.
Ниже приводится список наиболее распространенных дополнительных опций,
которые, возможно, вы захотите использовать:


<ul>
<LI><code>--with-innodb</code>

<LI><code>--with-berkeley-db</code>

<LI><code>--with-raid</code>

<LI><code>--with-libwrap</code>

<LI><code>--with-named-z-lib (Это делается для некоторых бинарных дистрибутивов)</code>

<LI><code>--with-debug[=full]</code>

</ul>

<LI>

По умолчанию бинарный дистрибутив обычно компилируется с поддержкой
всех кодировок и должен работать на различных процессорах из одного и
того же семейства процессоров.

Если требуется получить более быстрый
сервер MySQL, то можно перекомпилировать его с поддержкой только одной
необходимой вам кодировки, использовать лучший компилятор (наподобие
<code>pgcc</code>) или воспользоваться опциями компилятора, которые лучше
оптимизированы для вашего процессора.
<LI>

Если вы нашли ошибку и сообщили о ней команде разработчиков MySQL, то
вам должны выслать патч, который следует применить к дистрибутиву
исходного кода для исправления ошибки.
<LI>

Если вы хотите читать (и/или модифицировать) исходный код MySQL (на C
и C++), необходимо иметь дистрибутив исходного кода. Исходный код -
это всегда лучшая документация. Дистрибутивы исходного кода также
содержат больше тестов и примеров, чем бинарные дистрибутивы.
</ul>

<P>
<A NAME="IDX192"></A>
<A NAME="IDX193"></A>

</P>
<P>
В системе наименований в MySQL используются номера выпусков, состоящие из
трех чисел и суффикса. Например, выпуск <code>mysql-3.21.17-beta</code> 
интерпретируется следующим образом:

</P>

<ul>
<LI>

Первое число (<code>3</code>) служит для описания формата файлов. Все выпуски
версии <code>3</code> имеют один и тот же формат файлов.
<LI>

Второе число (<code>21</code>) представляет собой уровень выпуска. Обычно
существует выбор из двух возможностей. Одна представляет выпуск
стабильной ветви (в настоящее время <code>23</code>) и вторая - экспериментальную
ветвь (в настоящее время <code>4.0</code>). Обычно обе ветви стабильны, но
экспериментальная версия может обладать некоторыми причудами, возможно
отсутствие документации на новые свойства, либо она может не
компилироваться на некоторых системах.
<LI>

Третье число (<code>17</code>) является номером версии в пределах уровня выпуска.
Это число увеличивается для каждого нового дистрибутива. Обычно имеет
смысл предпочесть самую последнюю версию для выбранного уровня
выпуска.
<LI>

Суффикс (<code>beta</code>) указывает на уровень стабильности данного выпуска.
Возможны следующие суффиксы:


<ul>
<LI>

<code>alpha</code> указывает, что выпуск содержит большие разделы нового кода,
не протестированного на 100%. Обнаруженные ошибки (обычно их нет)
должны быть задокументированы в разделе ``Новости'' (News). См.
раздел See section <A HREF="manual.ru_News.html#News">D  История изменений и обновлений MySQL</A>. В большинстве выпусков <code>alpha</code>
присутствуют также новые команды и расширения. При работе над
<code>alpha</code>-выпуском может происходить активная разработка, включающая
значительные изменения кода, но перед выпуском все тестируется. В
любом выпуске MySQL не должно быть известных ошибок.
<LI>

<code>beta</code> означает, что весь новый код протестирован. Не добавляются
никакие новые свойства, которые могли бы вызвать повреждения
старого кода. Не должно быть никаких известных ошибок. Версия
изменяется с <code>alpha</code> на <code>beta</code> тогда, когда никаких сообщений о
критических ошибках в <code>alpha</code>-версии не поступает по меньшей мере в
течение месяца и мы не планируем добавлять какие- либо новые
свойства, которые могли бы понизить надежность прежних команд.
<LI>

<code>gamma</code> представляет собой версию <code>beta</code>, которая почти закончена и,
похоже, работает хорошо. Добавляются только незначительные
исправления. Это именно то, что во многих других компаниях
называется релизом.
<LI>

Если нет никакого суффикса, это означает, что данная версия
запускалась на многих различных компьютерных системах без
сообщений об ошибках, кроме ошибок, относящихся к специфике
платформ; для нее допускается только исправление критических
ошибок. Именно поэтому такой выпуск мы называем стабильным.
</ul>

</ul>

<P>
Все версии MySQL пропускаются через наши стандартные тесты и контрольные
задачи, чтобы получить уверенность в том, что они надежны в применении.
Так как стандартные тесты периодически дополняются, чтобы включить
проверку обнаруженных новых ошибок и ситуаций, которые могут их вызвать,
то набор тестов со временем становится лучше и лучше.

</P>
<P>
Отметим, что все выпуски протестированы по меньшей мере со следующими
тестами:

</P>
<P>
<A NAME="IDX194"></A>
<A NAME="IDX195"></A>

</P>
<DL COMPACT>

<DT>Внутренний набор тестов
<DD>
Набор является частью производственной системы для заказчика. Этот набор
включает много таблиц с сотнями мегабайт данных.

<DT>Набор тестов производительности MySQL
<DD>
Эти тесты работают с набором общеупотребительных запросов. Кроме того, они
позволяют увидеть, действительно ли последний пакет оптимизаций делает код
быстрее. See section <A HREF="manual.ru_MySQL_Optimisation.html#MySQL_Benchmarks">5.1.4  Набор тестов MySQL (The MySQL Benchmark Suite)</A>.

<DT>Тест <code>crash-me</code>
<DD>
Тест пытается определить, какие функциональные возможности поддерживает
база данных и каковы ее возможности и ограничения. See section <A HREF="manual.ru_MySQL_Optimisation.html#MySQL_Benchmarks">5.1.4  Набор тестов MySQL (The MySQL Benchmark Suite)</A>.
</DL>

<P>
Существует еще один тест. Он заключается в том, что мы используем самую
новую версию MySQL в нашей внутренней производственной среде по крайней
мере на одной машине. Для работы с этой версией у нас есть более чем 100
гигабайт данных.

</P>


<H3><A NAME="Installation_layouts" HREF="manual.ru_toc.html#Installation_layouts">2.2.7  Схемы установки</A></H3>

<P>
<A NAME="IDX196"></A>
<A NAME="IDX197"></A>
<A NAME="IDX198"></A>
<A NAME="IDX199"></A>

</P>
<P>
В этом разделе описывается расположение каталогов, создаваемых по
умолчанию при установке бинарного дистрибутива и дистрибутива исходного
кода.

</P>
<P>
Бинарный дистрибутив устанавливается путем его распаковки в выбранном вами
месте установки (обычно <tt>`/usr/local/mysql'</tt>) и создает следующие каталоги:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><strong>Каталог</strong> </TD><TD> <strong>Содержание каталога</strong>
</TD></TR>
<TR><TD><tt>`bin'</tt> </TD><TD> Клиентские программы и сервер <code>mysqld</code>
</TD></TR>
<TR><TD><tt>`data'</tt> </TD><TD> Файлы журналов, базы данных
</TD></TR>
<TR><TD><tt>`include'</tt> </TD><TD> Включаемые (заголовочные) файлы
</TD></TR>
<TR><TD><tt>`lib'</tt> </TD><TD> Библиотеки
</TD></TR>
<TR><TD><tt>`scripts'</tt> </TD><TD> <code>mysql_install_db</code>
</TD></TR>
<TR><TD><tt>`share/mysql'</tt> </TD><TD> Файлы с текстами сообщений об ошибках
</TD></TR>
<TR><TD><tt>`sql-bench'</tt> </TD><TD> Тесты производительности
</TD></TR>
</TABLE>

<P>
Дистрибутив исходного кода устанавливается после того, как вы
сконфигурируете и скомпилируете его. По умолчанию на этапе установки файлы
инсталлируются в каталог <tt>`/usr/local'</tt> в следующие подкаталоги:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><strong>Каталог</strong> </TD><TD> <strong>Содержание каталога</strong>
</TD></TR>
<TR><TD><tt>`bin'</tt> </TD><TD> Клиентские программы и скрипты
</TD></TR>
<TR><TD><tt>`include/mysql'</tt> </TD><TD> Включаемые (заголовочные) файлы
</TD></TR>
<TR><TD><tt>`info'</tt> </TD><TD> Документация в формате Info
</TD></TR>
<TR><TD><tt>`lib/mysql'</tt> </TD><TD> Библиотеки
</TD></TR>
<TR><TD><tt>`libexec'</tt> </TD><TD> Сервер <code>mysqld</code>
</TD></TR>
<TR><TD><tt>`share/mysql'</tt> </TD><TD> Файлы с текстами сообщений об ошибках
</TD></TR>
<TR><TD><tt>`sql-bench'</tt> </TD><TD> Тесты производительности и тест <code>crash-me</code>
</TD></TR>
<TR><TD><tt>`var'</tt> </TD><TD> Базы данных и файлы журналов
</TD></TR>
</TABLE>

<P>
Внутри каталога установки схема расположения инсталляции исходного кода
отличается от схемы установки бинарного дистрибутива в следующих
отношениях:

<ul>
<LI>

Сервер <code>mysqld</code> устанавливается в каталог <tt>`libexec'</tt>, а не в <tt>`bin'</tt>.
<LI>

Каталогом данных является <tt>`var'</tt>, а не <tt>`data'</tt>.
<LI>

<code>mysql_install_db</code> устанавливается в каталоге <tt>`/usr/local/bin'</tt>, а не в
<tt>`/usr/local/mysql/scripts'</tt>.
<LI>

Каталогами заголовочных файлов и библиотек являются <tt>`include/mysql'</tt> и
<tt>`lib/mysql'</tt>, а не <tt>`include'</tt> и <tt>`lib'</tt>.
</ul>

<P>
Можно создать собственную бинарную установку из скомпилированного
дистрибутива исходного кода. Для этого следует выполнить скрипт
<tt>`scripts/make_binary_distribution'</tt>.

</P>


<H3><A NAME="Many_versions" HREF="manual.ru_toc.html#Many_versions">2.2.8  Как и когда выпускаются обновления</A></H3>

<P>
<A NAME="IDX200"></A>
<A NAME="IDX201"></A>
<A NAME="IDX202"></A>

</P>
<P>
Развитие MySQL в MySQL AB происходит очень быстрыми темпами и мы стремимся
к тому, чтобы результаты нашей работы стали доступны и другим
пользователям MySQL. Мы стараемся сделать новый выпуск сразу же, как
только в продукте появляются очень полезные свойства, которые, по нашему
мнению, необходимы другим пользователям.

</P>
<P>
Помимо этого мы откликаемся на просьбы наших пользователей, если для этого
требуется добавить в продукт легко реализуемые свойства. Мы принимаем во
внимание пожелания наших пользователей, имеющих лицензии, а особенно -
пожелания обширного круга пользователей, охваченных поддержкой при помощи
электронной почты, и стараемся помочь им решить их проблемы.

</P>
<P>
Загружать новый выпуск не обязательно. Информацию о том, действительно ли
новый выпуск представляет собой именно то, что вам требуется, вы
почерпнете из раздела ``Новости'' (News). See section <A HREF="manual.ru_News.html#News">D  История изменений и обновлений MySQL</A>.

</P>
<P>
Наша политика в вопросах обновления MySQL заключается в следующем:

</P>

<ul>
<LI>

Для каждого небольшого обновления последняя цифра в строке версии
увеличивается. При внесении существенно новых свойств или небольших
несовместимостей с предыдущими версиями увеличивается второе число в
строке версии. Если изменяется формат файлов, то увеличивается первая
цифра.
<LI>

Протестированные на устойчивость версии должны обычно появляться 1-2
раза в год, но если обнаруживаются небольшие ошибки, то выпускаются
версии только с исправлениями ошибок.
<LI>

Рабочие исправления к старым версиям должны появляться примерно каждые
1-8 недель.
<LI>

Бинарные дистрибутивы для некоторых платформ мы будем делать для
значительных выпусков. Бинарные дистрибутивы для других систем иногда
создаются и другими людьми, но, как правило, не так часто.
<LI>

Обычно мы делаем патчи доступными сразу же после локализации и
исправления небольших ошибок. Они посылаются на <a HREF="mailto:bugs@lists.mysql.com">bugs@lists.mysql.com</a> и
включаются в очередной выпуск.
<LI>

Некритические, но досадные ошибки мы будем добавлять в репозиторий
исходного кода MySQL и они будут исправляться в следующем выпуске.
<LI>

Если по какой-либо случайности в выпуске окажется критическая ошибка,
то мы сделаем новый выпуск как можно скорее. Мы хотели бы, чтобы
нашему примеру и следовали и другие компании.
</ul>

<P>
Текущим стабильным выпуском сейчас является версия 3.23; уже начата
активную разработка версии 4.0. Ошибки в стабильной версии по-прежнему
будут исправляться. Мы не верим в полное ``замораживание'', поскольку при
этом упускаются исправления ошибок и вещи, которые ``должны быть
сделаны''. ``Отчасти заморожено'' подразумевает, что мы можем добавить
некоторые вещи, которые ``почти несомненно не окажут влияния ни на что из
того, что уже работает''.

</P>
<P>
В MySQL применяется несколько отличающаяся от большинства других продуктов
система именования. В общем случае достаточно надежно использовать любую
версию, просуществовавшую в течение пары недель без замены ее новой
версией. See section <A HREF="manual.ru_Installing.html#Which_version">2.2.6  Какую версию MySQL использовать</A>.

</P>


<H3><A NAME="MySQL_binaries" HREF="manual.ru_toc.html#MySQL_binaries">2.2.9  Бинарные коды MySQL, скомпилированные в MySQL AB</A></H3>

<P>
<A NAME="IDX203"></A>
<A NAME="IDX204"></A>

</P>

<P>
Компания MySQL AB в качестве услуги предоставляет набор бинарных
(скомпилированных) дистрибутивов MySQL - они скомпилированы  на нашем
оборудовании или на вычислительных системах, к которым нам любезно
предоставили доступ  заказчики.

</P>
<P>
Эти дистрибутивы сгенерированы скриптом
<code>Build-tools/Do-compile</code>, который компилирует дерево исходных 
кодов, и создает архив <code>.tar.gz</code> используя <code>scripts/make_binary_distribution</code>

</P>
<P>
Эти бинарники сконфигурированы и собраны с помощью следующих компиляторов и 
опций. 

</P>
<DL COMPACT>

<DT>Linux 2.4.xx i386 с <code>gcc</code> 2.95.3
<DD>
<code>CFLAGS="-O2 -mcpu=pentiumpro" CXX=gcc CXXFLAGS="-O2 -mcpu=pentiumpro -felide-constructors" ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile --enable-assembler --disable-shared --with-client-ldflags=-all-static --with-mysqld-ldflags=-all-static</code>

<DT>Linux 2.4.xx ia64 с <code>ecc</code> (Intel C++ Itanium Compiler 7.0)
<DD>
<code>CC=ecc CFLAGS=-tpp1 CXX=ecc CXXFLAGS=-tpp1 ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile</code>

<DT>Linux 2.4.xx alpha с <code>ccc</code> (Compaq C V6.2-505 / Compaq C++ V6.3-006)
<DD>
<code>CC=ccc CFLAGS="-fast -arch generic" CXX=cxx CXXFLAGS="-fast -arch generic -noexceptions -nortti" ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile --with-mysqld-ldflags=-non_shared --with-client-ldflags=-non_shared --disable-shared</code>

<DT>Linux 2.2.xx sparc с <code>egcs</code> 1.1.2
<DD>
<code>CC=gcc CFLAGS="-O3 -fno-omit-frame-pointer" CXX=gcc CXXFLAGS="-O3 -fno-omit-frame-pointer -felide-constructors -fno-exceptions -fno-rtti" ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile --enable-assembler --disable-shared</code>

<DT>Linux 2.4.xx s390 с <code>gcc</code> 2.95.3
<DD>
<code>CFLAGS="-O2" CXX=gcc CXXFLAGS="-O2 -felide-constructors" ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile --disable-shared --with-client-ldflags=-all-static --with-mysqld-ldflags=-all-static</code>

<DT>Sun Solaris 2.8 sparc с <code>gcc</code> 3.2
<DD>
<code>CC=gcc CFLAGS="-O3 -fno-omit-frame-pointer" CXX=gcc CXXFLAGS="-O3 -fno-omit-frame-pointer -felide-constructors -fno-exceptions -fno-rtti" ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile --enable-assembler --with-named-z-libs=no --with-named-curses-libs=-lcurses --disable-shared</code>

<DT>Sun Solaris 2.9 sparc с <code>gcc</code> 2.95.3
<DD>
<code>CC=gcc CFLAGS="-O3 -fno-omit-frame-pointer" CXX=gcc CXXFLAGS="-O3 -fno-omit-frame-pointer -felide-constructors -fno-exceptions -fno-rtti" ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile --enable-assembler --with-named-curses-libs=-lcurses --disable-shared</code>

<DT>Sun Solaris 2.9 sparc с <code>cc-5.0</code> (Sun Forte 5.0)
<DD>
<code>CC=cc-5.0 CXX=CC ASFLAGS="-xarch=v9" CFLAGS="-Xa -xstrconst -mt -D_FORTEC_ -xarch=v9" CXXFLAGS="-noex -mt -D_FORTEC_ -xarch=v9" ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile --enable-assembler --with-named-z-libs=no --enable-thread-safe-client --disable-shared</code>

<DT>IBM AIX 4.3.2 ppc с <code>gcc</code> 3.2.1
<DD>
<code>CFLAGS="-O2 -mcpu=powerpc -Wa,-many " CXX=gcc CXXFLAGS="-O2 -mcpu=powerpc -Wa,-many  -felide-constructors -fno-exceptions -fno-rtti" ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile --with-named-z-libs=no --disable-shared</code>

<DT>IBM AIX 5.1.0 ppc с <code>gcc</code> 3.2.1
<DD>
<code>CFLAGS="-O2 -mcpu=powerpc -Wa,-many" CXX=gcc CXXFLAGS="-O2 -mcpu=powerpc -Wa,-many  -felide-constructors -fno-exceptions -fno-rtti" ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex --with-server-suffix="-pro" --enable-thread-safe-client --enable-local-infile --with-named-z-libs=no --disable-shared --with-innodb</code>

<DT>HP-UX 10.20 pa-risc1.1 с <code>gcc</code> 3.1
<DD>
<code>CFLAGS="-DHPUX -I/opt/dce/include -O3 -fPIC" CXX=gcc CXXFLAGS="-DHPUX -I/opt/dce /include -felide-constructors -fno-exceptions -fno-rtti -O3 -fPIC" ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile  --with-pthread --with-named-thread-libs=-ldce --with-lib-ccflags=-fPIC --disable-shared</code>

<DT>HP-UX 11.11 pa-risc2.0 с <code>aCC</code> (HP ANSI C++ B3910B A.03.33)
<DD>
<code>CC=cc CXX=aCC CFLAGS=+DD64 CXXFLAGS=+DD64 ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile --disable-shared</code>

<DT>Apple MacOS X 10.2 powerpc с <code>gcc</code> 3.1
<DD>
<code>CC=gcc CFLAGS="-O3 -fno-omit-frame-pointer" CXX=gcc CXXFLAGS="-O3 -fno-omit-frame-pointer -felide-constructors -fno-exceptions -fno-rtti" ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile  --disable-shared</code>

<DT>FreeBSD 4.7 i386 с <code>gcc</code> 2.95.4
<DD>
<code>CFLAGS=-DHAVE_BROKEN_REALPATH ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile --enable-assembler --with-named-z-libs=not-used --disable-shared</code>
</DL>

<P>
Следующие бинарные поставки собраны на системах, предоставленных MySQL AB
пользователями. Заметьте, что эти бинарные поставки предоставляются
исключительно для удобства.  Поскольку у MySQL AB нет полного контроля над
этими системами, мы только можем дать ограниченную поддержку этих бинарных
поставок. 

</P>
<DL COMPACT>

<DT>SCO Unix 3.2v5.0.6 i386 с <code>gcc</code> 2.95.3
<DD>
<code>CFLAGS="-O3 -mpentium" LDFLAGS=-static CXX=gcc CXXFLAGS="-O3 -mpentium -felide-constructors" ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile --with-named-z-libs=no --enable-thread-safe-client --disable-shared</code>

<DT>Caldera Open Unix 8.0.0 i386 с <code>CC</code> 3.2
<DD>
<code>CC=cc CFLAGS="-O" CXX=CC ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile --with-named-z-libs=no --enable-thread-safe-client --disable-shared</code>

<DT>Compaq Tru64 OSF/1 V5.1 732 alpha с <code>cc/cxx</code> (Compaq C V6.3-029i / DIGITAL C++ V6.1-027)
<DD>
<code>CC="cc -pthread" CFLAGS="-O4 -ansi_alias -ansi_args -fast -inline speed -speculate all" CXX="cxx -pthread" CXXFLAGS="-O4 -ansi_alias -fast -inline speed -speculate all -noexceptions -nortti" ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile --with-prefix=/usr/local/mysql --with-named-thread-libs="-lpthread -lmach -lexc -lc" --disable-shared --with-mysqld-ldflags=-all-static</code>

<DT>SGI Irix 6.5 IP32 с <code>gcc</code> 3.0.1
<DD>
<code>CC=gcc CFLAGS="-O3 -fno-omit-frame-pointer" CXXFLAGS="-O3 -fno-omit-frame-pointer -felide-constructors -fno-exceptions -fno-rtti" ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex --enable-thread-safe-client --enable-local-infile  --disable-shared</code>
</DL>

<P>
Такие опции компиляции использовались для бинарных поставок MySQL AB в прошлом. 
Такие бинарные поставки более не обновляются, но опции компиляции мы сохранили 
здесь как реферативную информацию.

</P>
<DL COMPACT>

<DT>Linux 2.2.x с x686 с <code>gcc</code> 2.95.2
<DD>
<code>CFLAGS="-O3 -mpentiumpro" CXX=gcc CXXFLAGS="-O3 -mpentiumpro -felide-constructors -fno-exceptions -fno-rtti" ./configure --prefix=/usr/local/mysql --enable-assembler --with-mysqld-ldflags=-all-static --disable-shared --with-extra-charsets=complex</code>

<DT>SunOS 4.1.4 2 sun4c с <code>gcc</code> 2.7.2.1
<DD>
<code>CC=gcc CXX=gcc CXXFLAGS="-O3 -felide-constructors" ./configure --prefix=/usr/local/mysql --disable-shared --with-extra-charsets=complex --enable-assembler</code>

<DT>SunOS 5.5.1 (and above) sun4u с <code>egcs</code> 1.0.3a or 2.90.27 or gcc 2.95.2 and newer
<DD>
<code>CC=gcc CFLAGS="-O3" CXX=gcc CXXFLAGS="-O3 -felide-constructors -fno-exceptions -fno-rtti" ./configure --prefix=/usr/local/mysql --with-low-memory --with-extra-charsets=complex --enable-assembler</code>

<DT>SunOS 5.6 i86pc с <code>gcc</code> 2.8.1
<DD>
<code>CC=gcc CXX=gcc CXXFLAGS=-O3 ./configure --prefix=/usr/local/mysql --with-low-memory --with-extra-charsets=complex</code>

<DT>BSDI BSD/OS 3.1 i386 с <code>gcc</code> 2.7.2.1
<DD>
<code>CC=gcc CXX=gcc CXXFLAGS=-O ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex</code>

<DT>BSDI BSD/OS 2.1 i386 с <code>gcc</code> 2.7.2
<DD>
<code>CC=gcc CXX=gcc CXXFLAGS=-O3 ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex</code>

<DT>AIX 2 4 с <code>gcc</code> 2.7.2.2
<DD>
<code>CC=gcc CXX=gcc CXXFLAGS=-O3 ./configure --prefix=/usr/local/mysql --with-extra-charsets=complex</code>
</DL>

<P>
Каждый, кто обладает более оптимальными опциями для любой из
вышеперечисленных конфигураций, в любое время может выслать их в список
рассылки разработчиков по адресу <a HREF="mailto:internals@lists.mysql.com">internals@lists.mysql.com</a>.

</P>
<P>
Дистрибутивы RPM для версии MySQL до 3.22 создавались силами
пользователей. Однако начиная с версии 3.22, пакеты RPM собираются у нас в
MySQL AB.

</P>
<P>
Если вы хотите скомпилировать отладочную версию MySQL, то следует добавить
<code>--with-debug</code> или <code>--with-debug=full</code> к предыдущим строкам конфигурации и
удалить любые опции <code>-fomit-frame-pointer</code>.

</P>
<P>
По вопросам, относящимся к дистрибутиву для Windows, просьба обращаться к
разделу See section <A HREF="manual.ru_Installing.html#Windows_installation">2.1.2  Установка MySQL на Windows</A>.

</P>


<H3><A NAME="Installing_binary" HREF="manual.ru_toc.html#Installing_binary">2.2.10  Установка бинарного дистрибутива MySQL</A></H3>

<P>
<A NAME="IDX205"></A>
<A NAME="IDX206"></A>

</P>
<P>
См. также раздел See section <A HREF="manual.ru_Installing.html#Windows_binary_installation">2.1.2.1  Установка бинарного кода</A>, раздел section <A HREF="manual.ru_Installing.html#Linux-RPM">2.1.1  Установка MySQL на Linux</A> и раздел See section <A HREF="manual.ru_Clients.html#Building_clients">8.4.7  Сборка клиентских программ</A>.

</P>
<P>
Для установки бинарного дистрибутива MySQL необходимы следующие
инструментальные средства:

</P>

<ul>
<LI>

GNU <code>gunzip</code> для разархивирования дистрибутива.

<LI>

Подходящий <code>tar</code> для распаковки дистрибутива. GNU <code>tar</code> известен как
работающий, а <code>tar</code> разработки Sun - как имеющий проблемы.
</ul>

<P>
<A NAME="IDX207"></A>

</P>
<P>
Для Linux существует альтернативный метод установки с использованием
дистрибутива RPM (RedHat Package Manager, менеджер пакетов RedHat). См.
раздел See section <A HREF="manual.ru_Installing.html#Linux-RPM">2.1.1  Установка MySQL на Linux</A>.

</P>
<P>
Если вам придется столкнуться с проблемами, то, пожалуйста, при отправке
вопросов на <a HREF="mailto:mysql@lists.mysql.com">mysql@lists.mysql.com</a> всегда пользуйтесь <code>mysqlbug</code>. Даже если
ваша проблема не относится к числу ошибок, <code>mysqlbug</code> соберет системную
информацию, которая поможет решать такие проблемы и другим. Без <code>mysqlbug</code>
вы уменьшаете вероятность получить решение своей проблемы! <code>mysqlbug</code> можно
найти в каталоге <tt>`scripts'</tt> после распаковки дистрибутива. See section <A HREF="manual.ru_Introduction.html#Bug_reports">1.8.1.3  Как отправлять отчеты об ошибках или проблемах</A>.

</P>
<P>
<A NAME="IDX208"></A>
Для установки бинарного дистрибутива MySQL необходимо выполнить следующие
основные команды:

</P>

<pre>
shell&#62; groupadd mysql
shell&#62; useradd -g mysql mysql
shell&#62; cd /usr/local
shell&#62; gunzip &#60; /path/to/mysql-VERSION-OS.tar.gz | tar xvf -
shell&#62; ln -s full-path-to-mysql-VERSION-OS mysql
shell&#62; cd mysql
shell&#62; scripts/mysql_install_db
shell&#62; chown -R root .
shell&#62; chown -R mysql data
shell&#62; chgrp -R mysql .
shell&#62; bin/safe_mysqld --user=mysql &#38;
</pre>

<P>
или

</P>

<pre>
shell&#62; bin/mysqld_safe --user=mysql &#38;
</pre>

<P>
если вы работаете с MySQL 4.x

</P>
<P>
<A NAME="IDX209"></A>
<A NAME="IDX210"></A>

</P>
<P>
Новых пользователей можно добавить, используя скрипт
<code>bin/mysql_setpermission</code>, если установить модули Perl <code>DBI</code> и
<code>Msql-Mysql-modules</code>.

</P>
<P>
Далее следует более детальное описание.

</P>
<P>
Для установки бинарного дистрибутива выполните приведенные ниже действия,
а затем перейдите к разделу section <A HREF="manual.ru_Installing.html#Post-installation">2.4  Послеустановочные настройка и тестирование</A> для
послеустановочной настройки и проверки:

<ol>
<LI>

Выберите каталог, в котором вы хотите распаковать дистрибутив, и
откройте его. В последующих примерах мы распаковываем дистрибутив под
<tt>`/usr/local'</tt> и создаем каталог <tt>`/usr/local/mysql'</tt>, в котором
устанавливается MySQL. (Для выполнения дальнейших инструкций,
следовательно, предполагается, что вы обладаете правами создания
файлов в <tt>`/usr/local'</tt>. Если этот каталог защищен, то вы должны
производить установку как пользователь <code>root</code>.)

<LI>

Получите файл дистрибутива с одного из сайтов, перечисленных в разделе
See section <A HREF="manual.ru_Installing.html#Getting_MySQL">2.2.1  Как получить MySQL</A>. Бинарные дистрибутивы MySQL поставляются как сжатые
архивы tar с именами вроде <tt>`mysql-VERSION-OS.tar.gz'</tt>, где <code>VERSION</code>
представляет собой число (например 4.1.0-alpha), а <code>OS</code> указывает тип
операционной системы, для которой предназначен данный дистрибутив
(например <code>pc-linux-gnu-i586</code>).

<LI>

Если бинарный дистрибутив маркирован суффиксом <code>-max</code>, то это означает,
что данный бинарный код поддерживает транзакционные таблицы и другие
свойства. See section <A HREF="manual.ru_MySQL_Database_Administration.html#mysqld-max">4.7.5  <code>mysqld-max</code>, расширенный сервер <code>mysqld</code></A>. Отметим,
что все бинарные дистрибутивы созданы из одного и того же дистрибутива
исходного кода MySQL.

<LI>

Добавьте пользователя и группу для запуска <code>mysqld</code> как:


<pre>
shell&#62; groupadd mysql
shell&#62; useradd -g mysql mysql
</pre>

Приведенные команды добавляют группу <code>mysql</code> и пользователя <code>mysql</code>. Данный
синтаксис для <code>useradd</code> и <code>groupadd</code> для различных версиях Unix может иметь
некоторые различия. Эти команды могут также называться <code>adduser</code> и <code>addgroup</code>.
При желании можно дать пользователю и группе вместо <code>mysql</code> другие имена.

<LI>

Задайте предназначенный для установки каталог:


<pre>
shell&#62; cd /usr/local
</pre>

<LI>

Распакуйте дистрибутив и создайте каталог установки:


<pre>
shell&#62; gunzip &#60; /path/to/mysql-VERSION-OS.tar.gz | tar xvf -
shell&#62; ln -s full-path-to-mysql-VERSION-OS mysql
</pre>

Первая команда создает каталог с именем <code>mysql-VERSION-OS</code>, а вторая -
устанавливает символическую ссылку на данный каталог. Это позволяет более
просто ссылаться на каталог установки - как на <tt>`/usr/local/mysql'</tt>.

<LI>

Измените в каталоге установки:


<pre>
shell&#62; cd mysql
</pre>

В каталоге <code>mysql</code> вы найдете несколько файлов и подкаталогов. Наиболее
важными для целей установки являются подкаталоги <tt>`bin'</tt> и <tt>`scripts'</tt>.

<DL COMPACT>

<DT><tt>`bin'</tt>
<DD>
<A NAME="IDX211"></A>
<A NAME="IDX212"></A>

Этот каталог содержит клиентские программы и сервер. Необходимо добавить
полный путь к этому каталогу в переменную окружения  <code>PATH</code>, чтобы оболочка
операционной системы правильно находила программы MySQL. 
See section <A HREF="manual.ru_Environment_variables.html#Environment_variables">F  Переменные окружения</A>.

<DT><tt>`scripts'</tt>
<DD>
Этот каталог содержит скрипт <code>mysql_install_db</code>, используемый для
инициализации базы данных <code>mysql</code>, содержащей таблицы привилегий, в которых
хранятся права доступа к серверу.
</DL>

<LI>

Если вы предпочитаете использовать <code>mysqlaccess</code> и установить
дистрибутив MySQL в каком-либо нестандартном месте, то необходимо
изменить место, где <code>mysqlaccess</code> ожидает найти клиента <code>mysql</code>.
Отредактируйте скрипт <tt>`bin/mysqlaccess'</tt> примерно на 18-й строке.
Найдите строку, выглядящую примерно так:


<pre>
$MYSQL = '/usr/local/bin/mysql'; # путь к исполняемому клиенту mysql
</pre>

Измените путь для указания того места в системе, где действительно
находится <code>mysql</code>. Если этого не сделать, то возникнет ошибка <code>Broken pipe</code> 
при запуске <code>mysqlaccess</code>.

<LI>

Создайте таблицы привилегий MySQL (необходимы только в том случае,
если ранее MySQL не устанавливался):


<pre>
shell&#62; scripts/mysql_install_db
</pre>

Отметим, что в версиях MySQL старше, чем 3.22.10, сервер MySQL запускался
при запуске <code>mysql_install_db</code>. Сейчас это не так!

<LI>

Измените принадлежность бинарного кода пользователю <code>root</code> и
принадлежность каталога данных пользователю, под которым будет
запускаться <code>mysqld</code>, следующим образом:


<pre>
shell&#62; chown -R root /usr/local/mysql/.
shell&#62; chown -R mysql /usr/local/mysql/data
shell&#62; chgrp -R mysql /usr/local/mysql/.
</pre>

Первая команда изменяет владельца данного файла на пользователя <code>root</code>,
вторая -  владельца каталога данных на пользователя <code>mysql</code>, а третья -
группу на группу <code>mysql</code>.

<LI>

Если вы хотите установить поддержку интерфейса Perl <code>DBI</code>/<code>DBD</code>, 
See section <A HREF="manual.ru_Installing.html#Perl_support">2.7  Замечания по установке Perl</A>.

<LI>

Если вы хотели бы, чтобы работа MySQL начиналась автоматически при
начальной загрузке компьютера, то можно скопировать
<tt>`support-files/mysql.server'</tt> в то место, где находятся файлы запуска
вашей системы. Более подробную информацию можно найти в самом скрипте
<tt>`support-files/mysql.server'</tt> и в разделе See section <A HREF="manual.ru_Installing.html#Automatic_start">2.4.3  Автоматический запуск и остановка MySQL</A>.
</ol>

<P>
После того, как все это будет установлено, необходимо инициализировать и
протестировать данный дистрибутив.

</P>
<P>
Запустить сервер MySQL можно с помощью следующей команды:

</P>

<pre>
shell&#62; bin/safe_mysqld --user=mysql &#38;
</pre>

<P>
А сейчас следует перейти к разделу section <A HREF="manual.ru_MySQL_Database_Administration.html#safe_mysqld">4.7.2  <code>safe_mysqld</code>, оболочка <code>mysqld</code></A> и просмотреть раздел See section <A HREF="manual.ru_Installing.html#Post-installation">2.4  Послеустановочные настройка и тестирование</A>.

</P>


<H2><A NAME="Installing_source" HREF="manual.ru_toc.html#Installing_source">2.3  Установка исходного дистрибутива MySQL</A></H2>

<P>
<A NAME="IDX213"></A>
<A NAME="IDX214"></A>
<A NAME="IDX215"></A>

</P>
<P>
Перед тем как приступить к установке исходного кода, вначале убедитесь,
что наш бинарный дистрибутив подходит для вашей платформы и что он будет
работать на вашей системе. Мы прилагаем много усилий для того, чтобы
снабдить наши бинарные дистрибутивы наилучшими свойствами из возможных.

</P>
<P>
Для сборки и установки MySQL из исходного кода необходимы следующие
инструменты:

</P>

<ul>
<LI>

GNU <code>gunzip</code> для разархивирования дистрибутива.

<LI>

Подходящий <code>tar</code> для распаковки дистрибутива. Известно, что GNU <code>tar</code>
является работоспособным, а <code>tar</code> разработки Sun имеет проблемы.

<LI>

Работающий компилятор ANSI C++. К числу компиляторов, о которых
известно, что они работают, относятся версии <code>gcc</code> &#62;= 2.95.2, <code>egcs</code> &#62;=
1.0.2 или egcs 2.91.66, SGI C++ и SunPro C++. При использовании <code>gcc</code>
нет необходимости в <code>libg++</code>. Версия gcc 2.7.x имеет ошибку, из-за
которой невозможна компиляция некоторых полностью допустимых файлов
C++, таких как <tt>`sql/sql_base.cc'</tt>. Если у вас есть только <code>gcc</code> 2.7.x, то
для того, чтобы можно было провести компиляцию MySQL, необходимо
модернизировать <code>gcc</code>. Компилятор <code>gcc</code> 2.8.1, как известно, также имеет
проблемы на некоторых платформах, так что его лучше не использовать,
если для данной платформы существует новый компилятор. При компиляции
версии MySQL 3.23.x рекомендуется <code>gcc</code> &#62;= 2.95.2.

<LI>

Хорошая программа <code>make</code>. Всегда рекомендуется (а иногда и необходимо)
использовать GNU make. В случае возникновения проблем мы рекомендуем
попробовать работать с версией GNU make 3.75 или более новой.
</ul>

<P>
Очень важно, чтобы вы использовали последнюю версию <code>gcc</code>, достаточно новую,
чтобы ``понимать'' опцию <code>-fno-exceptions</code>. В противном случае не исключена
компиляция бинарного кода, который может неожиданно привести к отказу. Мы
также рекомендуем использовать <code>-felide-constructors</code> и <code>-fno-rtti</code> вместе с
<code>-fno-exceptions</code>. Если вы сомневаетесь, то выполните следующие действия:

</P>

<pre>
CFLAGS="-O3" CXX=gcc CXXFLAGS="-O3 -felide-constructors -fno-exceptions \
       -fno-rtti" ./configure --prefix=/usr/local/mysql --enable-assembler \
       --with-mysqld-ldflags=-all-static
</pre>

<P>
На большинстве операционных систем это даст быстрый и стабильный бинарный
код.

</P>
<P>
Если вам придется столкнуться с проблемами, то при отправке вопросов на
<a HREF="mailto:mysql@lists.mysql.com">mysql@lists.mysql.com</a>, пожалуйста, всегда используйте <code>mysqlbug</code>. Даже если
ваша проблема не вызвана какой-либо ошибкой, <code>mysqlbug</code> соберет системную
информацию, которая в поможет решении этой проблемы другим пользователям.
Без <code>mysqlbug</code> уменьшается вероятность того, что вы получите решение своей
проблемы! <code>mysqlbug</code> можно найти в каталоге <tt>`scripts'</tt> после распаковки
дистрибутива. See section <A HREF="manual.ru_Introduction.html#Bug_reports">1.8.1.3  Как отправлять отчеты об ошибках или проблемах</A>.

</P>



<H3><A NAME="Quick_install" HREF="manual.ru_toc.html#Quick_install">2.3.1  Обзор  быстрой  установки</A></H3>

<P>
Для установки MySQL из исходного кода необходимо выполнить следующие
основные команды:

</P>

<pre>
shell&#62; groupadd mysql
shell&#62; useradd -g mysql mysql
shell&#62; gunzip &#60; mysql-VERSION.tar.gz | tar -xvf -
shell&#62; cd mysql-VERSION
shell&#62; ./configure --prefix=/usr/local/mysql
shell&#62; make
shell&#62; make install
shell&#62; scripts/mysql_install_db
shell&#62; chown -R root /usr/local/mysql
shell&#62; chown -R mysql /usr/local/mysql/var
shell&#62; chgrp -R mysql /usr/local/mysql
shell&#62; cp support-files/my-medium.cnf /etc/my.cnf
shell&#62; /usr/local/mysql/bin/safe_mysqld --user=mysql &#38;
или
shell&#62; /usr/local/mysql/bin/mysqld_safe --user=mysql &#38;
</pre>

<P>
если запускается версия MySQL 4.x.

</P>
<P>
Чтобы обеспечить поддержку таблиц InnoDB, следует отредактировать файл
<tt>`/etc/my.cnf'</tt>, удалив символ <code>#</code> перед теми параметрами, которые начинаются с
<code>innodb_....</code> See section <A HREF="manual.ru_MySQL_Database_Administration.html#Option_files">4.1.2  Файлы параметров <tt>`my.cnf'</tt></A>. See section <A HREF="manual.ru_Table_types.html#InnoDB_start">7.5.2  Параметры запуска InnoDB</A>.

</P>
<P>
Если вы используете исходный код RPM, выполните следующую команду:

</P>

<pre>
shell&#62; rpm --rebuild --clean MySQL-VERSION.src.rpm
</pre>

<P>
Эта команда создаст бинарный код RPM, который вы можете установить.

</P>
<P>
Новых пользователей можно добавить, используя скрипт
<code>bin/mysql_setpermission</code>, если установить модули Perl <code>DBI</code> и
<code>Msql-Mysql-modules</code>.

</P>
<P>
Ниже следует более подробное описание установки.

</P>
<P>
Для установки исходного кода нужно выполнить приведенные ниже действия, а
затем перейти к разделу section <A HREF="manual.ru_Installing.html#Post-installation">2.4  Послеустановочные настройка и тестирование</A> для
инициализации и послеустановочной проверки:

</P>

<ol>
<LI>

Выберите каталог, в котором вы хотите распаковать дистрибутив, и
откройте его.

Получите файл дистрибутива с одного из сайтов, перечисленных в разделе
See section <A HREF="manual.ru_Installing.html#Getting_MySQL">2.2.1  Как получить MySQL</A>.

<LI>

Если вы заинтересованы в том, чтобы использовать с MySQL таблицы
Berkeley DB, то необходимо получить версию исходного кода таблиц
Berkeley DB с патчами. Кроме того, прежде чем предпринимать какие-либо
действия, ознакомьтесь, пожалуйста, с разделом, посвященным таблицам
Berkeley DB (see section <A HREF="manual.ru_Table_types.html#BDB">7.6  Таблицы <code>BDB</code> или BerkeleyDB</A>). Дистрибутивы
исходного кода MySQL поставляются в виде сжатых архивов tar с именами
наподобие <tt>`mysql-VERSION.tar.gz'</tt>, где <code>VERSION</code> представляет собой число.

<LI>

Добавьте пользователя и группу для запуска <code>mysqld</code> следующим образом:


<pre>
shell&#62; groupadd mysql
shell&#62; useradd -g mysql mysql
</pre>

Эти команды добавляют группу <code>mysql</code> и пользователя <code>mysql</code>. Данный синтаксис
для <code>useradd</code> и <code>groupadd</code> в различных версиях Unix может иметь некоторые
отличия. Приведенные выше команды могут также иметь другие названия -
<code>adduser</code> и <code>addgroup</code> соответственно. Пользователю и группе можно назначить
какие-нибудь иные, отличные от <code>mysql</code> имена.

<LI>

Распакуйте дистрибутив в текущем каталоге:


<pre>
shell&#62; gunzip &#60; /path/to/mysql-VERSION.tar.gz | tar xvf -
</pre>

Эта команда создает каталог с именем <tt>`mysql-VERSION'</tt>.

<LI>

Перейдите из каталога распакованного дистрибутива в каталог высшего
уровня:


<pre>
shell&#62; cd mysql-VERSION
</pre>

Учтите, что теперь необходимо конфигурировать и компоновать MySQL из этого
каталога высшего уровня. Построить  MySQL в другом каталоге нельзя.

<LI>

Сформируйте релиз и скомпилируйте весь код:


<pre>
shell&#62; ./configure --prefix=/usr/local/mysql
shell&#62; make
</pre>

При запуске configure вам, возможно, понадобится указать некоторые опции.
Чтобы получить список опций, запустите <code>./configure --help</code>. Некоторые
наиболее полезные опции рассмотрены в разделе See section <A HREF="manual.ru_Installing.html#configure_options">2.3.3  Типичные опции <code>configure</code></A>.
Если <code>configure</code> не работает и вы собираетесь посылать письмо с просьбой о
помощи на <a HREF="mailto:mysql@lists.mysql.com">mysql@lists.mysql.com</a>, то просьба включить в него те строки из
<tt>`config.log'</tt>, которые, по вашему мнению, могут помочь решить данную
проблему. Кроме того, если выполнение <code>configure</code> преждевременно
прекращается, в письмо следует включить несколько последних строк вывода
из <code>configure</code>. Для отсылки отчета об ошибке используйте скрипт <code>mysqlbug</code>
(see section <A HREF="manual.ru_Introduction.html#Bug_reports">1.8.1.3  Как отправлять отчеты об ошибках или проблемах</A>). Если компиляция не
выполняется, то обращайтесь к разделу See section <A HREF="manual.ru_Installing.html#Compilation_problems">2.3.5  Проблемы с компиляцией?</A>, в котором
содержатся рекомендации по решению ряда часто встречающихся проблем.

<LI>

Установите весь код:


<pre>
shell&#62; make install
</pre>

Возможно, необходимо запустить эту команду как <code>root</code>.

<LI>

Создайте таблицы привилегий MySQL (это необходимо только в случае,
если нет ранее установленной версии MySQL ):


<pre>
shell&#62; scripts/mysql_install_db
</pre>

Учтите, что в версиях MySQL до 3.22.10 работа сервера MySQL начиналась при
запуске <code>mysql_install_db</code>. Сейчас это не так!

<LI>

Измените принадлежность бинарного кода <code>root</code> и принадлежность каталога
данных, назначив их пользователю, под именем которого будет
запускаться <code>mysqld</code>. Это делается следующим образом:


<pre>
shell&#62; chown -R root /usr/local/mysql
shell&#62; chown -R mysql /usr/local/mysql/var
shell&#62; chgrp -R mysql /usr/local/mysql
</pre>

Первая команда изменяет атрибут owner данного файла на пользователя <code>root</code>,
вторая - атрибут owner каталога данных на пользователя <code>mysql</code>, а третья -
атрибут group на группу <code>mysql</code>.

<LI>

Если вы хотите установить поддержку интерфейса Perl <code>DBI</code>/<code>DBD</code>,
обращайтесь к разделу See section <A HREF="manual.ru_Installing.html#Perl_support">2.7  Замечания по установке Perl</A>.

<LI>

Если вы хотели бы, чтобы работа MySQL начиналась автоматически при
начальной загрузке компьютера, то можно скопировать
<tt>`support-files/mysql.server'</tt> в то место, где находятся файлы запуска
вашей системы. Более подробную информацию можно найти в самом скрипте
<tt>`support-files/mysql.server'</tt> и в разделе See section <A HREF="manual.ru_Installing.html#Automatic_start">2.4.3  Автоматический запуск и остановка MySQL</A>.
</ol>

<P>
После завершения установки данный дистрибутив необходимо
проинициализировать и протестировать:

</P>

<pre>
shell&#62; /usr/local/mysql/bin/safe_mysqld --user=mysql &#38;
</pre>

<P>
Если эта команда прекращает работу немедленно после останова демона
<code>mysqld</code>, то некоторую информацию можно найти в файле
<tt>`mysql-data-directory/'hostname'.err'</tt>. Причина, возможно, заключается в том,
что уже запущен другой сервер <code>mysqld</code> (see section <A HREF="manual.ru_MySQL_Database_Administration.html#Multiple_servers">4.1.4  Запуск нескольких серверов MySQL на одном компьютере</A>).

</P>
<P>
Теперь приступайте к разделу See section <A HREF="manual.ru_Installing.html#Post-installation">2.4  Послеустановочные настройка и тестирование</A>.

</P>


<H3><A NAME="Applying_patches" HREF="manual.ru_toc.html#Applying_patches">2.3.2  Применение патчей</A></H3>

<P>
<A NAME="IDX216"></A>
<A NAME="IDX217"></A>

</P>
<P>
Патчи иногда присутствуют в списке рассылки или помещаются в папке патчей
на веб-сайте MySQL (<a HREF="http://www.mysql.com/downloads/patches.html">http://www.mysql.com/downloads/patches.html</a>).

</P>
<P>
Для применения патча из списка рассылки сохраните сообщение, содержащее
патч, в файле, поместите его в каталог высшего уровня, в котором находится
дерево исходных кодов MySQL, и запустите следующие команды:

</P>

<pre>
shell&#62; patch -p1 &#60; patch-file-name
shell&#62; rm config.cache
shell&#62; make clean
</pre>

<P>
Патчи с FTP-сайта распространяются как файлы с простым текстом или как
файлы, сжатые с помощью <code>gzip</code>. Патч в виде простого текста следует
применять, как показано выше для патчей из списка рассылки. Чтобы
применить сжатый патч, поместите его в каталог высшего уровня, в котором
находится дерево исходных кодов MySQL, и запустите следующие команды:

</P>

<pre>
shell&#62; gunzip &#60; patch-file-name.gz | patch -p1
shell&#62; rm config.cache
shell&#62; make clean
</pre>

<P>
После применения патча следуйте инструкциям для обычной установки
исходного кода, начиная с этапа <code>./configure</code>. После запуска этапа <code>make
install</code> перезапустите свой сервер MySQL.

</P>
<P>
Возможно, перед запуском <code>make install</code> потребуется остановить любые
запущенные в это время серверы (используйте для этого <code>mysqladmin
shutdown</code>). В некоторых системы не разрешается устанавливать новую версию
какой-либо программы, если она замещает запущенную в данное время версию.

</P>


<H3><A NAME="configure_options" HREF="manual.ru_toc.html#configure_options">2.3.3  Типичные опции <code>configure</code></A></H3>

<P>
<A NAME="IDX218"></A>
<A NAME="IDX219"></A>
<A NAME="IDX220"></A>
<A NAME="IDX221"></A>
<A NAME="IDX222"></A>
<A NAME="IDX223"></A>

</P>
<P>
Скрипт <code>configure</code> обеспечивает широкие возможности управления конфигурацией
дистрибутива MySQL. Обычно такое управление осуществляется путем
использования опций в командной строке <code>configure</code>. На работу <code>configure</code>
можно также воздействовать при помощи соответствующих переменных окружения
(see section <A HREF="manual.ru_Environment_variables.html#Environment_variables">F  Переменные окружения</A>). Чтобы получить список поддерживаемых
configure опций, запустите следующую команду:

</P>

<pre>
shell&#62; ./configure --help
</pre>

<P>
Ниже описаны некоторые из наиболее часто используемых опций <code>configure</code>:

</P>

<ul>
<LI>

Для компиляции только клиентских библиотек MySQL и клиентских программ
(без серверной части) используйте опцию <code>--without-server</code>:


<pre>
shell&#62; ./configure --without-server
</pre>

При отсутствии компилятора C++ не будет компилироваться <code>mysql</code> (именно для
данной клиентской программы требуется C++). В этом случае можно удалить из
configure код, который проверяет наличие компилятора C++, а затем
запустить <code>./configure</code> с опцией <code>--without-server</code>. На этапе компиляции и
после этого будет предпринята попытка скомпилировать <code>mysql</code>, но любые
предупреждения насчет <tt>`mysql.cc'</tt> можно игнорировать (если <code>make</code> остановится,
попробуйте запустить <code>make -k</code> - чтобы  компиляция остального кода
продолжалась даже в случае возникновения ошибок).

<LI>

Если необходимо получить встраиваемую библиотеку MySQL (<tt>`libmysqld.a'</tt>),
используйте опцию <code>--with-embedded-server</code>.

<LI>

Если вы не хотите, чтобы ваши системные журналы и каталоги баз данных
располагались в каталоге <tt>`/usr/local/var'</tt>, то используйте команду
<code>configure</code> наподобие одной из приведенных ниже:


<pre>
shell&#62; ./configure --prefix=/usr/local/mysql
shell&#62; ./configure --prefix=/usr/local \
      --localstatedir=/usr/local/mysql/data
</pre>

Первая команда изменяет установочный префикс, в результате чего весь код
будет установлен в каталоге <tt>`/usr/local/mysql'</tt> вместо принятого по умолчанию
<tt>`/usr/local'</tt>. Вторая команда сохраняет принятый по умолчанию установочный
префикс, но переопределяет принятое по умолчанию местоположение каталогов
базы данных (обычно <tt>`/usr/local/var'</tt>) и изменяет его на
<tt>`/usr/local/mysql/data'</tt>. После завершения компиляции MySQL эти опции можно
изменить с помощью файлов опций (see section <A HREF="manual.ru_MySQL_Database_Administration.html#Option_files">4.1.2  Файлы параметров <tt>`my.cnf'</tt></A>)

<A NAME="IDX224"></A>
<A NAME="IDX225"></A>
<A NAME="IDX226"></A>

<LI>

Если вы работаете под Unix и хотите, чтобы сокет MySQL находился в
каком-либо другом, отличном от принятого по умолчанию, месте (обычно
по умолчанию задается каталог <tt>`/tmp'</tt> или <tt>`/var/run'</tt>), используйте команду
configure, подобную следующей:


<pre>
shell&#62; ./configure --with-unix-socket-path=/usr/local/mysql/tmp/mysql.sock
</pre>

Следует учитывать, что данный файл должен представлять собой полный путь к
каталогу! Позже местоположение mysql.sock можно также изменить, используя
файлы опций MySQL (see section <A HREF="manual.ru_Problems.html#Problems_with_mysql.sock">A.4.5  Как защитить или изменить сокет-файл MySQL <tt>`/tmp/mysql.sock'</tt></A>).

<A NAME="IDX227"></A>
<A NAME="IDX228"></A>

<LI>

Если необходимо компилировать статически линкованные программы
(например, чтобы создать бинарный дистрибутив, или чтобы повысить
скорость, или чтобы обойти проблемы некоторых дистрибутивов RedHat
Linux), запустите <code>configure</code> так, как показано ниже:


<pre>
shell&#62; ./configure --with-client-ldflags=-all-static \
      --with-mysqld-ldflags=-all-static
</pre>

<A NAME="IDX229"></A>
<A NAME="IDX230"></A>
<A NAME="IDX231"></A>
<A NAME="IDX232"></A>
<A NAME="IDX233"></A>
<A NAME="IDX234"></A>
<A NAME="IDX235"></A>

<LI>

При использовании <code>gcc</code> без установленной библиотеки <code>libg++</code> или
<code>libstdc++</code> можно предписать <code>configure</code> в качестве компилятора C++
использовать <code>gcc</code>:


<pre>
shell&#62; CC=gcc CXX=gcc ./configure
</pre>

Если <code>gcc</code> используется как компилятор C++, то он не будет пробовать
линковаться с <code>libg++</code> или <code>libstdc++</code>. Это может оказаться полезным даже если
такие библиотеки установлены, поскольку при использовании некоторых версий
вышеназванных библиотек в прошлом у пользователей MySQL возникали
непонятные проблемы.

Ниже приводятся установки некоторых общих
переменных окружения в зависимости от используемого компилятора:

<A NAME="IDX236"></A>
<A NAME="IDX237"></A>

<TABLE BORDER WIDTH="100%">
<TR><TD><strong>Компилятор</strong> </TD><TD> <strong>Рекомендуемые опции</strong>
</TD></TR>
<TR><TD>gcc 2.7.2.1 </TD><TD>
CC=gcc CXX=gcc CXXFLAGS="-O3 -felide-constructors"
</TD></TR>
<TR><TD>egcs 1.0.3a </TD><TD>
CC=gcc CXX=gcc CXXFLAGS="-O3 -felide-constructors -fno-exceptions -fno-rtti"
</TD></TR>
<TR><TD>gcc 2.95.2 </TD><TD>
CFLAGS="-O3 -mpentiumpro" CXX=gcc CXXFLAGS="-O3 -mpentiumpro \
-felide-constructors -fno-exceptions -fno-rtti"
</TD></TR>
<TR><TD>pgcc 2.90.29 or newer </TD><TD>
CFLAGS="-O3 -mpentiumpro -mstack-align-double" CXX=gcc \
CXXFLAGS="-O3 -mpentiumpro -mstack-align-double -felide-constructors \
-fno-exceptions -fno-rtti"
</TD></TR>
</TABLE>

В большинстве случаев можно получить достаточно оптимальный бинарный код
MySQL путем использования опций предыдущей таблицы и добавления в
командной строке следующих опций:


<pre>
--prefix=/usr/local/mysql --enable-assembler \
--with-mysqld-ldflags=-all-static
</pre>

Другими словами, полная строка конфигурации для всех последних версий gcc
должна быть подобна приведенной ниже:


<pre>
CFLAGS="-O3 -mpentiumpro" CXX=gcc CXXFLAGS="-O3 -mpentiumpro \
-felide-constructors -fno-exceptions -fno-rtti" ./configure \
--prefix=/usr/local/mysql --enable-assembler \
--with-mysqld-ldflags=-all-static
</pre>

Все бинарные коды, которые мы поставляем с веб-сайта MySQL на
<a HREF="http://www.mysql.com/">http://www.mysql.com/</a>, компилируются с максимальной оптимизацией и должны
быть идеальными для большинства пользователей (see section <A HREF="manual.ru_Installing.html#MySQL_binaries">2.2.9  Бинарные коды MySQL, скомпилированные в MySQL AB</A>). Существуют некоторые настройки, позволяющие сделать
бинарный код даже еще быстрее, но их могут выполнять только опытные
пользователи (see section <A HREF="manual.ru_MySQL_Optimisation.html#Compile_and_link_options">5.5.3  Как компиляция и линкование влияет на скорость MySQL</A>).

Если создать код не удается и при этом выдаются ошибки с указанием
на компилятор или если компоновщик не в состоянии создать совместную
библиотеку <tt>`libmysqlclient.so.#'</tt> (<samp>`#'</samp> представляет собой номер версии), то
эту проблему можно обойти путем добавления к <code>configure</code> опции
<code>--disable-shared</code>. В этом случае <code>configure</code> не будет создавать совместную
библиотеку <tt>`libmysqlclient.so.#'</tt>.

<A NAME="IDX238"></A>
<A NAME="IDX239"></A>

<LI>

Можно сконфигурировать MySQL таким образом, чтобы не использовать
величины <code>DEFAULT</code> на столбцах не-<code>NULL</code> (т.е. на столбцах, которые не
могут принимать значение <code>NULL</code>). При указании этой опции команды <code>INSERT</code>
будут генерировать ошибку в случае, если явно не указаны  величины для
всех столбцов, которые не могут принимать значение <code>NULL</code>. Чтобы
запретить использование величин по умолчанию, запустите <code>configure</code>, как
показано ниже:

<A NAME="IDX240"></A>
<A NAME="IDX241"></A>

<pre>
shell&#62; CXXFLAGS=-DDONT_USE_DEFAULT_FIELDS ./configure
</pre>

<A NAME="IDX242"></A>
<A NAME="IDX243"></A>
<A NAME="IDX244"></A>

<LI>

По умолчанию в MySQL используется кодировка ISO-8859-1 (Latin1). Для
изменения кодировки, принятой по умолчанию, следует применить опцию
<code>--with-charset</code>:


<pre>
shell&#62; ./configure --with-charset=CHARSET
</pre>

<code>CHARSET</code> может принимать одно из следующих значений: <code>big5</code>, <code>cp1251</code>,
<code>cp1257</code>, <code>czech</code>, <code>danish</code>, <code>dec8</code>, <code>dos</code>, <code>euc_kr</code>, <code>gb2312</code>, <code>gbk</code>, <code>german1</code>, <code>hebrew</code>,
<code>hp8</code>, <code>hungarian</code>, <code>koi8_ru</code>, <code>koi8_ukr</code>, <code>latin1</code>, <code>latin2</code>, <code>sjis</code>, <code>swe7</code>, <code>tis620</code>,
<code>ujis</code>, <code>usa7</code> или <code>win1251ukr</code> (see section <A HREF="manual.ru_MySQL_Database_Administration.html#Character_sets">4.6.1  Набор символов, применяющийся для записи данных и сортировки</A>). Если требуется преобразовывать символы между сервером и
клиентом, следует рассмотреть команду <code>SET CHARACTER SET</code> (see section <A HREF="manual.ru_MySQL_Optimisation.html#SET_OPTION">5.5.6  Синтаксис команды <code>SET</code></A>).

<A NAME="IDX245"></A>
<strong>Предупреждение</strong>: если набор символов изменяется после создания
таблиц, необходимо запустить <code>myisamchk -r -q --set-characted-set=charset</code> на каждой таблице. В
противном случае индексы могут сортироваться неправильно (такое может
случиться, если вы установите MySQL, создадите ряд таблиц, затем
переконфигурируете MySQL с целью использования другого набора символов и
заново установите MySQL).

С помощью опции <code>--with-extra-charsets=LIST</code> можно
определить, какие дополнительные кодировки необходимо скомпилировать в
данном сервере.

Здесь <code>LIST</code> либо представляет собой разделенный пробелами
список кодировок, либо имеет значение <code>complex</code> для включения всех символов,
которые не могут быть загружены динамически, либо имеет значение <code>all</code> для
включения всех кодировок в бинарники.

<LI>

Для конфигурации MySQL с кодом отладки используйте опцию <code>--with-debug</code>:


<pre>
shell&#62; ./configure --with-debug
</pre>

Задание этой опции вызывает подключение надежного распределителя памяти,
который может найти некоторые ошибки и обеспечить вывод информации о том,
что происходит (see section <A HREF="manual.ru_Porting.html#Debugging_server">E.1  Отладка сервера MySQL</A>).

<LI>

Если клиентские программы используют потоки, то необходимо также
скомпилировать поддерживающую потоки версию клиентской библиотеки
MySQL с опцией конфигурации <code>--enable-thread-safe-client</code>. При указании
этой опции будет создана библиотека <code>libmysqlclient_r</code>, с которой
следует линковать потоковые приложения (see section <A HREF="manual.ru_Clients.html#Threaded_clients">8.4.8  Как создать клиентскую программу с потоками</A>).

<LI>

Опции, относящиеся к конкретным системам, можно найти в разделах
данного руководства, в которых описываются особенности различных
операционных систем (see section <A HREF="manual.ru_Installing.html#Operating_System_Specific_Notes">2.6  Заметки по операционным системам</A>).
</ul>



<H3><A NAME="Installing_source_tree" HREF="manual.ru_toc.html#Installing_source_tree">2.3.4  Установка из экспериментального набора исходных кодов</A></H3>

<P>
<A NAME="IDX246"></A>
<A NAME="IDX247"></A>
<A NAME="IDX248"></A>

</P>
<P>
<strong>Предупреждение</strong>: этот раздел необходимо читать только в том случае, если вы
хотите помочь нам в тестировании нового кода. Пользователи, которые просто
хотят установить MySQL и запустить его на своей системе, должны
использовать стандартную версию дистрибутива (либо исходный код, либо
бинарный дистрибутив).

</P>
<P>
Чтобы получить самый последний из разработанных наборов исходных кодов,
используйте следующие инструкции:

</P>

<ol>
<LI>

Загрузите программу <code>BitKeeper</code> с
<a HREF="http://www.bitmover.com/cgi-bin/download.cgi">http://www.bitmover.com/cgi-bin/download.cgi</a>. Для доступа к нашему
хранилищу вам понадобится версия <code>Bitkeeper</code> 3.0 или более новая.

<LI>

Выполните инструкции по установке этой программы.

<LI>

После установки <code>BitKeeper</code> сначала перейдите в каталог, из которого
собираетесь работать, затем используйте одну из приведенных ниже команд, 
для получения желаемой копии ветви MySQL. 

Чтобы клонировать ветку 3.23:


<pre>
shell&#62; bk clone bk://mysql.bkbits.net/mysql-3.23 mysql-3.23
</pre>

Чтобы клонировать ветку 4.0:


<pre>
shell&#62; bk clone bk://mysql.bkbits.net/mysql-4.0 mysql-4.0
</pre>

Чтобы клонировать ветку 4.1:


<pre>
shell&#62; bk clone bk://mysql.bkbits.net/mysql-4.1 mysql-4.1
</pre>

В предыдущих примерах набор исходных кодов будет установлен в подкаталогах
<tt>`mysql-3-23/'</tt>, <tt>`mysql-4.0/'</tt> или <tt>`mysql-4.1/'</tt> вашего текущего каталога. 

Если вы находитесь за брендмауером, и можете только делать HTTP-запросы, вы можете
также использовать BitKeeper по HTTP. 

Если вы используете прокси-сервер, просто установите переменную окружения 
<code>http_proxy</code>: 


<pre>
shell&#62; export http_proxy="http://your.proxy.server:8080/"
</pre>

И теперь просто замените <code>bk://</code> на <code>http://</code> когда будете делать клонирование. Например: 


<pre>
shell&#62; bk clone http://mysql.bkbits.net/mysql-4.1 mysql-4.1
</pre>

Первоначальная загрузка набора исходных кодов может потребовать времени в
зависимости от скорости вашего соединения; будьте терпеливы.

<LI>

Чтобы запустить следующий набор команд, вам понадобятся программы GNU
<code>make</code>, <code>autoconf 2.53</code> (или новее), <code>automake 1.5</code>,
<code>libtool 1.4</code> и <code>m4</code>. Программа <code>automake 1.7</code> (или новее) еще
не работает. 

Если вы хотите настроить MySQL 4.1, вам также потребуется <code>bison 1.75</code>.
Более старые версии <code>bison</code> могут давать такую ошибку:
<code>sql_yacc.yy:#####: fatal error: maximum table size (32767) exceeded</code>. На
самом деле максимальный размер таблиц не превышается, как утверждает это
сообщение, но просто-напросто такое сообщение есть следствие ошибки в более
ранних версиях <code>bison</code>. 

Типичные команды к выполнению в оболочке: 


<pre>
cd mysql-4.0
bk -r get -Sq
aclocal; autoheader; autoconf; automake
(cd innobase ; aclocal; autoheader; autoconf; automake) # для InnoDB
(cd bdb/dist ; sh s_all ) # для Berkeley DB
./configure  # Ваши любимые опции здесь
make
</pre>

Если вы получаете некие странные сообщения на этом этапе  - удостоверьтесь,
что у вас действительно стоит <code>libtool</code>! 

Собрание наших стандартных конфигурационных скриптов находится в
подкаталоге <tt>`BUILD/'</tt>. Если вы предпочитаете наиболее легкий путь, можно
использовать скрипт <tt>`BUILD/compile-pentium-debug'</tt>. При компилировании с
использованием другой архитектуры модифицируйте этот скрипт путем удаления
флагов, относящихся к Pentium.

<LI>

После выполнения компиляции запустите <code>make install</code>. Следует проявлять
осторожность при работе на машине, находящейся в эксплуатации; данная
команда может выполнить установку поверх вашей существующей
установленной версии. Если у вас уже установлена иная версия MySQL, мы
рекомендуем запускать <code>./configure</code> со значениями для опций <code>prefix</code>,
<code>with-tcp-port</code> и <code>unix-socket-path</code>, отличными от тех, что были
использованы для сервера, находящегося в эксплуатации.

<LI>

Усиленно нагружая свою новую инсталляцию, попытайтесь добиться отказа
новых возможностей. Начинайте с запуска <code>make test</code> (see section <A HREF="manual.ru_Extending_MySQL.html#MySQL_test_suite">9.1.2  Пакет тестирования MySQL</A>).

<LI>

Если вам удастся дойти до этапа <code>make</code> и дистрибутив не будет
компилироваться, просьба сообщить нам об этом по адресу
<a HREF="mailto:bugs@lists.mysql.com">bugs@lists.mysql.com</a>. Просьба информировать нас и в том случае, если
вы установили последнюю версию требуемых инструментальных средств GNU
и они терпят крах при попытке обработать наш конфигурационный файл.
Однако если при выполнении <code>aclocal</code> вы получите ошибку <code>command not
found</code> или возникнет аналогичная проблема, об этом сообщать не надо. В
таком случае следует убедиться, что у вас установлены все необходимые
инструментальные программы и что ваша переменная <code>PATH</code> указана
правильно, чтобы оболочка могла найти их.

<LI>

Для того чтобы получить набор исходных кодов после начальной операции
<code>bk clone</code>, необходимо периодически запускать <code>bk pull</code> для получения
обновлений.

<LI>

Вы можете изучить историю изменений дерева исходных кодов, чтобы
увидеть все отличия в них - для этого следует использовать <code>bk
sccstool</code>. При обнаружении каких-либо отличий, которые покажутся вам
странными, или кода, по которому возникают вопросы, не раздумывайте -
посылайте письмо на <a HREF="mailto:internals@lists.mysql.com">internals@lists.mysql.com</a>. Кроме того, если вы
считаете, что у вас есть лучшие идеи по разработке, отправьте по тому
же адресу сообщение со своим патчем. <code>bk diffs</code> создает патч после
внесения изменений в исходный код. Если у вас нет времени написать
код, реализующий вашу идею, просто пришлите ее описание.

<LI>

BitKeeper имеет хорошую вспомогательную программу, которая доступна
посредством <code>bk helptool</code>.

<LI>

Внимание: любой commit (<code>bk ci</code> или <code>bk citool</code>) инициирует постинг 
сообщения с изменениями в наш внутренний список рассылки (internals).
В общем случае, вам не нужно использовать commit (поскольку публично-доступное
дерево не допустит <code>bk push</code>), но скорее, метод <code>bk diffs</code>, описанный ранее. 
</ol>

<P>
Вы также можете просматривать изменения, комментарии и исходный код в онлайн, например,
по адресу <a HREF="http://mysql.bkbits.net:8080/mysql-4.1">http://mysql.bkbits.net:8080/mysql-4.1</a> для MySQL 4.1.

</P>
<P>
Руководство находится в отдельном дереве, которое можно клонировать так: 

</P>

<pre>
shell&#62; bk clone bk://mysql.bkbits.net/mysqldoc mysqldoc
</pre>



<H3><A NAME="Compilation_problems" HREF="manual.ru_toc.html#Compilation_problems">2.3.5  Проблемы с компиляцией?</A></H3>

<P>
<A NAME="IDX249"></A>
<A NAME="IDX250"></A>
<A NAME="IDX251"></A>
<A NAME="IDX252"></A>
<A NAME="IDX253"></A>

</P>
<P>
На Solaris или Linux с использованием компилятора <code>gcc</code> все программы MySQL у нас
компилируются чисто и без каких-либо предупреждений. В других системах
могут возникать предупреждения из-за различий включаемых системных файлов
(по поводу предупреждений, которые могут возникать при использовании
потоков <code>MIT-pthreads</code>, обращайтесь к разделу see section <A HREF="manual.ru_Installing.html#MIT-pthreads">2.3.6  Замечания по потокам MIT-pthreads</A>).
Относительно других проблем сверьтесь с приведенным ниже списком.

</P>
<P>
Решение многих проблем предполагает выполнение переконфигурирования. В
случаях, когда переконфигурирование действительно необходимо, следует
учитывать следующее:

</P>
<P>
<A NAME="IDX254"></A>
<A NAME="IDX255"></A>
<A NAME="IDX256"></A>

</P>

<ul>
<LI>

Если <code>configure</code> запускается после того, как эта команда уже
запускалась, то можно использовать информацию, которая была собрана во
время предыдущего вызова команды (такая информация хранится в
<tt>`config.cache'</tt>). При запуске <code>configure</code> ищет данный файл и, если он
существует, читает его содержимое, исходя из предположения, что данная
информация все еще правильна. При выполнении переконфигурации это
предположение является некорректным.

<LI>

Каждый раз при запуске <code>configure</code> необходимо опять запускать <code>make</code> для
перекомпилирования. Однако, возможно, вначале вам потребуется удалить
старые объектные файлы из предыдущих компоновок, поскольку они были
скомпилированы с использованием других опций конфигурации.

Чтобы не допустить использования старой конфигурационной информации или
объектных файлов, перед перезапуском <code>configure</code> запустите следующие
команды:


<pre>
shell&#62; rm config.cache
shell&#62; make clean
</pre>

В качестве альтернативного варианта можно использовать команду <code>make
distclean</code>.

В следующем списке представлены некоторые проблемы компилирования MySQL,
которые, как оказалось, возникают наиболее часто:

<A NAME="IDX257"></A>
<A NAME="IDX258"></A>
<A NAME="IDX259"></A>
<A NAME="IDX260"></A>
<A NAME="IDX261"></A>
<A NAME="IDX262"></A>

<LI>

Если при компиляции <tt>`sql_yacc.cc'</tt> вы получаете ошибки, подобные
представленным ниже, то, возможно, произошел выход за пределы памяти
или пространства подкачки (свопинга):


<pre>
Internal compiler error: program cc1plus got fatal signal 11
или
Out of virtual memory
или
Virtual memory exhausted
</pre>

Проблема заключается в том, что для компиляции <tt>`sql_yacc.cc'</tt> со
встраиваемыми функциями компилятору <code>gcc</code> требуется значительное количество
памяти. Попробуйте произвести запуск <code>configure</code> с опцией <code>--with-low-memory</code>:


<pre>
shell&#62; ./configure --with-low-memory
</pre>

Данная опция вызывает добавление <code>-fno-inline</code> к компилируемой строке для
<code>gcc</code> и <code>-O0</code> - при использовании какого-либо другого компилятора. Даже если у
вас столько памяти и пространства для свопинга, что, по вашему мнению,
невозможно выйти за их пределы, все же стоит попытаться использовать опцию
<code>with-low-memory</code>. Эта проблема, по нашим наблюдениям, возникала даже на
системах с аппаратными реализациями, обладающими широкими возможностями;
обычно она устраняется с помощью опции <code>--with-low-memory</code>.

<LI>

По умолчанию <code>configure</code> выбирает c++ как имя компилятора и GNU c++
линкуется с <code>-lg++</code>. При использовании <code>gcc</code> этот режим работы может
вызывать такие проблемы в процессе конфигурации, как:

<A NAME="IDX263"></A>


<pre>
configure: error: installation or configuration problem:
C++ compiler cannot create executables.
</pre>

<A NAME="IDX264"></A>
<A NAME="IDX265"></A>

Во время компиляции могут также возникать проблемы, относящиеся к <code>g++</code>,
<code>libg++</code> или <code>libstdc++</code>. Одна из причин их возникновения заключается в том,
что, возможно, у вас нет <code>g++</code> или есть <code>g++</code>, но нет библиотеки <code>libg++</code> или
<code>libstdc++</code>. Следует изучить файл <tt>`config.log'</tt> - по нему вы должны точно
определить причину, по которой не работал компилятор c++ ! Чтобы обойти
эти проблемы, можно в качестве компилятора C++ использовать gcc.
Попробуйте установить переменную окружения <code>CXX</code> в <code>gcc -O3</code>. Например:

<A NAME="IDX266"></A>
<A NAME="IDX267"></A>


<pre>
shell&#62; CXX="gcc -O3" ./configure
</pre>

Эта команда работает, поскольку gcc компилирует исходные коды C++ так же
хорошо, как и <code>g++</code>, но по умолчанию не линкует <code>libg++</code> или <code>libstdc++</code>.
Есть, конечно, и другая возможность устранения этих проблем, которая
заключается в установке <code>g++</code>, <code>libg++</code> и <code>libstdc++</code>. Однако мы не
рекомендовали бы использовать <code>libg++</code> или <code>libstdc++</code> с MySQL, поскольку это
только увеличит размер бинарного кода <code>mysqld</code> без предоставления каких-либо
преимуществ. Некоторые версии этих библиотек в прошлом также вызывали
непонятные проблемы у пользователей MySQL.

<LI>

Если процесс компиляции завершается аварийно и выводятся такие ошибки,
как приведены ниже, то вам следует сделать апгрейд своей версии <code>make</code>
до GNU <code>make</code>:


<pre>
making all in mit-pthreads
make: Fatal error in reader: Makefile, line 18:
Badly formed macro assignment
или
make: file `Makefile' line 18: Must be a separator (:
или
pthread.h: No such file or directory
</pre>

<A NAME="IDX268"></A>
<A NAME="IDX269"></A>
<A NAME="IDX270"></A>
<A NAME="IDX271"></A>

Операционные системы Solaris и FreeBSD, как известно, имеют ненадежные
программы <code>make</code>. 

Известно также, что версия GNU <code>make</code> 3.75 работает.

<A NAME="IDX272"></A>
<A NAME="IDX273"></A>
<A NAME="IDX274"></A>
<A NAME="IDX275"></A>
<A NAME="IDX276"></A>
<A NAME="IDX277"></A>
<A NAME="IDX278"></A>
<A NAME="IDX279"></A>

<LI>

Если вы хотите определить флаги для использования их компиляторами C
или C++, следует добавить флаги к переменным окружения <code>CFLAGS</code> и
<code>CXXFLAGS</code>. Точно так же можно также указать имена компиляторов,
используя <code>CC</code> и <code>CXX</code>. Например:


<pre>
shell&#62; CC=gcc
shell&#62; CFLAGS=-O3
shell&#62; CXX=gcc
shell&#62; CXXFLAGS=-O3
shell&#62; export CC CFLAGS CXX CXXFLAGS
</pre>

В разделе section <A HREF="manual.ru_Installing.html#MySQL_binaries">2.2.9  Бинарные коды MySQL, скомпилированные в MySQL AB</A> приведен список полезных для
различных систем определений флагов.

<LI>

При получении сообщения об ошибке, подобного приведенному ниже,
необходимо модернизировать ваш компилятор <code>gcc</code>:


<pre>
client/libmysql.c:273: parse error before `__attribute__'
</pre>

Компилятор <code>gcc</code> 2.8.1 известен как работающий, но мы рекомендуем вместо
него использовать <code>gcc</code> 2.95.2 или <code>egcs</code> 1.0.3a.

<LI>

Если при компиляции <code>mysqld</code> вы получаете ошибки, подобные приведенным
ниже, то это означает, что команда <code>configure</code> некорректно определила
тип последнего аргумента в функциях <code>accept()</code>, <code>getsockname()</code> или
<code>getpeername()</code>:


<pre>
cxx: Error: mysqld.cc, line 645: In this statement, the referenced
type of the pointer value "&#38;length" is "unsigned long", which
is not compatible with "int".
new_sock = accept(sock, (struct sockaddr *)&#38;cAddr, &#38;length);
</pre>

Чтобы устранить эту ошибку, отредактируйте файл <tt>`config.h'</tt> (который
генерируется <code>configure</code>). Найдите в нем следующие строки:


<pre>
/* Define as the base type of the last arg to accept */
#define SOCKET_SIZE_TYPE XXX
</pre>

и измените <code>XXX</code> на <code>size_t</code> или <code>int</code> - в зависимости от своей операционной
системы (учтите, что эти действия необходимо будет повторять каждый раз
при запуске <code>configure</code>, поскольку configure восстанавливает файл
<tt>`config.h'</tt>).

<LI>

Файл <tt>`sql_yacc.cc'</tt> генерируется из <tt>`sql_yacc.yy'</tt>. Обычно в процессе сборки
не требуется создавать <tt>`sql_yacc.cc'</tt>, поскольку MySQL поставляется с уже
сгенерированной копией. Однако если действительно необходимо создать
этот файл заново, то можно столкнуться со следующей ошибкой:


<pre>
"sql_yacc.yy", line xxx fatal: default action causes potential...
</pre>

Это признак того, что ваша версия <code>yacc</code> является неполной. Возможно,
следует установить <code>bison</code> (GNU-версия yacc) и использовать вместо <code>yacc</code>.

<LI>

При необходимости отладки <code>mysqld</code> или клиента MySQL запустите <code>configure</code>
с опцией <code>--with-debug</code>, затем перекомпилируйте и слинкуйте эти
программы с новой клиентской библиотекой (see section <A HREF="manual.ru_Porting.html#Debugging_client">E.2  Отладка клиента MySQL</A>).
</ul>



<H3><A NAME="MIT-pthreads" HREF="manual.ru_toc.html#MIT-pthreads">2.3.6  Замечания по потокам MIT-pthreads</A></H3>

<P>
<A NAME="IDX280"></A>
<A NAME="IDX281"></A>
<A NAME="IDX282"></A>

</P>

<P>
В этом разделе описываются некоторые аспекты использования потоков
MIT-pthreads.

</P>
<P>
Следует иметь в виду, что под Linux использовать потоки MIT-pthreads
нельзя, для этого необходимо установить LinuxThreads! See section <A HREF="manual.ru_Installing.html#Linux">2.6.1  Примечания к Linux (Все версии Linux)</A>.

</P>
<P>
Если ваша система сама по себе не обеспечивает поддержку потоков, то
необходимо скомпоновать MySQL, используя пакет поддержки MIT-pthreads. К
таким системам относятся старые системы FreeBSD, SunOS 4.x, Solaris 2.4 и
более ранние, а также некоторые другие (see section <A HREF="manual.ru_Installing.html#Which_OS">2.2.5  Операционные системы, поддерживаемые MySQL</A>).

</P>
<P>
Заметьте, с версии MySQL 4.0.2 потоки MIT более не присутствуют в поставке исходных
текстов. Если вам действительно нужен этот пакет, вы можете его забрать с 
http://www.mysql.com/Downloads/Contrib/pthreads-1_60_beta6-mysql.tar.gz

</P>
<P>
После загрузки, распакуйте этот архив в каталог исходных текстов MySQL.
Создастся новый каталог <code>mit-pthreads</code>.

</P>


<ul>
<LI>

Для большинства систем можно обеспечить использование потоков
MIT-pthreads при помощи запуска <code>configure</code> с опцией <code>--with-mit-threads</code>:


<pre>
shell&#62; ./configure --with-mit-threads
</pre>

При использовании потоков MIT-pthreads не поддерживается возможность
сборки MySQL в каталоге, не содержащем исходный код, поскольку мы хотим
минимизировать наши изменения в данном коде.

<LI>

Проверки, определяющие, используются ли потоки MIT-pthreads,
производятся только во время этапа конфигурационного процесса,
относящегося к серверному коду. Если дистрибутив сконфигурирован с
использованием <code>--without-server</code> для сборки только клиентского кода,
то клиенты не будут знать, применяются ли потоки MIT-pthreads, и будут
использовать подключения через сокеты Unix по умолчанию. Поскольку сокеты Unix
не работают с потоками MIT-pthreads на некоторых платформах, то при запуске
клиентских программ следует использовать <code>-h</code> или <code>--host</code>.

<LI>

При компиляции MySQL с использованием потоков MIT-pthreads
блокирование системы отключено по умолчанию из соображений
производительности. Можно предписать серверу использовать системную
блокировку с помощью опции <code>--use-external-locking</code>. Это только
необходимо если вы собираетесь использовать два MySQL-сервера на одних
и тех же файлах данных (не рекомендуется!).

<LI>

Иногда потоковой команде <code>bind()</code> не удается подсоединить сокет без
какого-либо сообщения об ошибке (по крайней мере, под Solaris). В
результате все подключения к серверу обрываются. Например:


<pre>
shell&#62; mysqladmin version
mysqladmin: connect to server at '' failed;
error: 'Can't connect to mysql server on localhost (146)'
</pre>

Для решения этой проблемы следует завершить выполнение сервера <code>mysqld</code> и
перезапустить его. У нас это происходило только в тех случаях, когда мы
прерывали работу сервера и сразу же снова его запускали.

<LI>

При использовании потоков MIT-pthreads системный вызов функции <code>sleep()</code> 
не прерывается с помощью <code>SIGINT</code> (<code>break</code>). Это заметно только в том
случае, если запускать <code>mysqladmin --sleep</code>. Следует ждать окончания
работы <code>sleep()</code>, прежде чем прерывание будет обслужено и процесс
завершит работу.

<LI>

При линковании можно получить предупреждающие сообщения, подобные
приведенным ниже (по крайней мере под Solaris); их можно игнорировать:


<pre>
ld: warning: symbol `_iob' has differing sizes:
    (file /my/local/pthreads/lib/libpthread.a(findfp.o) value=0x4;
file /usr/lib/libc.so value=0x140);
    /my/local/pthreads/lib/libpthread.a(findfp.o) definition taken
ld: warning: symbol `__iob' has differing sizes:
    (file /my/local/pthreads/lib/libpthread.a(findfp.o) value=0x4;
file /usr/lib/libc.so value=0x140);
    /my/local/pthreads/lib/libpthread.a(findfp.o) definition taken
</pre>

<LI>

Некоторые другие предупреждения также можно игнорировать:


<pre>
implicit declaration of function `int strtoll(...)'
implicit declaration of function `int strtoul(...)'
</pre>

<LI>

Нам не удалось добиться совместной работы <code>readline</code> с потоками
MIT-pthreads (это не является необходимым, но для кого-то может
представлять интерес).
</ul>



<H3><A NAME="Windows_source_build" HREF="manual.ru_toc.html#Windows_source_build">2.3.7  Дистрибутив исходного кода для Windows</A></H3>

<P>
Вам потребуются следующие средства:

</P>

<ul>
<LI>

Компилятор VC++ 6.0 (усовершенствованный с помощью служебных пакетов 4
SP или 5 SP и пакета предварительной обработки) Пакет предварительной
обработки необходим для макроассемблера. Более подробная информация
находится на: <a HREF="http://msdn.microsoft.com/vstudio/sp/vs6sp5/faq.asp">http://msdn.microsoft.com/vstudio/sp/vs6sp5/faq.asp</a>.
<LI>

Дистрибутив исходного кода MySQL для Windows, который может быть
загружен с <a HREF="http://www.mysql.com/downloads/">http://www.mysql.com/downloads/</a>.
</ul>

<P>
Сборка MySQL

</P>

<ol>
<LI>

Создайте рабочий каталог (т.е. <code>workdir</code>).
<LI>

Распакуйте дистрибутив исходного кода в вышеупомянутом каталоге.
<LI>

Запустите компилятор VC++ 6.0.
<LI>

В меню <code>File</code> выберите <code>Open Workspace</code>.
<LI>

Откройте рабочую область <code>mysql.dsw</code>, находящуюся в рабочем каталоге.
<LI>

В меню <code>Build</code> выберите подменю <code>Set Active Configuration</code>.
<LI>

Выберите в появившемся окне <code>mysqld</code> - <code>Win32 Debug</code> и нажмите <code>OK</code>.
<LI>

Нажмите клавишу <code>F7</code>, чтобы начать процесс построения отладочных версий
сервера, библиотек и некоторых клиентских приложений.
<LI>

По окончании компиляции скопируйте библиотеки и исполняемые файлы в
отдельный каталог.
<LI>

Тем же способом скомпилируйте рабочие версии (релизы), которые вам
нужны.
<LI>

Создайте каталог для всего, что нужно MySQL, т.е. <tt>`c:\mysql'</tt> 
<LI>

Из каталога <code>workdir</code> скопируйте в каталог <tt>`c:\mysql'</tt> следующие
подкаталоги:


<ul>
<LI>Data (данные)

<LI>Docs (документация)

<LI>Share (совместно используемые ресурсы)

</ul>

<LI>

Создайте каталог <tt>`c:\mysql\bin'</tt> и скопируйте в него все скомпилированные
перед этим серверы и клиенты.
<LI>

При желании можете также создать каталог <tt>`lib'</tt> и скопировать в него
скомпилированные ранее библиотеки.
<LI>

Произведите очистку, используя Visual Studio.

Установите и запустите сервер тем же способом, что и для бинарного
дистрибутива для Windows (see section <A HREF="manual.ru_Installing.html#Windows_prepare_environment">2.1.2.2  Подготовка конфигурации MySQL для Windows</A>).
</ol>



<H2><A NAME="Post-installation" HREF="manual.ru_toc.html#Post-installation">2.4  Послеустановочные настройка и тестирование</A></H2>

<P>
<A NAME="IDX283"></A>
<A NAME="IDX284"></A>
<A NAME="IDX285"></A>

</P>

<P>
После установки MySQL (из бинарного дистрибутива или исходного кода)
необходимо проинициализировать таблицы привилегий, запустить сервер и
убедиться, что сервер работает нормально. Можно также организовать
автоматический запуск и остановку сервера, когда операционная система
соответственно начинает и прекращает работу.

</P>
<P>
Обычно при установке из исходного кода для установки таблиц привилегий и
запуска сервера нужно выполнить следующие команды:

</P>
<P>
<A NAME="IDX286"></A>

</P>

<pre>
shell&#62; ./scripts/mysql_install_db
shell&#62; cd mysql_installation_directory
shell&#62; ./bin/safe_mysqld --user=mysql &#38;
</pre>

<P>
Для бинарного дистрибутива (но не для пакетов RPM или pkg) сделайте так:

</P>

<pre>
shell&#62; cd mysql_installation_directory
shell&#62; ./scripts/mysql_install_db
shell&#62; ./bin/safe_mysqld --user=mysql &#38;
</pre>

<P>
или

</P>

<pre>
shell&#62; ./bin/mysqld_safe --user=mysql &#38;
</pre>

<P>
Если вы используете MySQL 4.x.

</P>
<P>
Эти операции создают базу данных <code>mysql</code>, которая будет поддерживать все
привилегии доступа к базе данных, базу данных <code>test</code>, которую можно
использовать для тестирования MySQL, а также записи привилегий для
пользователя, который запускает <code>mysql_install_db</code> и для пользователя <code>root</code>
(без каких-либо паролей). При этом также запускается сервер <code>mysqld</code>.

</P>
<P>
<code>mysql_install_db</code> не перезаписывает старые таблицы привилегий, так что ее
запуск будет безопасным в любом случае. Если вам не нужна база данных
<code>test</code>, ее можно удалить с помощью <code>mysqladmin -u root drop test</code>.

</P>
<P>
Тестирование проще всего выполнить из каталога наивысшего уровня
дистрибутива MySQL. Для бинарного дистрибутива таковым является ваш
каталог инсталляции (обычно что-нибудь вроде <tt>`/usr/local/mysql'</tt>). Для
дистрибутива в виде исходного кода это - главный каталог вашего набора
исходных кодов MySQL.

</P>
<P>
<A NAME="IDX287"></A>

</P>
<P>
В командах, представленных в настоящем разделе и последующих подразделах,
<code>BINDIR</code> представляет собой путь к тому местоположению, где устанавливаются
программы вроде <code>mysqladmin</code> и <code>safe_mysqld</code>. Для бинарного дистрибутива это
каталог <tt>`bin'</tt> внутри дистрибутива. Для дистрибутива в виде исходного кода
<code>BINDIR</code> может представлять собой <tt>`/usr/local/bin'</tt>, если при запуске
<code>configure</code> не указан иной, чем <tt>`/usr/local'</tt> инсталляционный каталог.
<code>EXECDIR</code> - место, где устанавливается сервер <code>mysqld</code>. Для бинарного
дистрибутива это то же самое, что и <code>BINDIR</code>. Для дистрибутива в виде
исходного кода <code>EXECDIR</code> может представлять собой <tt>`/usr/local/libexec'</tt>.

</P>
<P>
Подробное описание тестирования:
<A NAME="IDX288"></A>

</P>

<ol>
<LI>

Если необходимо, запустите сервер <code>mysqld</code> и установите исходные
таблицы привилегий MySQL, содержащие те привилегии, которые
определяют, каким способом пользователям разрешено подключаться к
серверу. Обычно это делается с помощью скрипта <code>mysql_install_db</code>:


<pre>
shell&#62; scripts/mysql_install_db
</pre>

Как правило, <code>mysql_install_db</code> требует запуска только первый раз при
установке MySQL. Таким образом, если производится модернизация
существующей установки, то данный этап можно пропустить (однако скрипт
<code>mysql_install_db</code> совершенно безопасен для использования и не обновляет
никаких уже существующих таблицы; поэтому если у вас нет уверенности в
том, как поступать, то всегда можно запустить <code>mysql_install_db</code>). Скрипт
<code>mysql_install_db</code> создает шесть таблиц (<code>user</code>, <code>db</code>, <code>host</code>, <code>tables_priv</code>,
<code>columns_priv</code>, and <code>func</code>) в базе данных <code>mysql</code>. Описание исходных привилегий
дается в разделе See section <A HREF="manual.ru_MySQL_Database_Administration.html#Default_privileges">4.3.4  Задание изначальных привилегий MySQL</A>. Если в двух
словах, то эти привилегии позволяют пользователю root MySQL делать все,
что угодно, и любому пользователю позволяют создавать или использовать
базы данных с именем <code>test</code> или начинающимся с <code>test_</code>. Если таблицы
привилегий не установлены, то в системном журнале при запуске сервера
появится следующая ошибка:

<A NAME="IDX289"></A>

<pre>
mysqld: Can't find file: 'host.frm'
</pre>

Такая ошибка может появиться и в случае бинарного дистрибутива MySQL,
если вы не начали работу MySQL с точного выполнения команды 
<tt>`./bin/safe_mysqld'</tt>! See section <A HREF="manual.ru_MySQL_Database_Administration.html#safe_mysqld">4.7.2  <code>safe_mysqld</code>, оболочка <code>mysqld</code></A>.
Возможно, вам потребуется запускать <code>mysql_install_db</code> как <code>root</code>. Однако при
желании вы можете запускать сервер MySQL как непривилегированный (не-<code>root</code>)
пользователь, при условии, что этот пользователь может только читать файлы
из каталога базы данных и записывать в него файлы. Инструкции по запуску
MySQL в качестве непривилегированного пользователя даются в разделе See section <A HREF="manual.ru_Problems.html#Changing_MySQL_user">A.3.2  Запуск MySQL от обычного пользователя</A>. Если возникнут проблемы с 
<code>mysql_install_db</code>, обращайтесь к разделу See section <A HREF="manual.ru_Installing.html#mysql_install_db">2.4.1  Проблемы при запуске <code>mysql_install_db</code></A>. Дистрибутив MySQL обеспечивает несколько вариантов
запуска скрипта <code>mysql_install_db</code>:


<ul>
<LI>

Чтобы изменить исходные привилегии, которые устанавливаются в
таблицах привилегий, вам, возможно, потребуется отредактировать 
<code>mysql_install_db</code> перед запуском. Это полезно, если нужно установить
MySQL на нескольких машинах с одними и теми же привилегиями. В
таком случае вам, возможно, потребуется только добавить несколько
дополнительных команд <code>INSERT</code> к таблицам <code>mysql.user</code> и <code>mysql.db</code>!
<LI>

Если необходимо изменить записи в таблицах привилегий после их
установки, то можно запустить <code>mysql_install_db</code>, затем использовать
<code>mysql -u root mysql</code> для доступа к таблицам привилегий как
пользователь MySQL с привилегиями <code>root</code> и применять команды SQL для
модификации таблиц привилегий напрямую.
<LI>

Можно также создать таблицы привилегий полностью заново после того,
как они были уже созданы. Это можно сделать после установки таблиц,
а затем воссоздать после редактирования <code>mysql_install_db</code>.
</ul>

Более подробная информация о приведенных выше альтернативах находится в
разделе See section <A HREF="manual.ru_MySQL_Database_Administration.html#Default_privileges">4.3.4  Задание изначальных привилегий MySQL</A>.

<LI>

Запустите сервер MySQL как показано ниже:


<pre>
shell&#62; cd mysql_installation_directory
shell&#62; bin/safe_mysqld &#38;
</pre>

Если возникнут проблемы с запуском сервера, See section <A HREF="manual.ru_Installing.html#Starting_server">2.4.2  Проблемы при запуске сервера MySQL</A>.

<LI>

Используйте <code>mysqladmin</code> для проверки, что сервер работает. Простую
проверку того, что сервер функционирует и отвечает на подключения,
обеспечивают следующие команды:


<pre>
shell&#62; BINDIR/mysqladmin version
shell&#62; BINDIR/mysqladmin variables
</pre>

Вывод из <code>mysqladmin version</code> будет иметь небольшие различия в зависимости
от используемой платформы и версии MySQL, но должен быть похож на
приведенный ниже:


<pre>
shell&#62; BINDIR/mysqladmin version
mysqladmin  Ver 8.14 Distrib 3.23.32, for linux on i586
Copyright (C) 2000 MySQL AB &#38; MySQL Finland AB &#38; TCX DataKonsult AB
This software comes with ABSOLUTELY NO WARRANTY. This is free software,
and you are welcome to modify and redistribute it under the GPL license.

Server version          3.23.32-debug
Protocol version        10
Connection              Localhost via Unix socket
TCP port                3306
UNIX socket             /tmp/mysql.sock
Uptime:                 16 sec

Threads: 1  Questions: 9  Slow queries: 0
Opens: 7  Flush tables: 2  Open tables: 0
Queries per second avg: 0.000
Memory in use: 132K  Max memory used: 16773K
</pre>

Чтобы получить представление о том, что еще можно делать с помощью
<code>BINDIR/mysqladmin</code>, запустите эту команду с опцией <code>--help</code>.

<LI>

Убедитесь, что можете остановить сервер:
<A NAME="IDX290"></A>


<pre>
shell&#62; BINDIR/mysqladmin -u root shutdown
</pre>

<LI>

Убедитесь, что можете перезапустить сервер. Делайте это, используя
<code>safe_mysqld</code> или путем прямого вызова <code>mysqld</code>. Например:

<A NAME="IDX291"></A>
<A NAME="IDX292"></A>
<A NAME="IDX293"></A>


<pre>
shell&#62; BINDIR/safe_mysqld --log &#38;
</pre>

Если <code>safe_mysqld</code> терпит неудачу, попытайтесь запустить команду из каталога
установки MySQL (если вы уже не там). Если команда по-прежнему не
работает, см. раздел See section <A HREF="manual.ru_Installing.html#Starting_server">2.4.2  Проблемы при запуске сервера MySQL</A>.

<LI>

Запустите несколько простых тестов, чтобы  убедиться, что  сервер 
работает. Вывод  должен  быть  похож  на  приведенный  ниже:


<pre>
shell&#62; BINDIR/mysqlshow
+-----------+
| Databases |
+-----------+
| mysql     |
+-----------+

shell&#62; BINDIR/mysqlshow mysql
Database: mysql
+--------------+
|    Tables    |
+--------------+
| columns_priv |
| db           |
| func         |
| host         |
| tables_priv  |
| user         |
+--------------+

shell&#62; BINDIR/mysql -e "SELECT host,db,user FROM db" mysql
+------+--------+------+
| host | db     | user |
+------+--------+------+
| %    | test   |      |
| %    | test_% |      |
+------+--------+------+
</pre>

В подкаталоге <tt>`sql-bench'</tt> каталога установки MySQL находится набор тестов
производительности, который можно использовать для сравнения работы MySQL
на различных платформах. Каталог <tt>`sql-bench/Results'</tt> содержит результаты
большого количества запусков для различных баз данных и платформ. Чтобы
запустить все тесты, выполните следующие команды:


<pre>
shell&#62; cd sql-bench
shell&#62; run-all-tests
</pre>

Если у вас отсутствует каталог <tt>`sql-bench'</tt>, то, вероятно, вы работаете с
пакетом RPM для бинарного дистрибутива (в пакеты RPM с дистрибутивами
исходного кода включается каталог тестов производительности). В этом
случае прежде чем использовать набор тестов производительности, необходимо
его установить. Начиная с версии MySQL 3.22, существуют RPM-файлы тестов
производительности, <tt>`mysql-bench-VERSION-i386.rpm'</tt>, которые содержат код
тестов производительности и данные. Имея дистрибутив исходного кода, можно
также запустить эти тесты в подкаталоге <tt>`tests'</tt>. Например, чтобы запустить
<tt>`auto_increment.tst'</tt>, сделайте следующее:


<pre>
shell&#62; BINDIR/mysql -vvf test &#60; ./tests/auto_increment.tst
</pre>

Результаты будут выводиться в файл <tt>`./tests/auto_increment.res'</tt>.
</ol>



<H3><A NAME="mysql_install_db" HREF="manual.ru_toc.html#mysql_install_db">2.4.1  Проблемы при запуске <code>mysql_install_db</code></A></H3>

<P>
<A NAME="IDX294"></A>
<A NAME="IDX295"></A>

</P>
<P>
Скрипт <code>mysql_install_db</code> предназначен только для создания новых таблиц
привилегий MySQL. Он не влияет ни на какие другие данные! А если таблицы
привилегий MySQL уже установлены, этот скрипт ничего не будет делать!

</P>
<P>
Для того чтобы создать таблицы привилегий заново, необходимо остановить
сервер <code>mysqld</code>, если он работает, и затем выполнить что-нибудь вроде:

</P>

<pre>
mv mysql-data-directory/mysql mysql-data-directory/mysql-old
mysql_install_db
</pre>

<P>
В этом разделе перечислены проблемы, с которыми можно столкнуться при
запуске <code>mysql_install_db</code>:

</P>
<DL COMPACT>

<DT><strong><code>mysql_install_db</code> не устанавливает таблицы привилегий</strong>
<DD>
Может оказаться, что <code>mysql_install_db</code> не в состоянии установить таблицы
привилегий и заканчивает свою работу после вывода следующих сообщений:


<pre>
starting mysqld daemon with databases from XXXXXX
mysql daemon ended
</pre>

В таком случае необходимо очень тщательно изучить системный журнал! Этот
журнал должен находиться в каталоге <tt>`XXXXXX'</tt>, указанном в данном сообщении
об ошибке. В нем содержится информация о том, почему не запустился <code>mysqld</code>.
Если вам не удалось разобраться в том, что произошло, при посылке отчета
об ошибке включите в него данный журнал, используя <code>mysqlbug</code>! См.раздел 
See section <A HREF="manual.ru_Introduction.html#Bug_reports">1.8.1.3  Как отправлять отчеты об ошибках или проблемах</A>.

<DT><strong>Уже существует работающий демон <code>mysqld</code></strong>
<DD>
В таком случае вам вообще не следует запускать <code>mysql_install_db</code>. Скрипт
<code>mysql_install_db</code> должен запускаться только однажды при установке MySQL
первый раз.

<DT><strong>При работающем демоне <code>mysqld</code> установка второго демона не работает</strong>
<DD>
Это может случиться, когда уже существует установленный сервер MySQL, но
вы хотите произвести новую инсталляцию в другом месте (например, для
тестирования или, возможно, вам просто требуется запустить две инсталляции
в одно и то же время). Вообще говоря, такая проблема, которая возникает
при попытке запустить второй сервер, заключается в том, что второй сервер
пытается использовать тот же сокет и порт, что и старый. В этом случае 
вы можете получить следующее сообщение об ошибке: <code>Can't start
server: Bind on TCP/IP port: Address already in use</code> или <code>Can't start server:
Bind on unix socket...</code>. See section <A HREF="manual.ru_MySQL_Database_Administration.html#Installing_many_servers">4.1.3  Установка нескольких серверов на один компьютер</A>.

<DT><strong>Нет доступа для записи в <tt>`/tmp'</tt></strong>
<DD>
<A NAME="IDX296"></A>
<A NAME="IDX297"></A>
<A NAME="IDX298"></A>

Если у вас нет доступа для создания файла сокета в принятом по умолчанию
месте (в <tt>`/tmp'</tt>) или разрешения создавать временные файлы в каталоге
<tt>`/tmp'</tt>, то вы получите ошибку при запуске <code>mysql_install_db</code> или при
запуске или использовании <code>mysqld</code>. Необходимо указать другой каталог для
сокета и временных файлов следующим образом:

<A NAME="IDX299"></A>
<A NAME="IDX300"></A>
<A NAME="IDX301"></A>
<A NAME="IDX302"></A>


<pre>
shell&#62; TMPDIR=/some_tmp_dir/
shell&#62; MYSQL_UNIX_PORT=/some_tmp_dir/mysqld.sock
shell&#62; export TMPDIR MYSQL_UNIX_PORT
</pre>

See section <A HREF="manual.ru_Problems.html#Problems_with_mysql.sock">A.4.5  Как защитить или изменить сокет-файл MySQL <tt>`/tmp/mysql.sock'</tt></A>. Путь <tt>`some_tmp_dir'</tt> должен указывать на некоторый
каталог, для которого у вас есть доступ для записи. 
See section <A HREF="manual.ru_Environment_variables.html#Environment_variables">F  Переменные окружения</A>. После этого у вас должна появиться возможность
запустить <code>mysql_install_db</code> и начать работу сервера с помощью следующих
команд:


<pre>
shell&#62; scripts/mysql_install_db
shell&#62; BINDIR/safe_mysqld &#38;
</pre>

<DT><strong>Немедленный аварийный отказ <code>mysqld</code></strong>
<DD>
Если вы работаете на версии RedHat 5.0 с версией <code>glibc</code> более старой, чем
2.0.7-5, следует позаботиться о том, чтобы установить все патчи для <code>glibc</code>!
В архивах рассылки MySQL имеется большое количество писем об этом. Ссылки
на архивы писем доступны в онлайновом режиме на <a HREF="http://lists.mysql.com/">http://lists.mysql.com/</a>.
Обращайтесь также к разделу See section <A HREF="manual.ru_Installing.html#Linux">2.6.1  Примечания к Linux (Все версии Linux)</A>. Можно
также запустить <code>mysqld</code> вручную, используя опцию <code>--skip-grant-tables</code>, и
самостоятельно добавить информацию о привилегиях, при помощи <code>mysql</code>:


<pre>
shell&#62; BINDIR/safe_mysqld --skip-grant-tables &#38;
shell&#62; BINDIR/mysql -u root mysql
</pre>

Из <code>mysql</code> в ручном режиме выполните команды SQL в <code>mysql_install_db</code>.
Удостоверьтесь, что после этого вы запустили <code>mysqladmin flush-privileges</code> 
или <code>mysqladmin reload</code>, чтобы сервер перегрузил таблицы привилегий.
</DL>



<H3><A NAME="Starting_server" HREF="manual.ru_toc.html#Starting_server">2.4.2  Проблемы при запуске сервера MySQL</A></H3>

<P>
<A NAME="IDX303"></A>
<A NAME="IDX304"></A>

</P>
<P>
Если вы собираетесь использовать таблицы, поддерживающие транзакции
(InnoDB, BDB), следует прежде всего создать файл <tt>`my.cnf'</tt> и установить опции
запуска для тех типов таблиц, с которыми планируется работать. 
See section <A HREF="manual.ru_Table_types.html#Table_types">7  Типы  таблиц MySQL</A>.

</P>
<P>
В общем случае сервер <code>mysqld</code> запускается одним из следующих способов:

</P>

<ul>
<LI>

Вызовом <code>mysql.server</code>. Этот скрипт используется преимущественно для
запуска и останова системы. Более подробно он описан в разделе 
See section <A HREF="manual.ru_Installing.html#Automatic_start">2.4.3  Автоматический запуск и остановка MySQL</A>.

<LI>

Вызовом команды <code>safe_mysqld</code>, которая определяет соответствующие опции
для <code>mysqld</code> и затем запускает <code>mysqld</code> с этими опциями. 
See section <A HREF="manual.ru_MySQL_Database_Administration.html#safe_mysqld">4.7.2  <code>safe_mysqld</code>, оболочка <code>mysqld</code></A>.

<LI>

Относительно Windows NT/2000/XP просьба  обращаться  к  разделу 
See section <A HREF="manual.ru_Installing.html#NT_start">2.6.2.2  Запуск MySQL на Windows NT, 2000 или XP</A>.

<LI>

Вызовом <code>mysqld</code> напрямую.
</ul>

<P>
При своем запуске демон <code>mysqld</code> изменяет свой каталог на каталог данных
(<code>datadir</code>). В нем он ожидает найти журнальные файлы, файлы pid (ID
процессов) и собственно базы данных.

</P>
<P>
Местоположение каталога данных жестко устанавливается при компиляции
дистрибутива. Однако если <code>mysqld</code> ожидает найти каталог данных где-либо в
другом месте, а не там, где он действительно расположен в вашей системе,
то демон <code>mysqld</code> не будет работать правильно. Если есть проблемы с
неправильными путями, то, вызывая <code>mysqld</code> с опцией <code>--help</code>, вы можете найти
информацию о том, что разрешают опции <code>mysqld</code> и какие установки путей
приняты по умолчанию. Можно переопределить установки по умолчанию
указанием правильных имен путей как аргументов <code>mysqld</code> в командной строке
(эти опции также можно использовать с <code>safe_mysqld</code>).

</P>
<P>
Обычно требуется указывать <code>mysqld</code> только каталог, в котором
устанавливается MySQL. Это можно сделать с помощью опции <code>--basedir</code>. Можно
также использовать <code>--help</code> для проверки эффекта от изменения опций путей
(учтите, что <code>--help</code> должна быть последней опцией в команде <code>mysqld</code>).
Например:

</P>

<pre>
shell&#62; EXECDIR/mysqld --basedir=/usr/local --help
</pre>

<P>
После определения требуемых установок путей запускайте сервер без опции
<code>--help</code>.

</P>
<P>
Какой бы метод вы ни использовали для запуска сервера, если его неудачный
запуск завершается корректно, то проверьте журнальный файл, чтобы узнать,
почему запуск происходит неудачно. Журнальные файлы находятся в каталоге
данных (обычно <tt>`/usr/local/mysql/data'</tt> для бинарного дистрибутива,
<tt>`/usr/local/var'</tt> для дистрибутива исходного кода и <tt>`\mysql\data\mysql.err'</tt>
под Windows). В каталоге данных следует искать файлы с именами в виде
<tt>`host_name.err'</tt> и <tt>`host_name.log'</tt>, где <code>host_name</code> - имя вашего серверного
хоста. Затем проверьте последние несколько строк этих файлов:

</P>

<pre>
shell&#62; tail host_name.err
shell&#62; tail host_name.log
</pre>

<P>
В журнальном файле нужно искать что-нибудь похожее на следующее:

</P>

<pre>
000729 14:50:10 bdb: Recovery function for LSN 1 27595 failed
000729 14:50:10 bdb: warning: ./test/t1.db: No such file or directory
000729 14:50:10 Can't init databases
</pre>

<P>
Это означает, что вы не запустили <code>mysqld</code> с <code>--bdb-no-recover</code> и база данных
Berkeley DB нашла что-то ошибочное в своих журнальных файлах при попытке
восстановить ваши базы данных. Чтобы иметь возможность продолжить,
необходимо переместить старый журнальный файл Berkeley DB из каталога баз
данных в некоторое другое место, где позже можно будет изучить его.
Журнальные файлы имеют имена <tt>`log.0000000001'</tt> и т.д.; номер возрастает
при каждом запуске.

</P>
<P>
Если вы запускаете <code>mysqld</code> работает с поддержкой таблиц BDB и <code>mysqld</code> при
старте выводит дамп оперативной памяти (coredump), то причиной этого это
могут быть какие-либо проблемы с журналом восстановления BDB. В этом
случае можно попробовать запуск mysqld с <code>--bdb-no-recover</code>. Если это
помогает, то следует удалить все файлы <tt>`log.*'</tt> из каталога данных и
попробовать запустить <code>mysqld</code> опять.

</P>
<P>
Если выдается приведенная ниже ошибка, то это означает, что некоторая
другая программа (или другой сервер <code>mysqld</code>) уже использует данный TCP/IP
порт или сокет, на которых <code>mysqld</code> пытается слушать:

</P>

<pre>
Can't start server: Bind on TCP/IP port: Address already in use
или
Can't start server : Bind on unix socket...
</pre>

<P>
Чтобы убедиться, что другого работающего сервера <code>mysqld</code> нет, используйте
<code>ps</code>. Если другой работающий сервер не найден, то можно попробовать
выполнить команду <code>telnet your-host-name tcp-ip-port-number</code> и нажать пару
раз клавишу ``Enter''. Если вы не получаете сообщения об ошибке вроде
следующего <code>telnet: Unable to connect to remote host: Connection refused</code>,
значит, что порт TCP/IP порт, который <code>mysqld</code> пытается использовать, уже
занят другой программой. section <A HREF="manual.ru_Installing.html#mysql_install_db">2.4.1  Проблемы при запуске <code>mysql_install_db</code></A> и 
раздел See section <A HREF="manual.ru_MySQL_Database_Administration.html#Multiple_servers">4.1.4  Запуск нескольких серверов MySQL на одном компьютере</A>.

</P>
<P>
Если <code>mysqld</code> в настоящее время работает, то можно найти используемые им
установки путей при помощи следующей команды:

</P>

<pre>
shell&#62; mysqladmin variables
или
shell&#62; mysqladmin -h 'your-host-name' variables
</pre>

<P>
Если при запуске <code>mysqld</code> вы получили ошибку <code>Errcode 13</code>, что значит
<code>Permission denied</code>, это означает, что у вас не было прав читать/создавать
файлы в базе данных MySQL или в журнальном каталоге. В таком случае вам
следует либо запускать <code>mysqld</code> как пользователь <code>root</code>, либо изменить права
доступа к упомянутым файлам и каталогам, чтобы иметь права использовать
их.

</P>
<P>
Если <code>safe_mysqld</code> запускает сервер, но вы не можете подключиться к нему, то
следует убедиться, что в <tt>`/etc/hosts'</tt> есть запись, которая выглядит
примерно так:

</P>

<pre>
127.0.0.1 localhost
</pre>

<P>
Эта проблема возникает только в системах, не имеющих рабочей библиотеки
потоков, и для которых MySQL следует конфигурировать для использования
потоков MIT-pthreads.

</P>
<P>
Если вы не можете запустить <code>mysqld</code>, то можно попробовать создать
трассировочный файл, чтобы обнаружить данную проблему. 
See section <A HREF="manual.ru_Porting.html#Making_trace_files">E.1.2  Создание трассировочных файлов</A>.

</P>
<P>
При использовании таблиц InnoDB следует указывать опции запуска,
специфические для InnoDB. See section <A HREF="manual.ru_Table_types.html#InnoDB_start">7.5.2  Параметры запуска InnoDB</A>.

</P>
<P>
При использовании таблиц BDB (Berkeley DB) необходимо хорошо знать
различные специфические для BDB опции запуска. See section <A HREF="manual.ru_Table_types.html#BDB_start">7.6.3  Параметры запуска <code>BDB</code></A>.

</P>


<H3><A NAME="Automatic_start" HREF="manual.ru_toc.html#Automatic_start">2.4.3  Автоматический запуск и остановка MySQL</A></H3>

<P>
<A NAME="IDX305"></A>
<A NAME="IDX306"></A>
<A NAME="IDX307"></A>
<A NAME="IDX308"></A>
<A NAME="IDX309"></A>

</P>
<P>
Скрипты <code>mysql.server</code> и <code>safe_mysqld</code> могут применяться для автоматического
запуска сервера во время загрузки операционной системы. Скрипт
<code>mysql.server</code> можно также использовать для остановки сервера.

</P>
<P>
Чтобы применять скрипт <code>mysql.server</code> для запуска или остановки сервера, его
следует вызывать с аргументами <code>start</code> или <code>stop</code> соответственно:

</P>

<pre>
shell&#62; mysql.server start
shell&#62; mysql.server stop
</pre>

<P>
<code>mysql.server</code> можно найти в подкаталоге <tt>`share/mysql'</tt> 
инсталляционного каталога MySQL или в каталоге <tt>`support-files'</tt> набора
исходных кодов MySQL.

</P>
<P>
Перед тем как скрипт <code>mysql.server</code> запустит сервер, он изменяет данный
каталог на инсталляционный каталог MySQL, затем вызывает <code>safe_mysqld</code>.
Возможно, понадобится отредактировать скрипт <code>mysql.server</code>, если бинарный
дистрибутив установлен вами не в стандартном месте. Модифицируйте его,
указав <code>cd</code> в соответствующий каталог перед тем, как он запустит
<code>safe_mysqld</code>. Если вы хотите запустить сервер от определенного
пользователя, то добавьте соответствующую строку <code>user</code> к файлу
<tt>`/etc/my.cnf'</tt> как показано далее в этом разделе.

</P>
<P>
<code>mysql.server stop</code> останавливает сервер путем посылки ему сигнала.
Можно остановить сервер вручную - при помощи команды <code>mysqladmin shutdown</code>.

</P>
<P>
Вам следует добавить эти команды запуска и остановки в соответствующее место в 
файлах <tt>`/etc/rc*'</tt>, если вы хотите автоматически запускать MySQL на вашем сервере. 

</P>
<P>
На современных поставках Linux, достаточно скопировать файл <code>mysql.server</code>
в каталог <tt>`/etc/init.d'</tt> (или <tt>`/etc/rc.d/init.d'</tt> на более старших
системах Red Hat). После этого, выполните такую команду, чтобы включить
автоматический запуск MySQL при загрузке системы: 

</P>

<pre>
shell&#62; chkconfig --add mysql.server
</pre>

<P>
В качестве альтернативы, в некоторых ОС также используются <tt>`/etc/rc.local'</tt> или <tt>`/etc/init.d/boot.local'</tt> для 
запуска дополнительных сервисов при загрузке. Для того, чтобы MySQL стартовал с использованием этого метода, 
вы можете добавить нечто вроде этого к указанным файлам: 

</P>

<pre>
/bin/sh -c 'cd /usr/local/mysql ; ./bin/safe_mysqld --user=mysql &#38;'
</pre>

<P>
<A NAME="IDX310"></A>

</P>
<P>
Можно также добавить опции для скрипта <code>mysql.server</code> в глобальный  файл 
<tt>`/etc/my.cnf'</tt>. Типовой файл <tt>`/etc/my.cnf'</tt> может выглядеть следующим
образом:

</P>

<pre>
[mysqld]
datadir=/usr/local/mysql/var
socket=/var/tmp/mysql.sock
port=3306
user=mysql

[mysql_server]
basedir=/usr/local/mysql
</pre>

<P>
Скрипт <code>mysql.server</code> понимает следующие опции: <code>datadir</code>, <code>basedir</code> и 
<code>pid-file</code>.

</P>
<P>
В таблице представлены группы опций, которые каждый из 
перечисленных запускающих скриптов читает из файлов опций:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><strong>Скрипт</strong> </TD><TD> <strong>Группы опций</strong>
</TD></TR>
<TR><TD><code>mysqld</code> </TD><TD> <code>mysqld</code> и <code>server</code>
</TD></TR>
<TR><TD><code>mysql.server</code> </TD><TD> <code>mysql.server</code>, <code>mysqld</code>, и <code>server</code>
</TD></TR>
<TR><TD><code>safe_mysqld</code> </TD><TD> <code>mysql.server</code>, <code>mysqld</code>, и <code>server</code>
</TD></TR>
</TABLE>

<P>
See section <A HREF="manual.ru_MySQL_Database_Administration.html#Option_files">4.1.2  Файлы параметров <tt>`my.cnf'</tt></A>.

</P>


<H2><A NAME="Upgrade" HREF="manual.ru_toc.html#Upgrade">2.5  Апгрейд/даунгрейд MySQL</A></H2>

<P>
<A NAME="IDX311"></A>
<A NAME="IDX312"></A>

</P>
<P>
Файлы MySQL, содержащие структуру и данные, всегда можно перемещать между
различными версиями одной и той же архитектуры, если используется одна и
та же базовая версия MySQL. В настоящее время базовой является версия с
номером 3. При изменении кодировки во время работы MySQL (при этом также
может измениться порядок сортировки) необходимо запустить <code>myisamchk -r -q --set-character-set=charset</code> 
на всех таблицах. В противном случае индексы могут сортироваться
неправильно.

</P>
<P>
В случае недоверия к новым версиям всегда можно переименовать старую
версию <code>mysqld</code>, изменив ее имя на что-нибудь вроде
<code>mysqld-old-version-number</code>. Если после этого <code>mysqld</code> новой версии начнет
вести себя не так, как ожидалось, то можно просто прекратить работу новой
версии и перезапустить старую!

</P>
<P>
И, разумеется, при модернизации следует также сделать резервную копию
старых баз данных.

</P>
<P>
После модернизации у вас могут возникнуть проблемы с перекомпилированными
клиентскими программами, такими как <code>Commands out of sync</code>, или произойти
неожиданная смерть приложения (coredump). Причина может быть в том, что
при компиляции программ были использованы старые заголовочные или
библиотечные файлы. В этом случае следует проверить даты создания вашего
файла <tt>`mysql.h'</tt> и библиотеки <tt>`libmysqlclient.a'</tt>, чтобы убедиться, что они
из нового дистрибутива MySQL. Если это не так, то программы нужно
перекомпилировать!

</P>
<P>
Если возникнут проблемы с запуском нового сервера <code>mysqld</code> или трудности с
подключением без пароля, то нужно убедиться, что вы не используете старый
файл <tt>`my.cnf'</tt> из старой установки! Это можно проверить с помощью
<code>program-name --print-defaults</code>. Если эта программа вместо имени программы
выводит что-нибудь иное, то ваш файл <tt>`my.cnf'</tt> является активным и
оказывает влияние на ход событий!

</P>
<P>
Каждый раз при установке нового релиза MySQL есть смысл создавать наново и
переустанавливать дистрибутив <code>Msql-Mysql-modules</code>, особенно если вы
замечаете симптомы того, что ваши скрипты <code>DBI</code> умирают после модернизации
MySQL.

</P>

<P>
<A NAME="IDX313"></A>
<A NAME="IDX314"></A>


<H3><A NAME="Upgrading-from-4.0" HREF="manual.ru_toc.html#Upgrading-from-4.0">2.5.1  Модернизация с версии 4.0</A></H3>

<P>
В общем случае, чтобы выполнить апгрейд до версии 4.1 с более ранней: 

</P>

<ul>
<LI>

Выполните скрипт <code>mysql_fix_privilege_tables</code> 
для создания новых столбцов с паролями. Это нужно для более безопасной работы
с паролями. 
</ul>

<P>
Далее идет более подробный список вещей, на которые следует обратить внимание
при апгрейде на 4.1:

</P>

<ul>
<LI>

Функции, что возвращают DATE, DATETIME или TIME теперь фиксируются при отдаче клиенту. 


<pre>
mysql&#62; SELECT cast("2001-1-1" as DATE)
    -&#62; '2001-01-01'
</pre>

<LI>

Все столбцы и таблицы теперь имеют кодировку, которая показывается в выводе
<code>SHOW CREATE TABLE</code> и <code>mysqldump</code>.
(MySQL 4.0.6 и выше могут читать новые dump-файлы, но не прежние версии MySQL).
<LI>

Временная метка (timestamp) теперь возвращается как строка вида <code>'YYYY-MM-DD HH:MM:DD'</code>.
Если вы хотите получить ее как число - вам следует добавить <code>+0</code> к столбцу <code>timestamp</code>.
Различные длины временных меток теперь не поддерживаются. 
<LI>

Если вы используете несколько серверов на одном и том же компьютере под управлением
Windows, вам следует использовать различные опции 
<code>--shared_memory_base_name</code>.
</ul>

<P>
<strong>Обратите внимание</strong> что формат определения таблиц (.frm) поменялся в 4.1. MySQL 4.0.11 может 
читать новый файл формата, но более старые версии не могут. Если вам нужно перемещать таблицы с 4.1 
на более старшие версии MySQL, вам следует использовать <code>mysqldump</code>. See section <A HREF="manual.ru_MySQL_Database_Administration.html#mysqldump">4.8.5  <code>mysqldump</code>, Получение дампов данных и структуры таблицы</A>. 

</P>

<P>
<A NAME="IDX315"></A>

</P>


<H3><A NAME="Upgrading-from-3.23" HREF="manual.ru_toc.html#Upgrading-from-3.23">2.5.2  Модернизация с версии 3.23 до версии 4.0</A></H3>

<P>
В общем случае, вот что вам следует сделать для апгрейда к версии 4.0 с более старой: 

</P>

<ul>
<LI>

Выполнить скрипт <code>mysql_fix_privilege_tables</code>  чтобы добавить новые
привилегии и возможности в таблицы привилегий MySQL.
<LI>

Подредактировать скрипты запуска MySQL или конфигурационные файлы, чтобы не использовать 
устаревшие опции, описанные ниже. 
<LI>

Преобразовать ваши старые ISAM-файлы в формат MyISAM следующей командой: 
<code>mysql_convert_table_format база данных</code>.
Обратите внимание, это нужно делать только если все таблицы в базе данных
являются таблицами типа ISAM или MyISAM. Если это не тот случай, вам тогда
следует выполнить <code>ALTER TABLE имя_таблицы TYPE=MyISAM</code> для всех
ISAM-таблиц. 

<LI>

Удостоверьтесь, что у вас не используется никакие клиенты MySQL, что используют
динамические библиотеки (например, Perl Msql-Mysql-modules). Если у вас есть
такие, их следует перекомпилировать, т.к. структуры в <tt>`libmysqlclient.so'</tt>
изменились. 
</ul>

<P>
MySQL 4.0 будет работать, даже если вы не выполните эти шагы, но у вас 
не будет возможности использовать новые привилегии, которые предоставляет MySQL 4.0, 
и у вас могут быть проблемы при дальнейшем апгрейде к 4.1 или более новым серверам. 
Формат ISAM в MySQL 4.0 все еще работает, но он уже морально устарел и будет исключен
из версии MySQL 5.0.

</P>
<P>
Старые клиенты должны работать с версией 4.0 без каких-либо проблем. 

</P>
<P>
И даже если вы выполните эти шаги, вы сможете произвести даунгрейд к
MySQL 3.23.52 или более новой, если у вас возникнут проблемы с MySQL 4.0. В этом
случае вам потребуется выполнить mysqldump на всех таблицах, использующих полнотекстовые
индексы и восстановить dump на версии 3.23. Причина заключается в том, что MySQL 4.0 
использует новый формат полнотекстовых индексов. 

</P>
<P>
Вот подробный список того, на что следует обратить внимание при апгрейде к 4.0:

</P>

<ul>
<LI>

В MySQL 4.0 появилось большое количество новых привилегий в таблице
<code>mysql.user</code>. See section <A HREF="manual.ru_MySQL_Database_Administration.html#GRANT">4.3.1  Синтаксис команд <code>GRANT</code> и <code>REVOKE</code></A>. 

Чтобы заставить эти
новые привилегии работать, следует запустить скрипт
<code>mysql_fix_privilege_tables</code>. До выполнения данного скрипта у всех
пользователей будут привилегии <code>SHOW DATABASES</code>, <code>CREATE TEMPORARY TABLES</code>
и <code>LOCK TABLES</code>. Значения для привилегий <code>SUPER</code> и <code>EXECUTE</code> берутся
из <code>PROCESS</code>, для <code>REPLICATION SLAVE</code> и <code>REPLICATION CLIENT</code> - из <code>FILE</code>.

Чтобы скрипты, создающие новых пользователей, могли использовать новые
привилегии, их нужно модифицировать. Если в этих скриптах не
используется команда <code>GRANT</code>, то сейчас самое время изменить их. 

В версии
4.0.2 опция <code>--safe-show-database</code> устарела и не рекомендуется (и она
больше ничего не делает). See section <A HREF="manual.ru_MySQL_Database_Administration.html#Privileges_options">4.2.3  Опции запуска <code>mysqld</code>, относящиеся к безопасности</A>. 

Если в версии 4.0.2 для новых пользователей
возникают ошибки отказа в доступе, то следует проверить, не требуются
ли вам некоторые новые привилегии, которые не были нужны раньше. В
частности, для новых репликаций понадобится <code>REPLICATION SLAVE</code> (вместо
<code>FILE</code>).

<LI>

Параметры запуска <code>myisam_max_extra_sort_file_size</code> и
<code>myisam_max_extra_sort_file_size</code> теперь указываются в байтах (до 4.0.3
указывались в мегабайтах).

Внешняя блокировка файлов MyISAM/ISAM теперь выключена по умолчанию. Можно
включить ее обратно опцией <code>--external-locking</code>.  Для большинства
пользователей этого никогда не потребуется делать. 

<LI>

Следующие переменные/опции были переименованы: 
<TABLE BORDER WIDTH="100%">
<TR><TD><strong>Из</strong> </TD><TD> <strong>В</strong>.
</TD></TR>
<TR><TD><code>myisam_bulk_insert_tree_size</code> </TD><TD> <code>bulk_insert_buffer_size</code>
</TD></TR>
<TR><TD><code>query_cache_startup_type</code> </TD><TD> <code>query_cache_type</code>
</TD></TR>
<TR><TD><code>record_buffer</code> </TD><TD> <code>read_buffer_size</code>
</TD></TR>
<TR><TD><code>record_rnd_buffer</code> </TD><TD> <code>read_rnd_buffer_size</code>
</TD></TR>
<TR><TD><code>sort_buffer</code> </TD><TD> <code>sort_buffer_size</code>
</TD></TR>
<TR><TD><code>warnings</code> </TD><TD> <code>log-warnings</code>
</TD></TR>
<TR><TD><code>err-log</code> </TD><TD> <code>--log-error</code> (для <code>mysqld_safe</code>)
</TD></TR>
</TABLE>

Опции запуска <code>record_buffer</code>, <code>sort_buffer</code> и <code>warnings</code> все
еще работают в MySQL 4.0, но считаются уже морально устаревшими. 

<LI>

Следующие SQL-переменные переименованы.
<TABLE BORDER WIDTH="100%">
<TR><TD><strong>Из</strong> </TD><TD> <strong>В</strong>.
</TD></TR>
<TR><TD><code>SQL_BIG_TABLES</code> </TD><TD> <code>BIG_TABLES</code>
</TD></TR>
<TR><TD><code>SQL_LOW_PRIORITY_UPDATES</code> </TD><TD> <code>LOW_PRIORITY_UPDATES</code>
</TD></TR>
<TR><TD><code>SQL_MAX_JOIN_SIZE</code> </TD><TD> <code>MAX_JOIN_SIZE</code>
</TD></TR>
<TR><TD><code>QUERY_CACHE_TYPE</code> </TD><TD> <code>QUERY_CACHE_TYPE</code>
</TD></TR>
</TABLE>
Старые имена в MySQL 4.0 работают, но уже не рекомендованы к использованию.
<LI>

Вы должны использовать <code>SET GLOBAL SQL_SLAVE_SKIP_COUNTER=#</code> вместо 
<code>SET SQL_SLAVE_SKIP_COUNTER=#</code>.
<LI>

Переименовали опцию запуска <code>mysqld</code> <code>--skip-locking</code> в
<code>--skip-external-locking</code> и <code>--enable-locking</code> в
<code>--external-locking</code>.
<LI>

<code>SHOW MASTER STATUS</code> теперь возвращает пустой результат если двоичный журнал обновлений
не включен. 
<LI>

<code>SHOW SLAVE STATUS</code> возвращает пустой результат если подчиненный сервер не инициализирован. 
<LI>

mysqld теперь обладает опцией <code>--temp-pool</code> включенной по умолчанию, т.к. это 
дает лучшую производительность на некоторых ОС (в основном, на Linux). 
<LI>

Столбцы <code>DOUBLE</code> и <code>FLOAT</code> теперь учитывают флаг
<code>UNSIGNED</code> при хранении (раньше <code>UNSIGNED</code> игнорировался для этих столбцов).
<LI>

<code>ORDER BY столбец DESC</code> теперь сортирует величины <code>NULL</code> 
в первую очередь; в 3.23 это было не всегда так. Внимание: в MySQL 4.0.11 восстановлено
оригинальное поведение. 
<LI>

<code>SHOW INDEX</code> имеет на 2 столбца больше (<code>Null</code> и <code>Index_type</code>), чем в версии
3.23.
<LI>

<code>CHECK</code>, <code>SIGNED</code>, <code>LOCALTIME</code> и <code>LOCALTIMESTAMP</code>
теперь являются зарезервированными словами.
<LI>

Результат работы всех поразрядных операторов <code>|</code>, <code>&#38;</code>, <code>&#60;&#60;</code>, <code>&#62;&#62;</code> и <code>~</code> сейчас
является беззнаковым. Это может вызвать проблемы при использовании их
в контексте, где желателен результат со знаком. See section <A HREF="manual.ru_Reference.html#Cast_Functions">6.3.5  Функции приведения типов</A>.

<LI>

<strong>Замечание</strong>: результат операции вычитания между целыми величинами, одна
из которых имеет тип <code>UNSIGNED</code>, будет беззнаковым! Другими словами,
перед модернизацией до MySQL 4.0 вы должны проверить свои приложения
для случаев, где производится вычитание величины из беззнакового
объекта и предполагается ответ с отрицательным знаком, или вычитание
беззнаковой величины из целочисленного столбца. Данный режим можно
заблокировать, используя опцию <code>--sql-mode=NO_UNSIGNED_SUBTRACTION</code> при
запуске <code>mysqld</code>. See section <A HREF="manual.ru_Reference.html#Cast_Functions">6.3.5  Функции приведения типов</A>.

<LI>

Для того чтобы использовать <code>MATCH ... AGAINST (... IN BOOLEAN MODE)</code> на
таблицах, следует перестроить их заново при помощи <code>REPAIR TABLE table_name USE_FRM</code>.

<LI>

<code>LOCATE()</code> и <code>INSTR()</code> чувствительны к регистру, если один из аргументов
является двоичной строкой. В противном случае они не зависят от
регистра.
<LI>

<code>STRCMP()</code> при выполнении сравнений сейчас использует текущий набор
символов; это означает, что операция сравнения по умолчанию начиная с
данной версии является независимой от регистра.

<LI>

<code>HEX(string)</code> сейчас возвращает символы строки, преобразованные в
шестнадцатеричные. Если необходимо преобразовать число в
шестнадцатеричное представление, убедитесь, что <code>HEX()</code> вызывается с
числовым аргументом.

<LI>

В версии 3.23 в команде <code>INSERT INTO ... SELECT</code> параметр <code>IGNORE</code> всегда
был разрешен. В версии 4.0.1 MySQL остановится (и, возможно,
произойдет откат) в случае ошибки, если <code>IGNORE</code> не задан явно.

<LI>

Скрипт <code>safe_mysqld</code> переименован в <code>mysqld_safe</code>. Некоторое время
мы будем включать <code>safe_mysqld</code> в дистрибутив как символическую ссылку на <code>mysqld_safe</code>. 

<LI>

Старые функции C API <code>mysql_drop_db</code>, <code>mysql_create_db</code> и <code>mysql_connect</code>
больше не будут поддерживаться, если вы не скомпилируете MySQL с
<code>CFLAGS=-DUSE_OLD_FUNCTIONS</code>). Вместо перекомпиляции лучше пересобрать
клиента для использования нового 4.0 API.

<LI>

В структуре <code>MYSQL_FIELD</code> величины <code>length</code> и <code>max_length</code> изменены с
<code>unsigned int</code> на <code>unsigned long</code>. Это не должно вызывать проблем, за
исключением того, что при использовании величин с такими типами в
качестве аргументов в функциях класса <code>printf()</code> могут генерироваться
предупреждающие сообщения.

<LI>

Если необходимо удалить из таблицы все строки, но вам не нужно знать,
сколько строк было удалено, следует использовать <code>TRUNCATE TABLE</code> при
(поскольку <code>TRUNCATE TABLE</code> значительно быстрее, чем <code>DELETE FROM
table_name</code>).

<LI>

При попытке выполнить <code>TRUNCATE TABLE</code> или <code>DROP DATABASE</code> при наличии
активной команды <code>LOCK TABLES</code> или транзакции вы получите ошибку. 

<LI>

Для хранения величин в столбцах <code>BIGINT</code> необходимо использовать целые
числа (вместо строк, как было в MySQL 3.23). Возможность использования
строк для данного случая пока еще работает, но применение целых чисел
более эффективно.

<LI>

Изменен формат <code>SHOW OPEN TABLE</code>.

<LI>

Многопоточные клиенты должны использовать <code>mysql_thread_init()</code> и
<code>mysql_thread_end()</code>. See section <A HREF="manual.ru_Clients.html#Threaded_clients">8.4.8  Как создать клиентскую программу с потоками</A>.

<LI>

При желании перекомпилировать модуль Perl <code>DBD::mysql</code> необходимо
получить версию <code>Msql-Mysql-modules</code> 1.2218 или более новую, поскольку в
более старых модулях <code>DBD</code> использовался не поддерживаемый вызов функции
<code>drop_db()</code>.

<LI>

В версии 4.0 <code>RAND(seed)</code> возвращает иные последовательности случайных
чисел, чем в 3.23; это сделано для того, чтобы лучше различать
<code>RAND(seed)</code> и <code>RAND(seed+1)</code>.

<LI>

Тип результата, возвращаемый  <code>IFNULL(A,B)</code> теперь по умолчанию
устанавливается более "общий" по отношению к типам <code>A</code> и <code>B</code>. Порядок
выбора - <code>STRING</code>, <code>REAL</code> или <code>INTEGER</code>.

</ul>



<H3><A NAME="Upgrading-from-3.22" HREF="manual.ru_toc.html#Upgrading-from-3.22">2.5.3  Модернизация с версии 3.22 до версии 3.23</A></H3>

<P>
<A NAME="IDX316"></A>
<A NAME="IDX317"></A>

</P>
<P>
В версии MySQL 3.23 поддерживаются таблицы нового типа <code>MyISAM</code> и старого
типа <code>ISAM</code>. Старые таблицы не нуждаются в преобразовании для использования
их в версии 3.23. По умолчанию все новые таблицы будут создаваться с типом
<code>MyISAM</code> (если вы не запускаете <code>mysqld</code> с опцией <code>--default-table-type=isam</code>).
Можно преобразовать таблицу <code>ISAM</code> в таблицу <code>MyISAM</code> при помощи команды
<code>ALTER TABLE table_name TYPE=MyISAM</code> или при помощи Perl-скрипта 
<code>mysql_convert_table_format</code>.

</P>
<P>
Клиенты версий 3.22 и 3.21 должны работать с сервером версии 3.23 без
каких-либо проблем.

</P>
<P>
Ниже перечислены моменты, на которые следует обратить внимание при
модернизации до версии 3.23:

<ul>
<LI>

Все таблицы, в которых используется кодировка <code>tis620</code>, должны быть
исправлены с помощью <code>myisamchk -r</code> или <code>REPAIR TABLE</code>.

<LI>

При выполнении команды <code>DROP DATABASE</code> над базой данных, связанной
символической ссылкой, удаляются как данная ссылка, так и исходная
база данных (в 3.22 это было не так, поскольку программа <code>configure</code> не
распознавала системный вызов <code>readlink</code>).

<LI>

<code>OPTIMIZE TABLE</code> сейчас работает только с таблицами <code>MyISAM</code>. Для других
типов таблиц можно использовать команду <code>ALTER TABLE</code> для оптимизации
таблицы. Во время выполнения команды <code>OPTIMIZE TABLE</code> оптимизируемая
таблица сейчас заблокирована для других потоков.

<LI>

Клиент <code>mysql</code> сервера MySQL сейчас по умолчанию начинает свою работу с
опцией <code>--no-named-commands</code> (<code>-g</code>). Данную опцию можно отключить с
помощью <code>--enable-named-commands</code> (<code>-G</code>). В некоторых случаях это может
вызывать проблемы несовместимости, например, в скриптах SQL, в которых
названные команды используются без точки с запятой! Команды большого
формата пока еще работают с начала строки.

<LI>

Функции даты, работающие с частью представления даты (такие как
<code>MONTH()</code>), сейчас будут возвращать <code>0</code> для даты <code>0000-00-00</code> (в версии
MySQL 3.22 возвращалась величина <code>NULL</code>).

<LI>

При использовании порядка сортировки символов german необходимо
исправить все таблицы с помощью <code>isamchk -r</code>, так как в порядке
сортировки произведены некоторые изменения!

<LI>

Возвращаемый по умолчанию тип выражения <code>IF</code> теперь зависит от обоих
аргументов, а не только от первого.

<LI>

<code>AUTO_INCREMENT</code> теперь не будет работать с отрицательными числами;
причина в том, что отрицательные числа вызывали проблемы при переходе
от <code>-1</code> к <code>0</code>. Для таблиц <code>MyISAM</code> <code>AUTO_INCREMENT</code> не обрабатывается на более
низком уровне и работает намного быстрее, чем раньше. Для таблиц
<code>MyISAM</code> старые автоинкрементные номера также не используются повторно,
даже при удалении из таблицы строк.

<LI>

<code>CASE</code>, <code>DELAYED</code>, <code>ELSE</code>, <code>END</code>, <code>FULLTEXT</code>, <code>INNER</code>, <code>RIGHT</code>, <code>THEN</code> и <code>WHEN</code> 
сейчас  являются  зарезервированными  словами.

<LI>

<code>FLOAT(X)</code> сейчас является настоящим типом данных с плавающей точкой, а
не величиной с фиксированным числом десятичных знаков.

<LI>

При объявлении <code>DECIMAL(length,dec)</code> аргумент <code>length</code> больше не включает
в себя место для знака или десятичной точки.

<LI>

Строка <code>TIME</code> теперь должна представлять собой один из следующих
форматов: <code>[[[DAYS] [H]H:]MM:]SS[.fraction]</code> или
<code>[[[[[H]H]H]H]MM]SS[.fraction]</code>.

<LI>

<code>LIKE</code> сейчас сравнивает строки, используя те же правила сравнения
символов, что и <code>=</code>. Если необходим старый режим работы, то можно
скомпилировать MySQL с флагом <code>CXXFLAGS=-DLIKE_CMP_TOUPPER</code>.

<LI>

Выражение <code>REGEXP</code> сейчас является независимым от регистра символов для
нормальных (не двоичных) строк.

<LI>

При проверке/исправлении таблиц необходимо использовать <code>CHECK TABLE</code> 
или <code>myisamchk</code> для таблиц <code>MyISAM</code> (<tt>`.MYI'</tt>) и <code>isamchk</code> для таблиц <code>ISAM</code>
(<tt>`.ISM'</tt>).

<LI>

Чтобы обеспечить совместимость файлов <code>mysqldump</code> между версией MySQL
3.22 и версией 3.23, не следует использовать опцию <code>--opt</code> или <code>--all</code> 
для <code>mysqldump</code>.

<LI>

Проверьте все ваши вызовы функции <code>DATE_FORMAT()</code>, чтобы убедиться, что
перед каждым символом формата имеется <samp>`%'</samp> (в версии MySQL 3.22 и более
поздних этот синтаксис уже допускается).

<LI>

<code>mysql_fetch_fields_direct</code> сейчас является функцией (был макрос) и
возвращает указатель на <code>MYSQL_FIELD</code> вместо <code>MYSQL_FIELD</code>.

<LI>

Функцию <code>mysql_num_fields()</code> больше нельзя использовать на объектах
<code>MYSQL*</code> (сейчас это функция, принимающая <code>MYSQL_RES*</code> в качестве
аргумента, так что вместо нее следует применять <code>mysql_field_count()</code>).

<LI>

В версии MySQL 3.22 вывод <code>SELECT DISTINCT ...</code> почти всегда был
отсортированным. Чтобы получить отсортированный вывод в версии 3.23,
необходимо использовать <code>GROUP BY</code> или <code>ORDER BY</code>.

<LI>

Функция <code>SUM()</code> сейчас возвращает <code>NULL</code> вместо <code>0</code> при отсутствии
сопоставляемых строк: это сделано для соответствия с ANSI SQL.

<LI>

Операторы <code>AND</code> или <code>OR</code> с величинами <code>NULL</code> теперь будут возвращать <code>NULL</code>
вместо <code>0</code>. В основном, это влияет на запросы, в которых используется
<code>NOT</code> на выражениях <code>AND</code>/<code>OR</code>, так как <code>NOT NULL = NULL</code>. <code>LPAD()</code> и <code>RPAD()</code> 
будут укорачивать результирующую строку, если она длиннее, чем
аргумент длины.
</ul>



<H3><A NAME="Upgrading-from-3.21" HREF="manual.ru_toc.html#Upgrading-from-3.21">2.5.4  Модернизация с версии 3.21 до версии 3.22</A></H3>

<P>
<A NAME="IDX318"></A>
<A NAME="IDX319"></A>

</P>
<P>
В версии 3.21 по сравнению с 3.22 не было сделано никаких изменений,
влияющих на совместимость. Единственный подводный камень - это то, что для
новых таблиц, создающихся  со столбцами типа <code>DATE</code>, будет применяться новый
способ хранения даты. При использовании старой версии <code>mysqld</code> получить
доступ к этим новым полям будет нельзя.

</P>
<P>
После установки версии MySQL 3.22 необходимо запустить новый сервер, а
затем выполнить скрипт <code>mysql_fix_privilege_tables</code>. В результате будут
добавлены новые привилегии, необходимые для использования команды <code>GRANT</code>.
Если вы забудете выполнить эти действия, то получите <code>Access denied</code> при
попытке использовать <code>ALTER TABLE</code>, <code>CREATE INDEX</code> или <code>DROP INDEX</code>. Если для
вашего привилегированного (<code>root</code>) пользователя MySQL требуется пароль, то
следует указать его как аргумент в <code>mysql_fix_privilege_tables</code>.

</P>
<P>
Изменен интерфейс C API к функции <code>mysql_real_connect()</code>.Если вы
располагаете старой клиентской программой, вызывающей данную функцию, то
необходимо задать значение <code>0</code> для нового аргумента <code>db</code> (или перекодировать
данный клиент, чтобы посылать значение элемента <code>db</code> для более быстрых
подключений). Необходимо также вызывать <code>mysql_init()</code> перед вызовом функции
<code>mysql_real_connect()</code>! Это изменение было проведено для того, чтобы дать
возможность новой функции <code>mysql_options()</code> сохранять опции в структуре
обработчика <code>MYSQL</code>.

</P>
<P>
Имя относящейся к <code>mysqld</code> переменной <code>key_buffer</code> изменено на
<code>key_buffer_size</code>, однако старое имя можно использовать по-прежнему.

</P>


<H3><A NAME="Upgrading-from-3.20" HREF="manual.ru_toc.html#Upgrading-from-3.20">2.5.5  Модернизация с версии 3.20 до версии 3.21</A></H3>

<P>
<A NAME="IDX320"></A>
<A NAME="IDX321"></A>

</P>
<P>
Если вы работаете с версией выше, чем 3.20.28, и хотите перейти к 3.21, то
необходимо сделать следующее:

</P>
<P>
Можно запустить сервер <code>mysqld</code> версии 3.21 с опцией <code>safe_mysqld
--old-protocol</code>, чтобы использовать его с клиентами из дистрибутива версии
3.20. В этом случае функция <code>mysql_errno()</code> нового клиента не возвращает
никаких серверных ошибок, кроме <code>CR_UNKNOWN_ERROR</code> (она предназначена для
клиентских ошибок), при этом сервер использует не новую, а старую функцию
проверки <code>password()</code>.

</P>
<P>
Если вы не собираетесь использовать опцию <code>--old-protocol</code> к <code>mysqld</code>, то
необходимо будет выполнить следующие изменения:

</P>

<ul>
<LI>

Весь клиентский код следует перекомпилировать. Для использования ODBC
необходимо приобрести новый драйвер <code>MyODBC</code> 2.x.
<LI>

Необходимо запустить скрипт <tt>`scripts/add_long_password'</tt> для
преобразования поля <code>Password</code> в таблице <code>mysql.user</code> к <code>CHAR(16)</code>.
<LI>

Все пароли в таблице <code>mysql.user</code> должны быть переназначены (чтобы
получить 62- разрядные пароли вместо 31- разрядных).
<LI>

Формат таблиц не изменялся, следовательно, в преобразовании каких-либо
таблиц необходимости нет.
</ul>

<P>
Версия MySQL 3.20.28 и выше может обрабатывать новый формат таблиц <code>user</code>
так, что это не отражается на клиентах. В более ранних, чем 3.20.28,
версиях MySQL пароли больше не будут работать с клиентами, если таблица
<code>user</code> преобразована. Для уверенности следует прежде провести апгрейд по
меньшей мере до версии 3.20.28 и затем модернизировать до версии 3.21.

</P>
<P>
<A NAME="IDX322"></A>

</P>
<P>
Новый код клиента работает с сервером <code>mysqld</code> версии 3.20.x, так что в
случае каких-либо проблем с версией 3.21.x можно использовать старый
сервер 3.20.x без необходимости повторной перекомпиляции клиентов.

</P>
<P>
Если не применить опцию <code>--old-protocol</code> для <code>mysqld</code>, то старые клиенты
выдадут следующее сообщение об ошибке:

</P>

<pre>
ERROR: Protocol mismatch. Server Version = 10 Client Version = 9
</pre>

<P>
Новый интерфейс Perl <code>DBI</code>/<code>DBD</code> также поддерживает старый интерфейс
<code>mysqlperl</code>. Единственное изменение, которое следует произвести при
использовании <code>mysqlperl</code>, модифицировать аргументы в функции <code>connect()</code>.
Новыми аргументами являются: <code>host</code>, <code>database</code>, <code>user</code>, и <code>password</code> (аргументы
<code>user</code> и <code>password</code> поменялись местами). See section <A HREF="manual.ru_Clients.html#Perl_DBI_Class">8.2.2  Интерфейс <code>DBI</code></A>.

</P>
<P>
Ниже перечислены изменения, которые могут повлиять на запросы в старых
приложениях:

</P>

<ul>
<LI>

<code>HAVING</code> теперь необходимо указывать перед любым выражением <code>ORDER BY</code>.
<LI>

Произведена замена параметров в <code>LOCATE()</code>.
<LI>

Появилось несколько новых зарезервированных слов. Наиболее значимыми
из них являются <code>DATE</code>, <code>TIME</code> и <code>TIMESTAMP</code>.
</ul>



<H3><A NAME="Upgrading-to-arch" HREF="manual.ru_toc.html#Upgrading-to-arch">2.5.6  Модернизация к иной архитектуре</A></H3>

<P>
<A NAME="IDX323"></A>
<A NAME="IDX324"></A>

</P>

<P>
При использовании MySQL 3.23 можно копировать файлы <tt>`.frm'</tt>, <tt>`.MYI'</tt> и
<tt>`.MYD'</tt> между различными архитектурами, поддерживающими одинаковый формат
чисел с плавающей точкой (все проблемы, связанные с перестановкой байтов,
берет на себя MySQL).

</P>
<P>
Имеющиеся в MySQL файлы данных и индексные файлы типа <code>ISAM</code> (<tt>`.ISD'</tt> и
<tt>`*.ISM'</tt> соответственно) являются архитектурно-независимыми, а в ряде
случаев - зависимыми от операционной системы. Для переноса приложений на
компьютер с архитектурой или операционной системой, которые отличаются от
используемых на исходном компьютере, не следует пытаться перенести базу
данных путем простого копирования файлов на другой компьютер. Используйте
вместо этого <code>mysqldump</code>.

</P>
<P>
По умолчанию <code>mysqldump</code> создаст файл со всеми командами SQL. После этого
данный файл можно перенести на другой компьютер и подать его на вход
клиента <code>mysql</code>.

</P>
<P>
Используя <code>mysqldump --help</code>, просмотрите все доступные опции. При
перемещении данных на более новую версию MySQL следует применять <code>mysqldump
--opt</code> более новой версии, чтобы получить быструю и компактную копию.

</P>
<P>
Самый простой (хотя и не самый быстрый) способ перемещения базы данных с
компьютера на компьютер - запустить на компьютере, где размещается
исходная база данных, следующие команды:

</P>

<pre>
shell&#62; mysqladmin -h 'other hostname' create db_name
shell&#62; mysqldump --opt db_name \
      | mysql -h 'other hostname' db_name
</pre>

<P>
Если вы хотите скопировать базу данных с удаленного компьютера через
медленную сеть, то можно использовать:

</P>

<pre>
shell&#62; mysqladmin create db_name
shell&#62; mysqldump -h 'other hostname' --opt --compress db_name \
      | mysql db_name
</pre>

<P>
Можно также сохранять результат в файле, затем передавать этот файл на
требуемый компьютер и загружать этот файл в расположенную там базу данных.
Например, можно скопировать базу данных в файл на исходном компьютере как
показано ниже:

</P>

<pre>
shell&#62; mysqldump --quick db_name | gzip &#62; db_name.contents.gz
</pre>

<P>
(Созданный в данном примере файл сжимается). Передайте этот файл с
содержимым базы данных на требуемый компьютер и запустите там эти команды:

</P>

<pre>
shell&#62; mysqladmin create db_name
shell&#62; gunzip &#60; db_name.contents.gz | mysql db_name
</pre>

<P>
<A NAME="IDX325"></A>
<A NAME="IDX326"></A>

</P>
<P>
Для выполнения передачи базы данных можно также использовать <code>mysqldump</code> и
<code>mysqlimport</code>. В случае больших таблиц это намного более быстрый способ, чем
простое применение <code>mysqldump</code>. В следующих командах <code>DUMPDIR</code> представляет
собой полный путь к каталогу, используемому для хранения вывода из
<code>mysqldump</code>.

</P>
<P>
Во-первых, создайте каталог для файлов вывода и дампа базы данных:

</P>

<pre>
shell&#62; mkdir DUMPDIR
shell&#62; mysqldump --tab=DUMPDIR db_name
</pre>

<P>
Затем передайте эти файлы в каталог <code>DUMPDIR</code> некоторого соответствующего
каталога на требуемом компьютере и загрузите там данные файлы в MySQL:

</P>

<pre>
shell&#62; mysqladmin create db_name # создание  базы  данных
shell&#62; cat DUMPDIR/*.sql | mysql db_name # создание  таблиц  в  базе данных
shell&#62; mysqlimport db_name DUMPDIR/*.txt # загрузка  данных  в  таблицы
</pre>

<P>
Помимо этого, не забудьте скопировать базу данных <code>mysql</code>, поскольку в ней
хранятся таблицы привилегий (<code>user</code>, <code>db</code>, <code>host</code>). Возможно, на новом
компьютере будет нужно запустить команды в качестве пользователя <code>root</code>
MySQL, пока база данных <code>mysql</code> не займет свое место.

</P>
<P>
После импорта базы данных <code>mysql</code> на новый компьютер выполните <code>mysqladmin
flush-privileges</code>, чтобы сервер перезагрузил информацию в таблицах
привилегий.

</P>


<H2><A NAME="Operating_System_Specific_Notes" HREF="manual.ru_toc.html#Operating_System_Specific_Notes">2.6  Заметки по операционным системам</A></H2>



<H3><A NAME="Linux" HREF="manual.ru_toc.html#Linux">2.6.1  Примечания к Linux (Все версии Linux)</A></H3>

<P>
Приведенные ниже замечания о <code>glibc</code> будут полезны только для случая, когда
вы собираете MySQL самостоятельно. Но обычно, если Linux работает на
машине с архитектурой x86, гораздо лучше использовать наши бинарные файлы.
Они линкуются с <code>glibc</code>, к которой применены наиболее удачные патчи, и с
наиболее удачными опциями компилятора - все это сделано для того, чтобы
программа была пригодной для работы на сильно нагруженном сервере. Поэтому
если после прочтения данного раздела у вас возникнут сомнения относительно
дальнейших действий, попробуйте сначала использовать бинарные файлы -
возможно, они удовлетворят вашим требованиям. Если же окажется, что
бинарные файлы вас не устраивают, то можно попробовать заняться
собственноручной сборкой. Мы будем очень признательны за сообщение о том,
почему вам пришлось отказаться от работы с нашими бинарниками, - это
поможет нам в следующий раз собрать более удачную версию программы. Что же
касается обычных пользователей, то для них даже при установке,
рассчитанной на большое количество параллельных соединений и/или таблиц,
превосходящих по объему ограничение в 2 Гб, наши бинарные файлы будут
наилучшим вариантом выбора.

</P>
<P>
В операционной системе Linux MySQL использует LinuxThreads. Если у вас
старая система Linux, в которой отсутствует <code>glibc2</code>, то прежде чем
предпринимать попытку компиляции MySQL, необходимо установить
LinuxThreads. Получить LinuxThreads можно по адресу
<a HREF="http://www.mysql.com/downloads/os-linux.html">http://www.mysql.com/downloads/os-linux.html</a>.

</P>
<P>
<strong>Примечание</strong>: на Linux 2.2.14 и MySQL, установленных на многопроцессорных
(SMP) системах, могут возникать некоторые непонятные проблемы. В таком
случае мы рекомендуем как можно быстрее сделать апгрейд версии ядра до
2.4: оно станет гораздо более быстрым и устойчивым.

</P>
<P>
Необходимо отметить, что версии <code>glibc</code> до 2.1.1 включительно содержат
фатальную ошибку в обработке <code>pthread_mutex_timedwait</code>, которая проявляется
при использовании <code>INSERT DELAYED</code>. Поэтому мы рекомендуем не использовать
<code>INSERT DELAYED</code>, пока не будет сделан апгрейд <code>glibc</code>.

</P>
<P>
Если планируется использовать более 1000 одновременных соединений,
необходимо сделать некоторые изменения в LinuxThreads, пересобрать их и
перелинковать MySQL с новой <tt>`libpthread.a'</tt>. Следует увеличить
<code>PTHREAD_THREADS_MAX</code> в файле <tt>`sysdeps/unix/sysv/linux/bits/local_lim.h'</tt> до
4096 и уменьшить <code>STACK_SIZE</code> в <tt>`linuxthreads/internals.h'</tt> до 256 Kб.

</P>
<P>
Пути указаны относительно корневого каталога <code>glibc</code>. Заметим, что MySQL не
будет устойчиво работать при 600-1000 соединениях, если размер <code>STACK_SIZE</code>
останется по умолчанию 2 Mб.

</P>
<P>
Если MySQL не может открыть достаточное количество файлов или принять
достаточное количество соединений, то это значит, что в Linux не
сконфигурирована возможность открытия необходимого количества файлов.

</P>
<P>
В Linux 2.2 и более свежих версиях можно получить значение максимального
количества файлов, которые можно открыть одновременно. Для этого
необходимо выполнить:

</P>

<pre>
cat /proc/sys/fs/file-max
cat /proc/sys/fs/dquot-max
cat /proc/sys/fs/super-max
</pre>

<P>
В случае, если на машине установлено более 16 Mб памяти, к загрузочному
скрипту (<tt>`/etc/init.d/boot.local'</tt> на SuSE) необходимо добавить записи
наподобие следующих:

</P>

<pre>
echo 65536 &#62; /proc/sys/fs/file-max
echo 8192 &#62; /proc/sys/fs/dquot-max
echo 1024 &#62; /proc/sys/fs/super-max
</pre>

<P>
Эти команды можно также запустить из командной строки от имени
пользователя

</P>
<P>
<code>root</code>, но в таком случае при перезагрузке компьютера будут использоваться
старые ограничения.

</P>
<P>
Альтернативно, вы можете установить эти параметры при загрузке, используя
утилиту <code>sysctl</code>, которая используется во множестве поставок Linux (SuSE также добавила
ее, начиная с SuSE 8.0). Просто напишите такие значения в файл <tt>`/etc/sysctl.conf'</tt>:

</P>

<pre>
# увеличить некоторые значения для MySQL
fs.file-max = 65536
fs.dquot-max = 8192
fs.super-max = 1024
</pre>

<P>
Кроме того, необходимо добавить в <tt>`/etc/my.cnf'</tt>:

</P>

<pre>
[safe_mysqld]
open-files-limit=8192
</pre>

<P>
Добавление такой записи позволит MySQL создавать до 8192 соединений и
файлов.

</P>
<P>
Размером стеков потоков в адресном пространстве управляет константа
<code>STACK_SIZE</code> в LinuxThreads. Ее значение должно быть достаточно большим,
чтобы хватило места стеку каждого потока, но достаточно малым, чтобы
предотвратить попадание стеков некоторых потоков в область общих данных
<code>mysqld</code>. К сожалению, опытным путем нам удалось обнаружить, что реализация
<code>mmap()</code> на Linux в случае поступления запроса на выделение адреса, который
уже используется, вместо возвращения сообщения об ошибке успешно
освобождает все ранее выделенные области и обнуляет данные на всей
странице. Поэтому безопасность использования <code>mysqld</code> или любого другого
потокового приложения зависит от "джентльменского" поведения кода,
создающего потоки. Пользователь должен принять меры для обеспечения
достаточно малого количества выполняемых потоков в любой момент времени,
чтобы стеки потоков не пересекались с динамически выделяемой памятью. В
случае <code>mysqld</code> необходимо навязать это "джентльменское" поведение
установкой переменной <code>max_connection</code> в разумных пределах.

</P>
<P>
Если вы собираете MySQL самостоятельно и не хотите заниматься патчами
LinuxThreads, то необходимо установить значение <code>max_connections</code> так, чтобы
оно не превышало 500. Это значение должно быть еще меньше, если у вас
достаточно велик буфер ключей, большая таблица динамически выделяемой
памяти или имеются другие причины, по которым <code>mysqld</code> занимает большие
объемы памяти, а также в случае, если вы используете ядро 2.2 с патчами
для 2 Гб. Если используются наши бинарные файлы или RPM версии не старше
3.23.25, то можно безопасно устанавливать <code>max_connections</code> равным 1500 -
при условии, что буфер ключей или таблицы динамически выделяемой памяти
имеют небольшие размеры. Чем меньше <code>STACK_SIZE</code> в LinuxThreads, тем больше
потоков можно безопасно создать. Рекомендуемая нами величина составляет от
128K до 256K.

</P>
<P>
При использовании множества одновременных соединений вы можете пострадать
от одной "особенности" ядра 2.2. Данная особенность заключается в том, что
процесс штрафуется за ветвление или порождение дочерних процессов - чтобы
предотвратить атаки ветвлением. Это приводит к неудачному масштабированию
MySQL при увеличении количества одновременных соединений. По нашим данным,
на однопроцессорных машинах из-за данной особенности создание потоков
происходит очень медленно, что может привести к большим затратам времени
на соединение с MySQL (до 1 минуты), и столько же может занять завершение
соединения. Что же касается многопроцессорных систем, то на них
наблюдалось постепенное снижение скорости по мере роста числа клиентов.
Пока мы пытались найти решение проблемы, один из пользователей прислал
патч к ядру, утверждая, что патч заметно улучшил работу его сайта. Патч
доступен по адресу
<a HREF="http://www.mysql.com/Downloads/Patches/linux-fork.patch">http://www.mysql.com/Downloads/Patches/linux-fork.patch</a>. Мы провели
достаточно обширное тестирование этого патча как на развивающейся, так и
на промышленной версиях системы. Применение патча заметно улучшило
производительность <code>MySQL</code>, не вызвав при этом никаких проблем, поэтому
теперь мы рекомендуем его пользователям, которые до сих пор используют
ядро 2.2 на сильно нагруженных серверах. Кроме того, эта проблема была
решена в ядре 2.4, поэтому если вас не устраивает производительность
системы, то, по-видимому, проще сделать ее апгрейд до 2.4, чем
использовать патчи к ядру 2.2. При обновлении системы, помимо исправления
этой ошибки, вы также получите возможность воспользоваться преимуществами
SMP.

</P>
<P>
При тестировании MySQL на двухпроцессорной машине с ядром 2.4 мы
обнаружили, что MySQL масштабируется <strong>гораздо</strong> лучше - фактически
отсутствовало замедление обработки запросов вплоть до 1000 соединений, а
фактор масштабируемости MySQL (который вычисляется как отношение
максимальной производительности к производительности при работе с одним
клиентом) достигал 180%. Подобные результаты мы наблюдали на
четырехпроцессорной системе - фактическое отсутствие замедления при росте
количества соединений до 1000 при факторе масштабируемости в 300%. Поэтому
для интенсивно нагруженных серверов мы настоятельно рекомендуем ядро 2.4.
Оказалось также, что для достижения максимума производительности на ядре
2.4 весьма важно запускать <code>mysqld</code> с наибольшим возможным приоритетом. Для
этого следует добавить в скрипт <code>safe_mysqld</code> команду <code>renice -20 $$</code>. В наших
тестах на четырехпроцессорной машине увеличение приоритета привело к
повышению производительности на 60% при работе 400 клиентов.

</P>
<P>
В дополнение к этому мы сейчас занимаемся сбором информации о
производительности MySQL с ядром 2.4 на четырех- и восьмипроцессорных
системах. Если у вас есть доступ к таким системам и вы тестировали их
производительность, пожалуйста, отправьте сообщение с результатами по
адресу <a HREF="mailto:docs@mysql.com">docs@mysql.com</a> - мы добавим эти результаты в документацию.

</P>
<P>
Существует еще один нюанс, заметно влияющий на производительность

</P>
<P>
MySQL, особенно на многопроцессорных системах. В LinuxThreads в <code>glibc-2.1</code> 
очень плохо реализованы mutex'ы для программ со множеством потоков, в
которых mutex хранится непродолжительное время. Парадоксально, но факт: в
случае, если на многопроцессорных системах собрать MySQL с
немодифицированными LinuxThreads, то при удалении процессора во много раз
увеличивается производительность. Для решения этой проблемы мы предлагаем
патч к <code>glibc 2.1.</code>3
<a HREF="http://www.mysql.com/Downloads/Linux/linuxthreads-2.1-patch">http://www.mysql.com/Downloads/Linux/linuxthreads-2.1-patch</a>.

</P>
<P>
В <code>glibc-2.2.2</code> MySQL версии 3.23.36 использует адаптивный mutex, который
гораздо лучше даже ``патченного'' в <code>glibc-2.3.1</code>. Однако предупреждаем, что
при некоторых условиях код mutex'а в <code>glibc-2.2.2</code> "закручивается"
(overspin), а это ухудшает производительность MySQL. Шансы возникновения
такого события можно понизить, если повысить приоритет выполнения <code>mysqld</code>.
Можно также исправить "закручивание" с помощью патча, доступного по адресу
<a HREF="http://www.mysql.com/Downloads/Linux/linuxthreads-2.2.2.patch">http://www.mysql.com/Downloads/Linux/linuxthreads-2.2.2.patch</a>. Он содержит
в себе коррекцию "закручивания", максимальное количество потоков и размеры
стека - все вместе. Необходимо применить его в каталоге <code>linuxthreads</code>
командой patch <code>-p0 &#60;/tmp/linuxthreads-2.2.2.patch</code>. Мы надеемся, что данный
патч будет в некотором виде включен в следующие выпуски <code>glibc-2.2</code>. В любом
случае - если вы линкуете с использованием библиотеки <code>glibc-2.2.2</code>, то пока
что необходимо исправлять <code>STACK_SIZE</code> и <code>PTHREAD_THREADS_MAX</code>. Мы не теряем
надежду, что в будущем значения по умолчанию будут приведены к более
приемлемым для сборки интенсивно нагруженного MySQL величинам, так что
самостоятельная сборка сведется к выполнению <code>./configure; make; make
install</code>.

</P>
<P>
Вышеупомянутые патчи мы рекомендуем использовать только для создания
специальной статической версии <tt>`libpthread.a'</tt>, а последнюю - применять
только для статического линкования MySQL. Мы уверены, что для MySQL эти
патчи безопасны и заметно улучшают его производительность, но относительно
других приложений данных нет. Линкуя другие приложения с ``патченной''
версией библиотеки или собирая ее динамическую версию и устанавливая ее на
свою систему, вы осознанно идете на риск по отношению к другим
приложениям, использующим LinuxThreads.

</P>
<P>
В случае, если вам придется столкнуться с непонятными проблемами при
инсталляции MySQL или при работе утилит, то причина, вероятнее всего,
связана с библиотеками или компилятором. В таком случае проблему должно
решить использование наших бинарных файлов.

</P>
<P>
Существует одна известная проблема с бинарным дистрибутивом, касающаяся
старых систем Linux, в которых используется <code>libc</code> (таких как RedHat 4.x или
Slackware). Она проявляется в виде некоторых некритичных проблем с
разрешением  имен (see section <A HREF="manual.ru_Installing.html#Binary_notes-Linux">2.6.1.1  Примечания к бинарным дистрибутивам Linux</A>).

</P>
<P>
При использовании LinuxThreads одновременно работают как минимум три
процесса. По сути это потоки. Один поток управляет LinuxThreads, один -
обрабатывает соединения и еще один - обрабатывает различные сигналы.

</P>
<P>
Заметим, что ядро Linux и библиотека LinuxThreads по умолчанию могут
поддерживать только 1024 потока. Это значит, что может существовать не
более 1021 соединения с MySQL на системе, к которой не применялись патчи.
Информацию о том, как обойти это ограничение, можно найти на странице 
<a HREF="http://www.volano.com/linuxnotes.html">http://www.volano.com/linuxnotes.html</a>.

</P>
<P>
Если по результату работы команды ps вы видите, что <code>mysqld</code> прекратил
работу,

</P>
<P>
то обычно причиной этого является либо обнаружение ошибки в MySQL, либо
испорченная таблица (see section <A HREF="manual.ru_Problems.html#Crashing">A.4.1  Что делать, если работа MySQL сопровождается постоянными сбоями</A>).

</P>
<P>
Если при получении сигнала <code>SIGSEGV</code> <code>mysqld</code> просто умирает, то для получения
образа памяти (core dump) на Linux можно запустить <code>mysqld</code> с опцией
<code>--core-file</code>. Заметим, что при этом вам, возможно, придется увеличить
размер допустимого объема файла образа памяти путем добавления строки
<code>ulimit -c 1000000</code> в <code>safe_mysqld</code> или запуском <code>safe_mysqld</code> с опцией
<code>--core-file-size=1000000</code> (see section <A HREF="manual.ru_MySQL_Database_Administration.html#safe_mysqld">4.7.2  <code>safe_mysqld</code>, оболочка <code>mysqld</code></A>).

</P>
<P>
Если при линковании собственного MySQL-клиента возникла ошибка:

</P>

<pre>
ld.so.1: ./my: fatal: libmysqlclient.so.4:
open failed: No such file or directory
</pre>

<P>
то проблему можно обойти одним из следующих способов:

</P>

<ul>
<LI>

линковать клиент с одним из флагов: <code>-Wl,r/path-libmysqlclient.so</code>. (вместо <code>-Lpath</code>);

<LI>

скопировать <tt>`libmysqclient.so'</tt> в <tt>`/usr/lib'</tt>;

<A NAME="IDX327"></A>
<A NAME="IDX328"></A>

<LI>

добавить путь к каталогу, в котором находится <tt>`libmysqlclient.so'</tt>, к переменной окружения <code>LD_RUN_PATH</code> перед запуском клиента.
</ul>

<P>
Если вы используете компилятор Fujitsu (<code>fcc / FCC</code>), то возможны некоторые
проблемы компиляции MySQL поскольку заголовки в Linux в значительной
степени ориентированы на <code>gcc</code>.

</P>
<P>
Данная конфигурация должна работать с <code>fcc/FCC</code>:

</P>

<pre>
CC=fcc CFLAGS="-O -K fast -K lib -K omitfp -Kpreex -D_GNU_SOURCE \
-DCONST=const -DNO_STRTOLL_PROTO" CXX=FCC CXXFLAGS="-O -K fast -K lib \
-K omitfp -K preex --no_exceptions --no_rtti -D_GNU_SOURCE -DCONST=const \
-Dalloca=__builtin_alloca -DNO_STRTOLL_PROTO \
'-D_EXTERN_INLINE=static __inline'" ./configure --prefix=/usr/local/mysql\
--enable-assembler --with-mysqld-ldflags=-all-static --disable-shared \
--with-low-memory
</pre>



<H4><A NAME="Binary_notes-Linux" HREF="manual.ru_toc.html#Binary_notes-Linux">2.6.1.1  Примечания к бинарным дистрибутивам Linux</A></H4>

<P>
<A NAME="IDX329"></A>

</P>
<P>
Для работы MySQL необходим Linux версии не ниже 2.0.

</P>
<P>
<strong>Предупреждение</strong>:
По данным, полученным нами от некоторых пользователей
MySQL, на Linux с ядром 2.2.14 имеются серьезные проблемы с устойчивостью
работы MySQL. Если вы используете это ядро, необходимо обновить его до
версии 2.2.19 или выше, либо до ядра версии 2.4. Аргументы в пользу 2.4
становятся еще более весомыми при использовании многопроцессорной системы,
поскольку переход на эту версию ядра приводит к заметному увеличению
скорости.

</P>
<P>
Как правило, бинарный дистрибутив линкуется с опцией <code>-static</code>, а это
значит, что обычно нет необходимости беспокоиться о том, какая версия
системных библиотек у вас установлена. Не требуется также устанавливать
LinuxThreads. Размер программы, слинкованной с опцией <code>-static</code>, обычно
больше в сравнении с версией, собранной динамически, однако скорость
работы у нее выше (3-5%). Существует, однако, одна проблема. Она
заключается в том, что со статически слинкованными программами невозможно
использовать определяемые пользователем функции (user-definable function,
UDF). Если вы собираетесь писать или использовать UDF'ы (это информация,
касающаяся только программистов на C или C++), вам следует собственноручно
собрать MySQL с использованием динамического линкования.

</P>
<P>
При использовании систем, базирующихся на <code>libc</code> (в отличие от
<code>glibc2</code>-систем), могут возникать некоторые проблемы с разрешением имен
удаленных компьютеров и использованием <code>getpwnam()</code> с бинарной версией (это
происходит из-за того, что, к сожалению, <code>glibc</code> зависит от некоторых
внешних библиотек при разрешении имен и использовании <code>getpwent()</code>, даже при
сборке с опцией <code>-static</code>). В таком случае при запуске <code>mysql_install_db</code>
возможно появление следующего сообщения об ошибке:

</P>

<pre>
Sorry, the host 'xxxx' could not be looked up
</pre>

<P>
Или же - при запуске <code>mysqld</code> с опцией <code>--user</code> - сообщение об ошибке может
быть таким:

</P>

<pre>
getpwnam: No such file or directory
</pre>

<P>
Эту проблему можно решить одним из следующих способов:

</P>

<ul>
<LI>

загрузить и установить дистрибутив MySQL с исходными текстами (RPM или
дистрибутив <code>tar.gz</code>).
<LI>

Запустить <code>mysql_install_db --force</code>, чтобы избежать проверки
<code>resolveip</code> в <code>mysql_install_db</code>. Оборотной стороной такого подхода
является невозможность работать с именами машин в таблицах прав
доступа - вместо них следует должны использовать IP-адреса (за
исключением <code>localhost</code>). Если у вас старая поставка MySQL,
которая не поддерживает ключ <code>--force</code>, то нужно просто удалить в редакторе
проверку <code>resolveip</code> из <code>mysql_install</code>.
<LI>

Запускать <code>mysqld</code> с помощью команды su вместо использования опции <code>--user</code>.
</ul>

<P>
RPM и бинарные файлы MySQL для Linux на архитектуре Intel оптимизированы
для достижения наибольшей возможной скорости работы. Мы всегда стараемся
использовать компиляторы, которые дают наиболее быстрый и устойчивый код.

</P>
<P>
Поддержка Perl в MySQL требует Perl версии не ниже 5.004_03.

</P>
<P>
На некоторых Linux версии 2.2 при попытке создать большое количество новых
соединений с сервером mysqld через TCP/IP вы можете получить сообщение об
ошибке <code>Resource temporarily unavailable</code> (Ресурс временно недоступен).

</P>
<P>
Проблема заключается в задержке между закрытием сокета TCP/IP и реальным
его освобождением системой в Linux. Поскольку существует ограниченное
количество областей для поддержки TCP/IP, вы получите вышеназванную
ошибку, если попытаетесь создать слишком много новых соединений TCP/IP на
протяжении короткого отрезка времени (нечто подобное происходит при
запуске теста на производительность MySQL <tt>`test-connect'</tt> поверх TCP/IP).

</P>
<P>
Об этой проблеме мы несколько раз сообщали в различные списки рассылки по
Linux, однако удачного решения получить не удалось.

</P>
<P>
Единственное известное 'решение' данной проблемы заключается в том, что
ваши клиенты должны работать с постоянными соединениями или использовать
сокеты (в случае, если клиентская и серверная части находятся на одной
машине). Остается надеяться, что эта проблема будет решена в ядре Linux
2.4.

</P>


<H4><A NAME="Linux-x86" HREF="manual.ru_toc.html#Linux-x86">2.6.1.2  Заметки по поводу Linux x86</A></H4>

<P>
Для MySQL необходимо наличие <code>libc</code> версии 5.4.12 или выше. Известно, что
MySQL работает с <code>libc</code> 5.4.46, а также с <code>glibc</code> версии 2.0.6 и более новыми.
Существуют некоторые проблемы с <code>glibc</code> из пакетов в RedHat, поэтому в
случае возникновения проблем следует проверить, нет ли обновлений данной
версии! Известно, что <code>glibc</code> из RPM версий 2.0.7-19 и 2.0.7-29
работоспособны.

</P>
<P>
Если вы используете Red Hat 8.0 или новую glibc 2.2.x вам следует запускать
mysqld с опцией <code>--thread-stack=192K</code>. Если вы этого не сделаете, то
mysqld будет умирать в <code>gethostbyaddr()</code> потому что новая glibc требует &#62;
128Кбайт памяти стека для этого вызова.  Такой размер стека установлен по
умолчанию в MySQL 4.0.10 и более новых. 

</P>
<P>
При использовании для сборки MySQL gcc 3.0 и выше библиотеку libstdc++v3
необходимо установить до сборки; если вы не сделаете этого, то получите
сообщение об отсутствии символа <code>__cxa_pure_virtual</code> во время линкования!

</P>
<P>
На некоторых старых версиях Linux <code>configure</code> может приводить к ошибкам
такого типа:

</P>

<pre>
Syntax error in sched.h. Change _P to __P in the /usr/include/sched.h file.
See the Installation chapter in the Reference Manual.
</pre>

<P>
Сделайте именно то, о чем говорится в сообщении об ошибке - добавьте дополнительный символ подчеркивания к имени макроса <code>_P</code>, которое имеет
только один символ подчеркивания в начале, и попробуйте выполнить те же
действия еще раз.

</P>
<P>
При компиляции могут выводиться некоторые предупреждения. Ниже приведены
те из них, которые можно проигнорировать:

</P>

<pre>
mysqld.cc -o objs-thread/mysqld.o
mysqld.cc: In function `void init_signals()':
mysqld.cc:315: warning: assignment of negative value `-1' to `long unsigned int'
mysqld.cc: In function `void * signal_hand(void *)':
mysqld.cc:346: warning: assignment of negative value `-1' to `long unsigned int'
</pre>

<P>
<code>mysql.server</code> находится либо в каталоге <tt>`share/mysql'</tt> каталога инсталляции MySQL, либо в каталоге <tt>`support-files'</tt> каталога дерева исходных текстов
MySQL.

</P>
<P>
Возникновение следующей ошибки при линковании <code>mysqld</code> говорит о
некорректной установке <code>libg++.a</code>:

</P>

<pre>
/usr/lib/libc.a(putc.o): In function `_IO_putc':
putc.o(.text+0x0): multiple definition of `_IO_putc'
</pre>

<P>
Использования <code>libg++.a</code> можно избежать путем запуска <code>configure</code> следующим
образом:

</P>

<pre>
shell&#62; CXX=gcc ./configure
</pre>



<H4><A NAME="Linux-SPARC" HREF="manual.ru_toc.html#Linux-SPARC">2.6.1.3  Примечания к Linux SPARC</A></H4>

<P>
В некоторых версиях Linux SPARC испорчена функция <code>readdir_r()</code>. Это
проявляется в том, что <code>SHOW DATABASES</code> всегда возвращает пустой набор.
Проблема может быть решена удалением <code>HAVE_READDIR_R</code> из <tt>`config.h'</tt> - это
нужно делать после конфигурирования, но до компиляции.

</P>
<P>
Для решения некоторых проблем необходимо добавить патч к своей установке
Linux. Патч находится по адресу
<a HREF="http://www.mysql.com/Downloads/patches/Linux-sparc-2.0.30.diff">http://www.mysql.com/Downloads/patches/Linux-sparc-2.0.30.diff</a>. Этот патч
применим к дистрибутиву Linux <tt>`sparclinux-2.0.30.tar.gz'</tt>, который находится
на <code>vger.rutgers.edu</code> (версия Linux, которая никогда не сливалась с
официальной 2.0.30). Также необходимо установить LinuxThreads версии 0.6
или выше.

</P>


<H4><A NAME="Linux-Alpha" HREF="manual.ru_toc.html#Linux-Alpha">2.6.1.4  Примечания к Linux Alpha</A></H4>

<P>
MySQL версии 3.23.12 - первая версия MySQL, протестированная на
Linux-Alpha. Поэтому если вы собираетесь использовать MySQL на
Linux-Alpha, следует прежде всего убедиться, что вы используете либо эту
версию, либо более свежую.

</P>
<P>
Мы тестировали MySQL на Alpha при помощи наших тестов на
производительность и все работает превосходно. 

</P>
<P>
При компиляции стандартных бинарных файлов MySQL мы использовали SuSE
7.0 для AXP с ядром 2.4.4-SMP, компилятор Compaq C (6.2-505) и компилятор Compaq
C++ (6.3-006) на компьютере Compaq DS20 с процессором Alpha EV6.

</P>
<P>
Вышеупомянутый компилятор можно найти на
<a HREF="http://www.support.compaq.com/alpha-tools/">http://www.support.compaq.com/alpha-tools/</a>. Использование этого
компилятора вместо gcc привело к улучшению производительности MySQL на
9-14%.

</P>
<P>
Отметим, что до версии MySQL 3.23.52 и 4.0.2 мы оптимизировали исполняемые файлы
только для единственной модели процессора (используя опцию компиляции <code>-fast</code>); это означало 
что вы можете использовать наши двоичные файлы только если у вас процессор Alpha EV6. 

</P>
<P>
Для всех следующих версий мы добавили флаг <code>-arch generic</code> к нашим опциям 
компиляции, что позволяет работать бинарному файлу на всех процессорах Alpha. 
Мы также собираем MySQL статически - во избежание проблем. 

</P>

<pre>
CC=ccc CFLAGS="-fast -arch generic" CXX=cxx \
CXXFLAGS="-fast -arch generic -noexceptions -nortti" \
./configure --prefix=/usr/local/mysql --disable-shared \
--with-extra-charsets=complex --enable-thread-safe-client \
--with-mysqld-ldflags=-non_shared --with-client-ldflags=-non_shared
</pre>

<P>
Если вы хотите использовать <code>egcs</code>, то у нас применялась следующая командная
строка конфигурирования:

</P>

<pre>
CFLAGS="-O3 -fomit-frame-pointer" CXX=gcc \
CXXFLAGS="-O3 -fomit-frame-pointer -felide-constructors \
-fno-exceptions -fno-rtti" ./configure --prefix=/usr/local/mysql \
--disable-shared
</pre>

<P>
Некоторые известные проблемы при запуске MySQL на Linux-Alpha:

</P>

<ul>
<LI>

отладка потоковых приложений, подобных MySQL, не работает с <code>gdb 4.18</code>.
Вместо него необходимо установить и использовать gdb 5.1!

<LI>

при попытке статического линкования <code>mysqld</code> с использованием <code>gcc</code>
результирующий файл при попытке запуска сбрасывает образ памяти на
диск (core dump) и умирает. Иными словами, не следует использовать с
<code>gcc</code> опцию <code>--with-mysqld-ldflags=-all-static</code>.
</ul>



<H4><A NAME="Linux-PowerPC" HREF="manual.ru_toc.html#Linux-PowerPC">2.6.1.5  Примечания к Linux PowerPC</A></H4>

<P>
MySQL должен работать на MkLinux при наличии самого свежего пакета <code>glibc</code>
(проверено с <code>glibc</code> 2.0.7).

</P>


<H4><A NAME="Linux-MIPS" HREF="manual.ru_toc.html#Linux-MIPS">2.6.1.6  Примечания к Linux MIPS</A></H4>

<P>
Для того чтобы MySQL работал на Qube2 (Linux Mips), необходима самая
свежая версия библиотеки <code>glibc</code> (известно, что MySQL работает с
<code>glibc-2.0.7-29C2</code>). Помимо этого, следует использовать компилятор <code>egcs</code> C++
(<code>egcs-1.0.2-9</code>, <code>gcc 2.95.2</code> или выше).

</P>


<H4><A NAME="Linux-IA64" HREF="manual.ru_toc.html#Linux-IA64">2.6.1.7  Примечания к Linux IA64</A></H4>

<P>
Для компиляции MySQL на Linux IA64 мы применяем следующую команду

</P>
<P>
конфигурирования: используется <code>gcc-2.96</code>:

</P>

<pre>
CC=gcc CFLAGS="-O3 -fno-omit-frame-pointer" CXX=gcc \
CXXFLAGS="-O3 -fno-omit-frame-pointer -felide-constructors \
-fno-exceptions -fno-rtti" ./configure --prefix=/usr/local/mysql \
"--with-comment=Official MySQL binary" --with-extra-charsets=complex
</pre>

<P>
На IA64 бинарные файлы MySQL-клиента используют динамические библиотеки.
Это значит, что при установке нашего бинарного дистрибутива куда-либо,
кроме <tt>`/usr/local/mysql'</tt>, необходимо либо модифицировать <tt>`/etc/ld.so.conf'</tt>,
либо добавить путь к каталогу, в котором находится <tt>`libmysqlclient.so'</tt>, к
переменной окружения <code>LD_LIBRARY_PATH</code>.

</P>
<P>
See section <A HREF="manual.ru_Problems.html#Link_errors">A.3.1  Проблемы при линковании с клиентской библиотекой MySQL</A>.

</P>


<H3><A NAME="Windows" HREF="manual.ru_toc.html#Windows">2.6.2  Примечания к Windows</A></H3>

<P>
В данном разделе описывается использование MySQL в среде Windows. Эта
информация также находится в файле <tt>`README'</tt>, поставляемом с дистрибутивом
MySQL Windows. See section <A HREF="manual.ru_Installing.html#Windows_installation">2.1.2  Установка MySQL на Windows</A>.

</P>



<H4><A NAME="Win95_start" HREF="manual.ru_toc.html#Win95_start">2.6.2.1  Запуск MySQL на Windows 95, 98 или Me</A></H4>

<P>
В MySQL для соединения клиента с сервером используется TCP/IP (это
обеспечивает для любого компьютера в сети возможность соединиться с вашим
MySQL-сервером). Поэтому TCP/IP необходимо установить на машине до запуска
MySQL. TCP/IP, в частности, имеется на CD-диске с дистрибутивом Windows.

</P>
<P>
Обратите внимание: если вы используете один из старых выпусков Windows 95
(например OSR2), то вполне вероятно, что у вас установлен старый пакет
Winsock; а для работы MySQL необходим Winsock 2! Самую свежую версию
Winsock можно получить по адресу http://www.microsoft.com/. Windows 98
содержит новую библиотеку Winsock 2, поэтому данное замечание к ней не
относится.

</P>
<P>
Для запуска <code>mysqld</code> необходимо открыть окно MS-DOS и выполнить:

</P>

<pre>
C:\&#62; C:\mysql\bin\mysqld
</pre>

<P>
Это позволит запустить <code>mysqld</code> в фоновом режиме без окна.

</P>
<P>
Работу MySQL-сервера можно остановить командой:

</P>

<pre>
C:\&#62; C:\mysql\bin\mysqladmin -u root shutdown
</pre>

<P>
Это вызов программы администрирования MySQL от имени пользователя <code>root</code>,
который по умолчанию соответствует пользователю <code>Administrator</code> в системе
привилегий MySQL. Обратите внимание: система привилегий MySQL абсолютно
независима от каких-либо аккаунтов пользователей в среде Windows.

</P>
<P>
Заметим, что в Windows 95/98/Me не поддерживается создание именованных
каналов. Таким образом, именованные каналы вы можете использовать для
соединения с MySQL-сервером, работающем в системе Windows NT/2000/XP.
(Разумеется, MySQL-сервер также должен поддерживать именованные каналы.
Например, при работе <code>mysqld-opt</code> в системе NT/2000/XP нельзя создавать
соединения с использованием именованных каналов; следует применять либо
<code>mysqld-nt</code>, либо <code>mysqld-max-nt</code>.)

</P>
<P>
Если <code>mysqld</code> не запускается, следует проверить файл <tt>`\mysql\data\mysql.err'</tt>,
на предмет записей, сделанных сервером, - они содержат объяснения причин,
вызвавших проблему. Можно также попробовать запустить сервер командой
<code>mysqld --standalone</code>; в этом случае на экран будет выводиться некоторая
полезная информация, которая может помочь решить проблему.

</P>
<P>
В качестве последней попытки можно попробовать запустить <code>mysqld</code> с флагами
<code>--standalone --debug</code>. В этом случае <code>mysqld</code> будет помещать записи в файл
отладки <tt>`C:\mysqld.trace'</tt>. Возможно, по содержимому этого файла вы сумеете
определить причину, по которой  не запускается <code>mysqld</code>. 
See section <A HREF="manual.ru_Porting.html#Making_trace_files">E.1.2  Создание трассировочных файлов</A>.

</P>
<P>
Для вывода всех флагов, которые ``понимает'' <code>mysqld</code>, используйте команду
<code>mysqld --help</code>.

</P>


<H4><A NAME="NT_start" HREF="manual.ru_toc.html#NT_start">2.6.2.2  Запуск MySQL на Windows NT, 2000 или XP</A></H4>

<P>
Для того чтобы MySQL работал с TCP/IP на Windows NT 4, необходимо
установить Service Pack 3 (или выше)!

</P>
<P>
Обычно MySQL устанавливается на Windows NT/2000/XP как сервис. В случае,
если сервер уже работает, необходимо сначала завершить его работу при
помощи следующей команды:

</P>

<pre>
C:\mysql\bin&#62; mysqladmin -u root shutdown
</pre>

<P>
Это вызов программы администрирования MySQL от имени пользователя <code>root</code>,
который по умолчанию соответствует пользователю <code>Administrator</code> в системе
привилегий MySQL. Обратите внимание: система привилегий MySQL абсолютно
независима от каких-либо аккаунтов пользователей в системе Windows.

</P>
<P>
Теперь установим сервис сервера:

</P>

<pre>
C:\mysql\bin&#62; mysqld-max-nt --install
</pre>

<P>
Если требуются какие-либо опции, они должны быть определены, как ``<code>Start
parameters</code>'' в инструментальной программе <code>Services</code> системы Windows перед
запуском сервиса MySQL.

</P>
<P>
Доступ к инструментальной программе <code>Services</code> (<code>Windows Service Control
Manager</code>) можно получить в <code>Control Panel</code> (в <code>Administrative Tools</code> в Windows
2000). Рекомендуется закрывать <code>Services</code> при выполнении операций <code>--instal</code> 
или <code>--remove</code> - это предотвратит возникновение некоторых ошибок неизвестной
природы.

</P>
<P>
За информацией о том, какие бинарные файлы следует использовать для
запуска сервера, обращайтесь к разделу See section <A HREF="manual.ru_Installing.html#Windows_prepare_environment">2.1.2.2  Подготовка конфигурации MySQL для Windows</A>.

</P>
<P>
Отметим, что начиная с версии 3.23.44 MySQL имеется возможность
альтернативной установки сервиса - в режиме <code>Manual</code> (если вам не требуется
автоматический запуск сервиса при загрузке операционной системы):

</P>

<pre>
C:\mysql\bin&#62; mysqld-max-nt --install-manual
</pre>

<P>
Сервис устанавливается под именем MySQL. Сразу же после установки он может
быть запущен при помощи инструментальной программы <code>Services</code> или командой
<code>NET START MySQL</code>.

</P>
<P>
После запуска работа <code>mysqld-max-nt</code> может быть завершена при помощи
mysqladmin из инструментальной программы <code>Services</code> или командой <code>NET STOP
MySQL</code>.

</P>
<P>
Если MySQL функционирует в качестве сервиса, то операционная система
автоматически завершает работу <code>MySQL</code>-сервиса при программном завершении
работы компьютера. В версиях MySQL &#60; 3.23.47 Windows ожидает всего лишь
несколько секунд завершения остановки, после чего уничтожает процесс
сервера базы данных, если превышено время ожидания (что может быть
потенциальной причиной возникновения проблем). Например, при следующем
запуске обработчик таблицы <code>InnoDB</code> должен выполнять восстановление после
аварийного завершения. Начиная с MySQL версии 3.23.48, Windows ожидает
завершения процесса MySQL-сервера дольше. Если вы считаете, что этого
времени для вашей версии недостаточно, безопаснее запускать MySQL-сервер
не как сервис, а из командной строки и завершать его работу командой
<code>mysqladmin shutdown</code>.

</P>
<P>
В Windows NT (но не в Windows 2000/XP) существует проблема, которая
заключается в том, что система по умолчанию ожидает окончания работы
сервиса только 20 секунд, после чего уничтожает процесс сервиса. Это
заданное по умолчанию значение можно увеличить с помощью редактора
Registry (Реестра), запустив <tt>`\winnt\system32\regedt32.exe'</tt> и отредактировав
значение <code>WaitToKillServiceTimeout</code> в записи
<code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control</code>. Следует задать
другое, большее значение в миллисекундах, например 120000, чтобы Windows
NT ожидала 120 секунд.

</P>
<P>
Необходимо заметить, что при работе в качестве сервиса <code>mysqld-max-nt</code> не
имеет доступа к консоли, а следовательно, невозможно увидеть его
сообщения. Информация об ошибках находится в файле
<tt>`c:\mysql\data\mysql.err'</tt>.

</P>
<P>
Если вы столкнулись с проблемами установки <code>mysqld-max-nt</code> в качестве
сервиса, попробуйте запустить его с указанием полного пути:

</P>

<pre>
C:\&#62; C:\mysql\bin\mysqld-max-nt --install
</pre>

<P>
Если это не поможет, можно принудить <code>mysqld-max-nt</code> стартовать
соответствующим образом, исправив путь в Registry!

</P>
<P>
Если вы не хотите запускать <code>mysqld-max-nt</code> в качестве сервиса, его можно
запустить следующим образом:

</P>

<pre>
C:\&#62; C:\mysql\bin\mysqld-max-nt --standalone
или
C:\&#62; C:\mysql\bin\mysqld --standalone --debug
</pre>

<P>
В случае последнего варианта вы получите отладочную информацию в
<tt>`C:\mysqld.trace'</tt>. See section <A HREF="manual.ru_Porting.html#Making_trace_files">E.1.2  Создание трассировочных файлов</A>.

</P>


<H4><A NAME="Windows_running" HREF="manual.ru_toc.html#Windows_running">2.6.2.3  Работа MySQL в среде Windows</A></H4>

<P>
<A NAME="IDX330"></A>
<A NAME="IDX331"></A>

</P>
<P>
MySQL поддерживает TCP/IP на всех Windows-системах и именованные каналы в
среде NT/2000/XP. По умолчанию MySQL использует именованные каналы для
соединений с локальной машиной в среде NT/2000/XP и TCP/IP - во всех
остальных случаях, если на клиентской машине установлен TCP/IP. Имя машины
определяет используемый протокол:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><strong>Имя машины</strong> </TD><TD> <strong>Протокол</strong>
</TD></TR>
<TR><TD>NULL(отсутствует) </TD><TD>
На NT/2000/XP пытается установить соединение через именованные каналы; если это не работает, используется TCP/IP. На 9x/Me используется TCP/IP.
</TD></TR>
<TR><TD>. </TD><TD> Именованные каналы.
</TD></TR>
<TR><TD>localhost </TD><TD> Соединение TCP/IP с локальной машиной
</TD></TR>
<TR><TD>имя удаленной машины </TD><TD> TCP/IP
</TD></TR>
</TABLE>

<P>
Чтобы заставить MySQL-клиента использовать именованные каналы, следует
добавить опцию <code>--pipe</code> или задать <code>.</code> в качестве имени машины для
соединения. Для определения имени канала используйте опцию <code>--socket</code>.
В MySQL 4.1  вам следует использовать опцию <code>--protocol=PIPE</code>.

</P>
<P>
Отметим, что начиная с версии 3.23.50 именованные каналы применяются
только в случае, если <code>mysqld</code> запущен с опцией <code>--enable-named-pipe</code>. Это
вызвано тем, что у некоторых пользователей применение именованных каналов
приводило к прекращению работы сервера MySQL.

</P>
<P>
Для проверки работоспособности MySQL нужно выполнить следующие команды:

</P>

<pre>
C:\&#62; C:\mysql\bin\mysqlshow
C:\&#62; C:\mysql\bin\mysqlshow -u root mysql
C:\&#62; C:\mysql\bin\mysqladmin version status proc
C:\&#62; C:\mysql\bin\mysql test
</pre>

<P>
Если при ответе <code>mysqld</code> на входящие соединения под Windows 9x/Me возникают
задержки, то это, скорее всего, вызвано проблемами с вашим DNS. В таком
случае следует запускать mysqld с опцией <code>--skip-name-resolve</code> и в таблицах
привилегий MySQL использовать только <code>localhost</code> и IP-адреса. Избежать
работы с DNS при соединении с MySQL-сервером <code>mysqld-nt</code>, работающим под
NT/2000/XP, можно путем применения опции <code>--pipe</code>, которая задает
использование именованных каналов. Сказанное выше справедливо для
большинства клиентов MySQL.

</P>
<P>
Существует две версии программы работы с MySQL из командной строки:

</P>
<TABLE BORDER WIDTH="100%">
<TR><TD><strong>Бинарный файл</strong> </TD><TD> <strong>Описание</strong>
</TD></TR>
<TR><TD><code>mysql</code> </TD><TD> Собран ``родными'' средствами Windows, обеспечивает весьма ограниченные возможности редактирования текста.
</TD></TR>
<TR><TD><code>mysqlc</code> </TD><TD> Собран с использованием компилятора и библиотек Cygnus GNU, которые обеспечивают редактор <code>readline</code>.
</TD></TR>
</TABLE>

<P>
Если вы хотите использовать <tt>`mysqlc.exe'</tt>, сначала необходимо скопировать
<tt>`C:\mysql\lib\cygwinb19.dll'</tt> в системный каталог Windows (<tt>`\windows\system'</tt> 
или в другое аналогичное место).

</P>
<P>
По умолчанию всем пользователям Windows предоставляются полные права
доступа ко всем базам данных без ввода пароля. Чтобы обеспечить большую
безопасность MySQL, необходимо задать пароль для каждого пользователя и
удалить запись в таблице <code>mysql.user</code>, содержащую <code>Host='localhost'</code> и <code>User='
`</code>.

</P>
<P>
Необходимо также установить пароль для пользователя <code>root</code>. Приведенный ниже
пример начинается с удаления возможности анонимного доступа, который может
быть использован любым пользователем для установки пароля для пользователя 
<code>root</code>:

</P>

<pre>
C:\&#62; C:\mysql\bin\mysql mysql
mysql&#62; DELETE FROM user WHERE Host='localhost' AND User=' ';
mysql&#62; QUIT
C:\&#62; C:\mysql\bin\mysqladmin reload
C:\&#62; C:\mysql\bin\mysqladmin -u root password your_password
</pre>

<P>
Если вы хотите остановить сервер <code>mysqld</code> после того, как установлен пароль
для пользователя <code>root</code>, нужно использовать команду:

</P>

<pre>
C:\&#62; mysqladmin --user=root --password=your_password shutdown
</pre>

<P>
Если у вас работает старая испытательная версия MySQL 3.21 под Windows,
вышеприведенная команда не выполнится и приведет к сообщению об ошибке:
<code>parse error near `SET password'</code>. Для решения этой проблемы следует
выполнить загрузку и обновление до последней доступной бесплатно версии
MySQL.

</P>
<P>
В текущей версии MySQL вы можете легко добавлять новых пользователей и
изменять их привилегии при помощи команд <code>GRANT</code> и <code>REVOKE</code> (see section <A HREF="manual.ru_MySQL_Database_Administration.html#GRANT">4.3.1  Синтаксис команд <code>GRANT</code> и <code>REVOKE</code></A>).

</P>


<H4><A NAME="Windows_and_SSH" HREF="manual.ru_toc.html#Windows_and_SSH">2.6.2.4  Соединение с MySQL на удаленной машине под Windows с использованием SSH</A></H4>

<P>
<A NAME="IDX332"></A>
<A NAME="IDX333"></A>

</P>
<P>
В этом разделе приведены замечания относительно получения безопасного
соединения с удаленным MySQL-сервером с использованием SSH. Автором этих
замечаний является Дэвид Карлсон (David Carlson) - <a HREF="mailto:dcarlson@mplcomm.com">dcarlson@mplcomm.com</a>:

</P>

<ul>
<LI>

Установите SSH-клиент на своей Windows-системе. С точки зрения
пользователя, лучшим небесплатным клиентом из числа мне известных является
клиент <code>SecureCRT</code> по адресу <a HREF="http://www.vandyke.com/">http://www.vandyke.com/</a>. Другой возможный
вариант - <code>f-secure</code> от <a HREF="http://www.f-secure.com/">http://www.f-secure.com/</a>. Есть и бесплатные версии -
их можно получить на <code>Google</code> по адресу
<a HREF="http://directory.google.com/Top/Computers/Security/Products_and_Tools/CryptographySSH/Clients/Windows/">http://directory.google.com/Top/Computers/Security/Products_and_Tools/CryptographySSH/Clients/Windows/</a> 

<LI>

Запустите Windows-клиент SSH. Установите
<code>Host_Name=адрес_своего_MySQL-сервера</code>. Задайте <code>userid=свой_userid</code> для
соединения со своим сервером (может отличатся от вашего имени
пользователя/пароля для MySQL).

<LI>

Задайте перенаправление портов или организуйте удаленный форвардинг
(нужно сделать следующие установки: <code>локальный порт - 3306</code>, <code>удаленный хост
- адреса_вашего_mysql_сервера</code>, <code>удаленный порт - 3306</code>) либо локальный
форвардинг (<code>порт - 3306</code>, <code>хост - localhost</code>, <code>удаленный порт - 3306</code>).

<LI>

Сохраните выполненные установки, иначе вам придется в следующий раз
делать все заново.

<LI>

Соединитесь со своим сервером, используя только что созданный вами
SSH-сеанс.

<LI>

Запустите в Windows какое-либо ODBC-приложение (например Access).

<LI>

Создайте в Windows новый файл и ссылку на MySQL, используя ODBC-драйвер
обычным образом, за исключением того, что вместо имени вашего
MySQL-сервера следует указывать <code>localhost</code>, а не <code>yourmysqlservername</code>.
</ul>

<P>
В результате этих действий вы должны получить ODBC-соединение со своим
MySQL-сервером, защищенное при помощи SSH-кодирования.

</P>


<H4><A NAME="Windows_symbolic_links" HREF="manual.ru_toc.html#Windows_symbolic_links">2.6.2.5  Распределение данных в Windows между несколькими различными дисками</A></H4>

<P>
<A NAME="IDX334"></A>
<A NAME="IDX335"></A>
<A NAME="IDX336"></A>

</P>
<P>
Начиная с MySQL версии 3.23.16 серверы <code>mysqld-max</code> и <code>mysql-max-nt</code> в
дистрибутиве MySQL компилируются с флагом <code>-DUSE_SYMDIR</code>. Это обеспечивает
возможность устанавливать базу данных на другом диске путем добавления
символической ссылки на нее (подобно тому, как работают символические
ссылки в Unix).

</P>
<P>
В Windows для создания символической ссылки на базу данных создается файл,
содержащий путь к каталогу, на который указывает ссылка. Этот файл
сохраняется в каталоге <tt>`mysql_data'</tt> под именем <tt>`database.sym'</tt>. Отметим, что
такая символическая ссылка будет работать только в случае отсутствия
каталога <tt>`mysql_data_dir\database'</tt>.

</P>
<P>
Например, если каталог данных MySQL находится в <tt>`C:\mysql\data'</tt>, а вы хотите
разместить базу данных <code>foo</code> в каталоге <tt>`D:\data\foo'</tt>, необходимо создать файл
<tt>`C:\mysql\data\foo.sym'</tt>, содержащий текст <tt>`D:\data\foo\'</tt>. После этого все
таблицы, создаваемые в базе данных <code>foo</code>, будут создаваться в <tt>`D:\data\foo'</tt>.

</P>
<P>
Отметим, что из-за потерь в скорости при открытии каждой таблицы в MySQL
не включается использование символических ссылок по умолчанию, даже если
вы собрали MySQL с поддержкой данной возможности. Чтобы обеспечить
возможность разрешения символических ссылок, вы должны поместить в свой
файл <tt>`my.cnf'</tt> или <tt>`my.ini'</tt> следующие строки:

</P>

<pre>
[mysqld]
use-symbolic-links
</pre>

<P>
В MySQL 4.0 использование символических ссылок по умолчанию будет
включено. Если вы хотите запретить эту возможность, то для данной версии
MySQL необходимо использовать опцию <code>skip-symlink</code>.

</P>


<H4><A NAME="Windows_client_compiling" HREF="manual.ru_toc.html#Windows_client_compiling">2.6.2.6  Компиляция MySQL-клиентов в среде Windows</A></H4>

<P>
<A NAME="IDX337"></A>
<A NAME="IDX338"></A>

</P>
<P>
В файлах исходных текстов следует перед <tt>`mysql.h'</tt> включить <tt>`windows.h'</tt>:

</P>

<pre>
#if defined(_WIN32) || defined(_WIN64)
#include &#60;windows.h&#62;
#endif
#include &#60;mysql.h&#62;
</pre>

<P>
Линковать свою программу можно либо с использованием динамической
библиотеки <tt>`libmysql.lib'</tt>, которая является просто оболочкой для загрузки
<tt>`libmysql.dll'</tt> по требованию, либо со статической библиотекой
<tt>`mysqlclient.lib'</tt>.

</P>
<P>
Отметим, что поскольку библиотеки <code>mysqlclient</code> компилируются как потоковые
библиотеки, следует скомпилировать вашу программу так, чтобы была
разрешена многопочность!

</P>


<H4><A NAME="Windows_vs_Unix" HREF="manual.ru_toc.html#Windows_vs_Unix">2.6.2.7  Сравнительные характеристики MySQL под Windows и под Unix</A></H4>

<P>
<A NAME="IDX339"></A>
<A NAME="IDX340"></A>

</P>
<P>
На настоящий момент версия MySQL под Windows зарекомендовала себя как
весьма устойчивая. Возможности этой версии и версии под Unix аналогичны,
за исключением следующих моментов:

</P>
<DL COMPACT>

<DT><strong>Windows 95 и потоки</strong>
<DD>
При создании каждого потока в Windows 95 теряется приблизительно 200
байтов основной памяти. А поскольку каждое соединение с MySQL создает
новый поток, на Windows 95 не следует запускать <code>mysqld</code> на продолжительное
время, если ваш сервер обрабатывает много соединений! Другие версии
Windows не подвержены этой ошибке.

<DT><strong>Параллельное чтение</strong>
<DD>
Для обработки смешанных запросов <code>SELECT</code> и <code>INSERT</code> в MySQL используются
функции <code>pread()</code> и <code>pwrite()</code>. В настоящее время для эмуляции
<code>pread()</code>/<code>pwrite()</code> мы применяем mutex'ы. Однако в наши планы на будущее
входит замена интерфейса файлового уровня виртуальным интерфейсом, чтобы
иметь возможность использовать интерфейс <code>readfile()</code>/<code>writefile()</code> на
NT/2000/XP - с целью ускорения работы. В текущей реализации число
одновременно открытых в MySQL файлов не может быть больше 1024; это
означает, что вы не сможете создать такое же количество одновременных
соединений с MySQL в NT/2000/XP, как в Unix.

<DT><strong>Чтение с блокировкой</strong>
<DD>
В MySQL для каждого соединения используется чтение с блокировкой. Это
означает, что:


<ul>
<LI>

Соединение не будет автоматически закрыто по истечении 8 часов, как в
случае Unix-версии MySQL.

<LI>

В случае ``зависания'' соединения невозможно оборвать его без остановки
MySQL.

<LI>

<code>mysqladmin kill</code> не работает для ``спящих'' соединений

<LI>

<code>mysqladmin shutdown</code> не может отработать до тех пор, пока существуют
``спящие'' соединения.
</ul>

Перечисленные проблемы мы планируем решить, когда наши разработчики под
Windows придумают изящный способ их решения.

<DT><strong>DROP DATABASE</strong>
<DD>
Нельзя удалить базу данных, если она используется каким-либо потоком.

<DT><strong>Остановка MySQL из диспетчера задач</strong>
<DD>
В Windows 95 нельзя остановить MySQL из диспетчера задач или с помощью
инструментальной программы <code>shutdown</code>; это можно сделать с помощью
<code>mysqladmin shutdown</code>.

<DT><strong>Имена, не зависящие от регистра символов</strong>
<DD>
Имена файлов в Windows не зависят от регистра символов, поэтому имена
таблиц и баз данных в MySQL под Windows также не зависимы от регистра.
Единственное ограничение заключается в том, что имена баз данных и таблиц
в пределах одного выражения должны задаваться с использованием одинакового
регистра символов (see section <A HREF="manual.ru_Reference.html#Name_case_sensitivity">6.1.3  Чувствительность имен к регистру</A>).

<DT><strong>Символ каталогов <samp>`\'</samp></strong>
<DD>
Компоненты путей в Windows 95 разделяются символом <samp>`\'</samp>, который также
является символом экранирования в MySQL. Если вы используете <code>LOAD DATA
INFILE</code> или <code>SELECT ... INTO OUTFILE</code>, символ <samp>`\'</samp> необходимо вводить дважды:


<pre>
mysql&#62; LOAD DATA INFILE "C:\\tmp\\skr.txt" INTO TABLE skr;
mysql&#62; SELECT * INTO OUTFILE 'C:\\tmp\\skr.txt' FROM skr;
</pre>

В качестве альтернативы можно использовать имена файлов Unix-стиля:


<pre>
mysql&#62; LOAD DATA INFILE "C:/tmp/skr.txt" INTO TABLE skr;
mysql&#62; SELECT * INTO OUTFILE 'C:/tmp/skr.txt' FROM skr;
</pre>

<DT><strong>Ошибка <code>can't open named pipe</code> (невозможно открыть именованный канал)</strong>
<DD>
При использовании MySQL версии 3.22 на NT с самым свежим клиентом <code>mysql</code>
можно получить следующее сообщение об ошибке:


<pre>
error 2017: can't open named pipe to host: . pipe...
</pre>

<A NAME="IDX341"></A>
Это происходит из-за того, что в данной версии MySQL на NT именованные
каналы применяются по умолчанию. Чтобы избежать таких ошибок, следует
использовать с новым клиентом MySQL флаг <code>--host=localhost</code> или создать файл
флагов <tt>`C:\my.cnf'</tt>, содержащий следующие строки:


<pre>
[client]
host = localhost
</pre>

Начиная с версии 3.23.50 именованные каналы используются только в случае,
если <code>mysqld</code> запущен с флагом <code>--enable-named-pipe</code>.

<DT><strong>Ошибка <code>access denied for user</code> (доступ пользователю запрещен)</strong>
<DD>
Если вы получили сообщение об ошибке <code>Access denied for user:
`some-user@unknown' to database `mysql'</code> при попытке доступа к
MySQL-серверу, находящемуся на той же машине, с которой происходит доступ,
это значит, что MySQL не может правильно определить адрес вашей машины.
Для решения данной проблемы следует создать файл <tt>`\windows\hosts'</tt>,
содержащий:


<pre>
127.0.0.1 localhost
</pre>

<DT><strong><code>ALTER TABLE</code></strong>
<DD>
При выполнении оператора <code>ALTER TABLE</code> доступ к таблице для других потоков
блокируется. Именно поэтому Windows не может удалить файл, который
используется другим потоком (возможно, в будущем мы найдем какой-нибудь
способ обойти эту проблему). Выполнение <code>DROP TABLE</code> над таблицей, входящей
в состав сводной таблицы <code>MERGE</code>, не будет работать в Windows, так как
отображение таблицы, которое выполняет обработчик <code>MERGE</code>, скрыто от
верхнего уровня MySQL. Поскольку в Windows нельзя удалять открытые файлы,
вначале следует сбросить все <code>MERGE</code>-таблицы (используя <code>FLUSH TABLES</code>) или
удалить все <code>MERGE</code>-таблицы перед удалением таблицы. Мы исправим эту ошибку
одновременно с введением оператора <code>VIEW</code>. Операторы <code>DATA DIRECTORY</code> и <code>INDEX
DIRECTORY</code> в <code>CREATE TABLE</code> в Windows игнорируются, поскольку Windows не
поддерживает символические ссылки.
</DL>

<P>
Ниже приведены некоторые открытые вопросы для всех, кто захочет помочь нам в работе над выпусками под Windows:

</P>
<P>
<A NAME="IDX342"></A>

</P>

<ul>
<LI>

Требуется создать однопользовательский сервер <tt>`MYSQL.DLL'</tt>. Он должен
включать все возможности стандартного MySQL-сервера, за исключением
потоков. Это заметно упростит использование MySQL в приложениях, которые
не нуждаются в настоящем клиент-серверном взаимодействии и в доступе к
базе с других машин.
<LI>

Нужно было бы добавить в инсталляционный пакет нескольких симпатичных
иконок для старта и остановки MySQL.
<LI>

При регистрации <code>mysqld</code> в качестве сервиса с флагом <code>--install</code> (на NT)
было бы неплохо иметь возможность добавлять флаги по умолчанию к командной
строке. Сейчас эта проблема решается путем записи списка параметров в файл
<tt>`C:\my.cnf'</tt>.
<LI>

Было бы удобно останавливать <code>mysqld</code> из диспетчера задач. Сейчас для
этого нужно применять <code>mysqladmin shutdown</code>.
<LI>

Требуется перенести <code>readline</code> в Windows для использования с
инструментальной программой, запускаемой из командной строки <code>mysql</code>.
<LI>

GUI версия стандартных MySQL-клиентов (<code>mysql</code>, <code>mysqlshow</code>, <code>mysqladmin</code> и
<code>mysqldump</code>) будет очень полезна.
<LI>

Было бы хорошо, если бы чтение и запись сокетов из <tt>`net.c'</tt> можно было бы
прерывать. Это позволило бы останавливать открытые потоки командой
<code>mysqladmin kill</code> в Windows.
<LI>

<code>mysqld</code> всегда стартует в местоположении "C", а не в местоположении,
установленном по умолчанию. С благодарностью будет принято исправление,
позволяющее использование программой <code>mysqld</code> текущего значения
местоположения для порядка сортировки.
<LI>

Требуется добавить макрос для ускорения безопасного для потоков метода
инкремента/декремента, обеспечиваемого Windows.
<LI>

Остальные, специфические для Windows вопросы, можно найти в файле <code>README</code>,
который находится в поставке MySQL-Windows.
</ul>



<H3><A NAME="Solaris" HREF="manual.ru_toc.html#Solaris">2.6.3  Примечания к Solaris</A></H3>

<P>
<A NAME="IDX343"></A>
<A NAME="IDX344"></A>
<A NAME="IDX345"></A>
<A NAME="IDX346"></A>

</P>
<P>
В системе Solaris проблемы подстерегают вас еще до распаковки дистрибутива
MySQL! Программа tar в Solaris ``не умеет'' работать с длинными именами
файлов, поэтому при попытке распаковать MySQL вы можете увидеть сообщение
об ошибке, подобное следующему:

</P>

<pre>
x mysql-3.22.12-beta/bench/Results/ATIS-mysql_odbc-NT_4.0-cmp-db2,\
informix,ms-sql,mysql,oracle,solid,sybase, 0 bytes, 0 tape blocks
tar: directory checksum error
</pre>

<P>
В этом случае для распаковки дистрибутива необходимо использовать
GNU-версию программы <code>tar</code> (<code>gtar</code>). Скомпилированную версию данной программы
для Solaris можно загрузить с <a HREF="http://www.mysql.com/downloads/os-solaris.html">http://www.mysql.com/downloads/os-solaris.html</a>.

</P>
<P>
Собственные потоки Sun работают только начиная с версии Solaris 2.5. Для
версии 2.4 и более ранних MySQL автоматически использует MIT-pthreads (see section <A HREF="manual.ru_Installing.html#MIT-pthreads">2.3.6  Замечания по потокам MIT-pthreads</A>).

</P>
<P>
Следующее сообщение об ошибке конфигурации:

</P>

<pre>
checking for restartable system calls... configure: error can not run test
programs while cross compiling
</pre>

<P>
означает, что имели место какие-то ошибки в установке компилятора! В этом
случае необходимо обновить ваш компилятор до более свежей версии. Эту
проблему можно также решить, вставив в файл <tt>`config.cache'</tt> следующую строку:

</P>

<pre>
ac_cv_sys_restartable_syscalls=${ac_cv_sys_restartable_syscalls='no'}
</pre>

<P>
При использовании Solaris на SPARC мы рекомендуем компилятор <code>gcc</code> 2.95.2.
Его можно получить по адресу <a HREF="http://gcc.gnu.org/">http://gcc.gnu.org/</a>. Отметим, что <code>egcs</code> 1.1.1
и <code>gcc</code> 2.8.1 работают на SPARC ненадежно!

</P>
<P>
Рекомендуемая строка для <code>configure</code> при использовании <code>gcc</code> 2.95.2:

</P>

<pre>
CC=gcc CFLAGS="-O3" \
CXX=gcc CXXFLAGS="-O3 -felide-constructors -fno-exceptions -fno-rtti" \
./configure --prefix=/usr/local/mysql --with-low-memory --enable-assembler
</pre>

<P>
Если используется UltraSPARC, то при добавлении строки "-mcpu=v8
-Wa,-xarch=v8plusa" к переменным CFLAGS и CXXFLAGS можно получить
повышение производительности на 4%.

</P>
<P>
При использовании компилятора Sun Fortre версии 5.0 (или выше)
можно запускать <code>configure</code> следующим образом:

</P>

<pre>
CC=cc CFLAGS="-Xa -fast -xO4 -native -xstrconst -mt" \
CXX=CC CXXFLAGS="-noex -xO4 -mt" \
./configure --prefix=/usr/local/mysql --enable-assembler
</pre>

<P>
Можно создать 64-разрядный исполняемый код с помощью: 

</P>

<pre>
CC=cc CFLAGS="-Xa -fast -native -xstrconst -mt -xarch=v9" \
CXX=CC CXXFLAGS="-noex -mt -xarch=v9" ASFLAGS="-xarch=v9" \
./configure --prefix=/usr/local/mysql --enable-assembler
</pre>

<P>
В тестах на производительность MySQL с Sun Fortre 5.0 мы получили 4%-ное
ускорение на UltraSPARC по сравнению с gcc 3.2 с опцией -mcpu.

</P>
<P>
Если вы создаете 64-разрядный код, он на 4% медленнее чем 32-разрядный, но 
mysqld можно обслуживать больше потоков и использовать больше памяти. 

</P>
<P>
В случае возникновения проблем с <code>fdatasync</code> или <code>sched_yield</code> их можно решить
путем добавления <code>LIBS=-lrt</code> к командной строке запуска конфигурирования.

</P>
<P>
Последующий абзац относится только к более ранним, чем WorkShop 5.3,
компиляторам:

</P>
<P>
Отредактировать скрипт configure можно, заменив строку:

</P>

<pre>
#if !defined(__STDC__) || __STDC__ != 1
</pre>

<P>
строкой:

</P>

<pre>
#if !defined(__STDC__)
</pre>

<P>
При включении <code>__STDC__</code> с помощью опции <code>-Xc</code> компилятор Sun не сможет
откомпилировать программу с файлом <tt>`pthread.h'</tt> из системы Solaris. Это
ошибка Sun (испорченный компилятор или испорченный включаемый файл).

</P>
<P>
Если при запуске <code>mysqld</code> выдает приведенное ниже сообщение об ошибке:

</P>

<pre>
libc internal error: _rmutex_unlock: rmutex not held
</pre>

<P>
необходимо попробовать собрать MySQL, используя компилятор Sun с опцией
запрещения многопоточности (<code>-mt</code>). Добавьте опцию <code>-mt</code> к <code>CFLAGS</code> и <code>CXXFLAGS</code> и
попробуйте запустить <code>mysqld</code> еще раз.

</P>
<P>
При использовании SFW версии gcc (поставляемой с Solaris 8) необходимо к
переменной окружения <code>LD_LIBRARY_PATH</code> перед конфигурированием добавить
<tt>`/opt/sfw/lib'</tt>.

</P>
<P>
При работе с <code>gcc</code> от <code>sunfreeware</code>.com может возникнуть множество
неприятностей. Во избежание проблем необходимо перекомпилировать gcc и
бинарные инструментальные программы GNU в той системе, где вы собираетесь
их использовать.

</P>
<P>
Получение нижеследующей ошибки при компиляции MySQL компилятором <code>gcc</code>
означает, что <code>gcc</code> не сконфигурирован под вашу версию Solaris:

</P>

<pre>
shell&#62; gcc -O3 -g -O2 -DDBUG_OFF -o thr_alarm ...
./thr_alarm.c: In function `signal_hand':
./thr_alarm.c:556: too many arguments to function `sigwait'
</pre>

<P>
В этом случае нужно взять самую свежую версию <code>gcc</code> и скомпилировать ее
установленным <code>gcc</code>-компилятором! Почти все бинарные версии <code>gcc</code> (по крайней
мере для Solaris 2.5) содержат старые, непригодные к использованию
включаемые файлы, которые портят все программы, использующие потоки (а
возможно, и другие программы)!

</P>
<P>
В Solaris не обеспечиваются статические версии всех системных библиотек
(<code>libpthreads</code> и <code>libdl</code>), поэтому компилировать MySQL с опцией <code>-static</code> 
нельзя. При попытке такой компиляции вы получите одно из приведенных ниже
сообщений об ошибке:

</P>

<pre>
ld: fatal: library -ldl: not found
или
undefined reference to `dlopen'
или
cannot find -lrt
</pre>

<P>
Если слишком много процессов одновременно пытаются установить соединение с
<code>mysqld</code>, то в файле протокола MySQL появится следующее сообщение об ошибке:

</P>

<pre>
Error in accept: Protocol error
</pre>

<P>
Для решения этой проблемы можно попытаться запустить сервер с опцией
<code>--set-variable back_log=50</code>. Внимание: <code>--set-variable</code> 
не используется в MySQL 4.0. Просто используйте <code>--back_log=50</code>.
See section <A HREF="manual.ru_MySQL_Database_Administration.html#Command-line_options">4.1.1  Параметры командной строки <code>mysqld</code></A>.

</P>

<P>
Если вы линкуете собственный MySQL-клиент, то при попытке его запустить
может выдаваться следующее сообщение об ошибке:

</P>

<pre>
ld.so.1: ./my: fatal: libmysqlclient.so.#:
open failed: No such file or directory
</pre>

<P>
Проблему можно решить одним из следующих способов:

</P>

<ul>
<LI>

Линковать клиент со следующими опциями (вместо <code>-Lpath</code>):
<code>-Wl,r/полный-путь-к-libmysqlclient.so</code>.

<LI>

Скопировать <tt>`libmysqclient.so'</tt> в <tt>`/usr/lib'</tt>.

<A NAME="IDX347"></A>
<A NAME="IDX348"></A>

<LI>

Перед запуском своего клиента добавить путь к каталогу, в котором
находится <tt>`libmysqclient.so'</tt>, к переменной окружения <code>LD_RUN_PATH</code>.
</ul>

<P>
Если вы столкнулись с проблемами конфигурирования, пытаясь линковать с
опцией <code>-lz</code> и у вас не установлена <code>zlib</code>, существует два варианта:

</P>

<ul>
<LI>

Если вы хотите иметь возможность использовать протокол взаимодействия со
сжатием, необходимо получить и установить zlib с ftp.gnu.org.
<LI>

Сконфигурировать с <code>--with-named-z-libs=no</code>.
</ul>

<P>
Если при использовании <code>gcc</code> вы столкнулись с проблемами загрузки
UDF-функций в MySQL, попробуйте добавить <code>-lgcc</code> к строке, отвечающей за
линкование UDF-функций.

</P>
<P>
Для того чтобы MySQL-сервер стартовал автоматически, можно скопировать
<tt>`support-files/mysql.server'</tt> в <tt>`/etc/init.d'</tt> и создать на него символическую
ссылку <tt>`/etc/rc3.d/S99mysql.server'</tt>.

</P>
<P>
Поскольку Solaris не поддерживает файлы образа памяти для приложений,
использующих <code>setuid()</code>, невозможно получить файл образа памяти программы
<code>mysqld</code> при использовании опции <code>--user</code>.

</P>



<H4><A NAME="Solaris_2.7" HREF="manual.ru_toc.html#Solaris_2.7">2.6.3.1  Примечания к Solaris 2.7/2.8</A></H4>

<P>
На Solaris 2.7 и 2.8 можно нормально использовать бинарные файлы для
Solaris 2.6. Большинство вопросов по работе с Solaris 2.6 относятся также
и к Solaris 2.7 и 2.8.

</P>
<P>
Необходимо отметить, что MySQL версии 3.23.4 и последующих может
автоматически определять новые версии Solaris и избегать описанных ниже
проблем!

</P>
<P>
В Solaris 2.7/2.8 имеются некоторые ошибки во включаемых файлах. При
использовании gcc вы можете получить следующие сообщения об ошибках:

</P>

<pre>
/usr/include/widec.h:42: warning: `getwc' redefined
/usr/include/wchar.h:326: warning: this is the location of the previous definition
</pre>

<P>
В этом случае для исправления ошибки нужно выполнить следующие действия:

</P>
<P>
Скопируйте <code>/usr/include/widec.h</code> в <code>.../lib/gcc-lib/os/gcc-version/include</code> и
измените строку с номером 41, содержащую:

</P>

<pre>
#if !defined(lint) &#38;& !defined(__lint)

на

#if !defined(lint) &#38;& !defined(__lint) &#38;& !defined(getwc)
</pre>

<P>
Есть и альтернативный вариант - отредактировать <tt>`/usr/include/widec.h'</tt> 
непосредственно на месте. В любом случае после исправления необходимо
удалить <tt>`config.cache'</tt> и запустить <code>configure</code> повторно!

</P>
<P>
Если при запуске <code>make</code> выдаются сообщения об ошибках наподобие упомянутых
ниже, причина в том, что программа <code>configure</code> не обнаружила файл <tt>`curses.h'</tt> 
(возможно, из-за ошибок в <tt>`/usr/include/widec.h'</tt>):

</P>

<pre>
In file included from mysql.cc:50:
/usr/include/term.h:1060: syntax error before `,'
/usr/include/term.h:1081: syntax error before `;'
</pre>

<P>
Решить эту проблему можно одним из способов:

</P>

<ul>
<LI>

Конфигурировать с <code>CFLAGS=-DHAVE_CURSES_H CXXFLAGS=-DHAVE_CURSES_H ./configure</code> (эта запись должна быть цельной строкой, без пробелов).

<LI>

Отредактировать <tt>`/usr/include/widec.h'</tt>, как описано выше, и перезапустить
<code>configure</code>.

<LI>

Удалить строку <code>#define HAVE_TERM</code> из <tt>`config.h'</tt> и запустить <code>make</code> повторно.
</ul>

<P>
Если редактор связей не может обнаружить <code>-lz</code> при линковании вашей
клиентской программы, то проблема, возможно, заключается в том, что файл
<tt>`libz.so'</tt> установлен в <tt>`/usr/local/lib'</tt>. Данную проблему можно решить любым из
приведенных выше способов:

</P>

<ul>
<LI>

Добавить <tt>`/usr/local/lib'</tt> к <code>LD_LIBRARY_PATH</code>.

<LI>

Создать ссылку на <tt>`libz.so'</tt> из <tt>`/lib'</tt>.

<LI>

Если используется Solaris 8, можно установить необязательную библиотеку
zlib с CD-диска с дистрибутивом Solaris 8.

<LI>

Конфигурировать MySQL с опцией <code>--with-named-z-libs=no</code>.
</ul>



<H4><A NAME="Solaris_x86" HREF="manual.ru_toc.html#Solaris_x86">2.6.3.2  Примечания к Solaris x86</A></H4>

<P>
На Solaris 2.8 на x86-й архитектуре <code>mysqld</code> аварийно завершится с
сохранением образа памяти на диске, если он обработан программой <code>strip</code>.

</P>
<P>
Если при использовании <code>gcc</code> или <code>egcs</code> на Solaris x86 при большой нагрузке вы
столкнетесь с проблемой аварийного завершения программы с сохранением
образа памяти на диске, используйте при сборке команду <code>configure</code> со
следующими параметрами:

</P>

<pre>
CC=gcc CFLAGS="-O3 -fomit-frame-pointer -DHAVE_CURSES_H" \
CXX=gcc \
CXXFLAGS="-O3 -fomit-frame-pointer -felide-constructors -fno-exceptions \
-fno-rtti -DHAVE_CURSES_H" \
./configure --prefix=/usr/local/mysql
</pre>

<P>
Это позволит избежать проблем с библиотекой <code>libstdc++</code> и исключительными
ситуациями в C++.

</P>
<P>
Если приведенные рекомендации не помогают, соберите версию с отладочной
информацией и запустите программу с созданием трассировочного файла или в
отладчике <code>gdb</code> (see section <A HREF="manual.ru_Porting.html#Using_gdb_on_mysqld">E.1.3  Отладка mysqld при помощи gdb</A>).

</P>


<H3><A NAME="BSD_Notes" HREF="manual.ru_toc.html#BSD_Notes">2.6.4  Примечания к BSD</A></H3>

<P>
В этом разделе находится информация относительно различных BSD-систем, а
также конкретных версий этих систем.

</P>



<H4><A NAME="FreeBSD" HREF="manual.ru_toc.html#FreeBSD">2.6.4.1  Примечания к FreeBSD</A></H4>

<P>
Для работы Mysql рекомендуется FreeBSD версий 3.x, поскольку версия с
потоками является намного более интегрированной.

</P>
<P>
Простейшим, а поэтому и более предпочтительным способом установки является
использование портов <code>mysql-server</code> и <code>mysql-client</code> из коллекции портов
FreeBSD, которая доступна по адресу <a HREF="http://www.freebsd.org/">http://www.freebsd.org/</a>.

</P>
<P>
Использование этих портов обеспечивает:

<ul>
<LI>

работоспособный MySQL со всеми возможностями оптимизации, доступными на
данной версии FreeBSD;
<LI>

автоматическую конфигурацию и сборку;
<LI>

установку скриптов, запускающих MySQL, в <tt>`/usr/local/etc/rc.d'</tt>;
<LI>

возможность получения списка установленных файлов по команде <code>pkg_info -L</code> 
и удаления их при помощи команды <code>pkg_delete</code> в случае, если вы более не
нуждаетесь в MySQL на данной машине.
</ul>

<P>
Рекомендуется использовать MIT-pthreads на FreeBSD версий 2.x и
собственные потоки для 3.x и более поздних версий FreeBSD. На некоторых
последних версиях 2.2.x возможно применение собственных потоков, но при
этом не исключены проблемы с остановкой <code>mysqld</code>.

</P>
<P>
Для сборки MySQL в соответствии с <code>Makefile</code>'ом необходима программа GNU
make (<code>gmake</code>). Прежде чем выполнять сборку MySQL, следует установить GNU
make.

</P>
<P>
Удостоверьтесь, что используемый вами сервер имен работает корректно. В
противном случае возможны задержки или ошибки при соединении с <code>mysqld</code>.

</P>
<P>
Убедитесь в корректности записи <code>localhost</code> в файле <tt>`/etc/hosts'</tt> (при
отсутствии или ошибочности этой записи возникнут проблемы соединения с
базой). Файл <tt>`/etc/hosts'</tt> должен начинаться с записи:

</P>

<pre>
127.0.0.1 localhost localhost.your.domain
</pre>

<P>
Предлагаемый способ сборки и установки MySQL на FreeBSD с использованием
<code>gcc</code> (версии 2.95.2 или более поздней):

</P>

<pre>
CC=gcc CFLAGS="-O2 -fno-strength-reduce" \
CXX=gcc CXXFLAGS="-O2 -fno-rtti -fno-exceptions -felide-constructors \
-fno-strength-reduce" \
./configure --prefix=/usr/local/mysql --enable-assembler
gmake
gmake install
./scripts/mysql_install_db
cd /usr/local/mysql
./bin/mysqld_safe &#38;
</pre>

<P>
Если программа <code>configure</code> решила  использовать MIT-pthreads, необходимо 
ознакомится с примечаниями по MIT-pthreads (see section <A HREF="manual.ru_Installing.html#MIT-pthreads">2.3.6  Замечания по потокам MIT-pthreads</A>).

</P>
<P>
Если при выполнении <code>make install</code> возникла ошибка, сообщающая о
невозможности нахождения <tt>`/usr/include/pthreads'</tt> (can't find
`/usr/include/pthreads'), это значит, что <code>configure</code> не определил
необходимость использования MIT-pthreads. Для исправления данной ошибки
необходимо выполнить следующие команды:

</P>

<pre>
shell&#62; rm config.cache
shell&#62; ./configure --with-mit-threads
</pre>

<P>
Как известно, в FreeBSD по умолчанию установлено очень небольшое значение
для количества одновременно открытых файлов (see section <A HREF="manual.ru_Problems.html#Not_enough_file_handles">A.2.16  Не найден файл (<code>File not found</code>)</A>).
Чтобы исправить положение, следует раскомментировать секцию <code>ulimit -n</code> в
скрипте <code>safe_mysqld</code> или повысить ограничение для пользователя <code>mysqld</code> в
<tt>`/etc/login.conf'</tt> (не забудьте перестроить его командой <code>cap_mkdb</code>
<tt>`/etc/login.conf'</tt>). Помимо этого, имеет смысл проверить установку
подходящего класса для этого пользователя в файле паролей, если не
используется значение по умолчанию (при помощи <code>chpass mysqld-user-name</code>).
See section <A HREF="manual.ru_MySQL_Database_Administration.html#safe_mysqld">4.7.2  <code>safe_mysqld</code>, оболочка <code>mysqld</code></A>.

</P>
<P>
При наличии значительного объема оперативной памяти можно рассмотреть
вариант перестройки ядра, чтобы разрешить MySQL использовать более чем
512Mб оперативной памяти. Чтобы получить больше информации, обратитесь к
<code>option MAXDSIZ</code> в конфигурационном файле LINT.

</P>
<P>
В случае возникновения проблем с текущей датой в MySQL ситуацию может
исправить правильная установка переменной <code>TZ</code>. See section <A HREF="manual.ru_Environment_variables.html#Environment_variables">F  Переменные окружения</A>.

</P>
<P>
Для получения безопасной и устойчивой системы следует использовать
только те ядра системы FreeBSD, которые обозначены как <code>-RELEASE</code>.

</P>


<H4><A NAME="NetBSD" HREF="manual.ru_toc.html#NetBSD">2.6.4.2  Примечания к NetBSD</A></H4>

<P>
Для компиляции на NetBSD необходимо, чтобы была установлена программа GNU
<code>make</code>. В противном случае компиляция завершится аварийно при попытке <code>make</code>
запустить <code>lint</code> на файлах C++.

</P>


<H4><A NAME="OpenBSD" HREF="manual.ru_toc.html#OpenBSD">2.6.4.3  Примечания к OpenBSD 2.5</A></H4>

<P>
На OpenBSD версии 2.5 можно компилировать MySQL с использованием
собственных потоков. Необходимо указать следующие опции:

</P>

<pre>
CFLAGS=-pthread CXXFLAGS=-pthread ./configure -with-mit-threads=no
</pre>



<H4><A NAME="OpenBSD_2.8" HREF="manual.ru_toc.html#OpenBSD_2.8">2.6.4.4  Примечания к OpenBSD 2.8</A></H4>

<P>
По сообщениям наших пользователей, OpenBSD 2.8 содержит ошибку в
реализации потоков, которая вызывает проблемы с MySQL. Разработчики
OpenBSD устранили эту ошибку, но к 25 января 2001 года исправленная версия
доступна только в ветви ``-current''. Симптомы этой ошибки реализации потоков
следующие: медленный ответ, высокая загрузка, большая загрузка процессора
и аварийная остановка программы.

</P>
<P>
Получение сообщения об ошибке вроде <code>Error in accept:: Bad file
descriptor</code> или ошибки 9 при попытке открыть таблицу либо каталог
означает, что вы не заказали достаточно дескрипторов файлов для MySQL.

</P>
<P>
В этом случае попробуйте запустить <code>safe_mysqld</code> от имени пользователя <code>root</code>
с опциями:

</P>

<pre>
--user=mysql --open-files-limit=2048
</pre>



<H4><A NAME="BSDI" HREF="manual.ru_toc.html#BSDI">2.6.4.5  Примечания к BSD/OS версий 2.x</A></H4>

<P>
Получение приведенной ниже ошибки при компиляции MySQL означает, что
установленное с помощью <code>ulimit</code> значение размера виртуальной памяти слишком
мало:

</P>

<pre>
item_func.h: In method `Item_func_ge::Item_func_ge(const Item_func_ge &#38;)':
item_func.h:28: virtual memory exhausted
make[2]: *** [item_func.o] Error 1
</pre>

<P>
Попробуйте выполнить <code>ulimit -v 80000</code> и запустить <code>make</code> еще раз. Если это не
поможет, а в качестве оболочки используется <code>bash</code>, попробуйте перейти на
<code>csh</code> или <code>sh</code>: некоторые пользователи BSDI сообщали нам о проблемах с <code>bash</code> и
<code>ulimit</code>.

</P>
<P>
Если вы используете <code>gcc</code>, то, возможно, необходимо добавить флаг
<code>--with-low-memory</code> при запуске <code>configure</code>, чтобы обеспечить возможность
компиляции <tt>`sql_yacc.cc'</tt>.

</P>
<P>
При возникновении проблем с текущей датой в MySQL может помочь установка
переменной <code>TZ</code> (see section <A HREF="manual.ru_Environment_variables.html#Environment_variables">F  Переменные окружения</A>).

</P>


<H4><A NAME="BSDI3" HREF="manual.ru_toc.html#BSDI3">2.6.4.6  Примечания к BSD/OS версий 3.x</A></H4>

<P>
Для конфигурирования MySQL следует использовать следующую команду:

</P>

<pre>
shell&#62; env CXX=shlicc++ CC=shlicc2 \
       ./configure \
           --prefix=/usr/local/mysql \
	   --localstatedir=/var/mysql \
	   --without-perl \
	   --with-unix-socket-path=/var/mysql/mysql.sock
</pre>

<P>
Сработает и следующая командная строка:

</P>

<pre>
shell&#62; env CC=gcc CXX=gcc CXXFLAGS=-O3 \
       ./configure \
           --prefix=/usr/local/mysql \
	   --with-unix-socket-path=/var/mysql/mysql.sock
</pre>

<P>
При желании вы можете изменить местоположение каталогов или использовать
значения по умолчанию, не определяя никаких путей.

</P>
<P>
Если возникнут проблемы с производительностью при большой нагрузке,
попробуйте при запуске <code>mysqld</code> использовать опцию <code>--skip-thread-priority</code>!
Применение данной опции приведет к тому, что все потоки будут работать с
одинаковым приоритетом; на BSDI версии 3.1 это обеспечивало повышение
производительности (по крайней мере, пока не был исправлен планировщик
потоков).

</P>
<P>
В случае получения сообщения об ошибке <code>virtual memory exhausted</code> во время
компиляции попробуйте выполнить <code>ulimit -v 80000</code> и запустить <code>make</code> повторно.
Если это не поможет, а в качестве оболочки у вас используется <code>bash</code>,
попробуйте перейти на <code>csh</code> или <code>sh</code>: некоторые пользователи BSDI сообщали о
проблемах с <code>bash</code> и <code>ulimit</code>.

</P>


<H4><A NAME="BSDI4" HREF="manual.ru_toc.html#BSDI4">2.6.4.7  Примечания к BSD/OS версий 4.x</A></H4>

<P>
BSDI версий 4.x содержит ошибку, имеющую отношение к потокам. Если вы
планируете использовать MySQL на этой системе, необходимо предварительно
установить все патчи, относящиеся к реализации потоков. По крайней мере,
должен быть установлен M400-023.

</P>
<P>
На некоторых системах BSDI версий 4.x вы можете столкнуться с проблемами
при использовании динамических библиотек. Проявляется это как
невозможность выполнить какую-либо клиентскую программу, например
<code>mysqladmin</code>. В данном случае необходимо переконфигурировать MySQL с
запретом использовать динамические библиотеки, указав для скрипта
configure опцию <code>--disable-shared</code>.

</P>
<P>
Некоторые пользователи сообщали нам о проблемах на BSDI 4.0.1, которые
проявляются в том, что через некоторое время после начала работы <code>mysqld</code> не
может открыть таблицы. Это происходит потому, что из-за какой-то системной
или библиотечной ошибки <code>mysqld</code> изменяет текущий каталог без какого-либо
запроса!

</P>
<P>
Для решения проблемы необходимо либо обновить MySQL до версии 3.23.34,
либо после запуска <code>configure</code> удалить строку <code>#define HAVE_REALPATH</code> из файла
<tt>`config.h'</tt> перед запуском <code>make</code>.

</P>
<P>
Отметим, что вышеописанные действия приведут к невозможности создать
символическую ссылку из одних каталогов базы данных на другой каталог базы
данных или символическую ссылку на таблицу в другой базе данных на BSDI!
(Создание символической ссылки на другой диск допускается.)

</P>


<H3><A NAME="Mac_OS_X" HREF="manual.ru_toc.html#Mac_OS_X">2.6.5  Примечания к Mac OS X</A></H3>



<H4><A NAME="Mac_OS_X_10.x" HREF="manual.ru_toc.html#Mac_OS_X_10.x">2.6.5.1  Mac OS X 10.x</A></H4>

<P>
На  Mac OS X 10.x MySQL должен работать без каких-либо проблем. Для этой
операционной системы нет необходимости в патчах к pthread!

</P>
<P>
Это также касается Mac OS X 10.x Server. Компиляция для серверной платформы
ничем не отличается от компиляции для клиентской версии. Однако учтите, что 
Mac OS X Server поставляется с предустановленным MySQL. 

</P>
<P>
See section <A HREF="manual.ru_Installing.html#Mac_OS_X_installation">2.1.3  Установка MySQL на MacOS X</A>.

</P>



<H4><A NAME="Mac_OS_X_Server" HREF="manual.ru_toc.html#Mac_OS_X_Server">2.6.5.2  Mac OS X Server 1.2 (Rhapsody)</A></H4>

<P>
Прежде чем попытаться отконфигурировать MySQL на сервере Mac OS X,
необходимо установить пакет <code>pthread</code>, который находится по адресу
<a HREF="http://www.prnet.de/RegEx/mysql.html">http://www.prnet.de/RegEx/mysql.html</a>.

</P>
<P>
Наши бинарные файлы для Mac OS X компилируются на Rhapsody 6.3 со
следующими конфигурационными параметрами:

</P>

<pre>
CC=gcc CFLAGS="-O3 -fno-omit-frame-pointer" CXX=gcc \
CXXFLAGS="-O3 -fno-omit-frame-pointer -felide-constructors \
-fno-exceptions -fno-rtti" ./configure --prefix=/usr/local/mysql \
--with-extra-charsets=complex --enable-thread-safe-client \
--enable-local-infile --disable-shared
</pre>

<P>
Возможно, вам понадобится добавить псевдонимы в файл ресурсов оболочки -
для доступа к <code>mysql</code> и <code>mysqladmin</code> из командной строки:

</P>

<pre>
alias mysql '/usr/local/mysql/bin/mysql'
alias mysqladmin '/usr/local/mysql/bin/mysqladmin'
</pre>

<P>
Или же вы можете просто добавить путь <code>/usr/local/mysql/bin</code> к переменной окружения 
<code>PATH</code>, скажем, путем добавления в файл 
<tt>`$HOME/.tcshrc'</tt>:

</P>

<pre>
setenv PATH $PATH:/usr/local/bin
</pre>



<H3><A NAME="Other_Unix_Notes" HREF="manual.ru_toc.html#Other_Unix_Notes">2.6.6  Примечания к другим Unix-системам</A></H3>



<H4><A NAME="Binary_notes-HP-UX" HREF="manual.ru_toc.html#Binary_notes-HP-UX">2.6.6.1  Примечания к бинарному дистрибутиву HP-UX</A></H4>

<P>
<A NAME="IDX349"></A>
<A NAME="IDX350"></A>

</P>
<P>
Некоторые бинарные поставки MySQL для HP-UX распространяются как файлы HP
depot и tar. Для использования файла depot у вас должна быть установлена
версия HP-UX не выше 10.x - для того, чтобы обеспечить возможность работы
с HP-инструментарием работы с depot-файлами.

</P>
<P>
Версия MySQL для HP была скомпилирована на сервере HP 9000/8xx в системе
HP-UX 10.20 с использованием MIT-pthreads. Известно, что она хорошо
работает в этой конфигурации. MySQL версии 3.22.26 и выше можно также
собрать с использованием собственных потоков HP.

</P>
<P>
Другие конфигурации, на которых возможна работа MySQL:

</P>

<ul>
<LI>

HP 9000/7xx running HP-UX 10.20+
<LI>

HP 9000/8xx running HP-UX 10.30
</ul>

<P>
На следующих конфигурациях MySQL, скорее всего, работать не будет:

</P>

<ul>
<LI>

HP 9000/7xx or 8xx running HP-UX 10.x where x &#60; 2
<LI>

HP 9000/7xx or 8xx running HP-UX 9.x
</ul>

<P>
Для установки дистрибутива используйте одну из представленных ниже команд;
здесь <code>/path/to/depot</code> - полный путь к depot-файлу:

</P>

<ul>
<LI>

Для полной установки, включая сервер, клиент и инструментарий
разработчика:


<pre>
shell&#62; /usr/sbin/swinstall -s /path/to/depot mysql.full
</pre>

<LI>

Для установки только сервера:


<pre>
shell&#62; /usr/sbin/swinstall -s /path/to/depot mysql.server
</pre>

<LI>

Для установки только клиентского пакета:


<pre>
shell&#62; /usr/sbin/swinstall -s /path/to/depot mysql.client
</pre>

<LI>

Для установки только инструментария разработчика:


<pre>
shell&#62; /usr/sbin/swinstall -s /path/to/depot mysql.developer
</pre>

</ul>

<P>
depot помещает бинарные исполняемые файлы и библиотеки в <tt>`/opt/mysql'</tt>, а
данные - в <tt>`/var/opt/mysql'</tt>. depot также создает соответствующие строки в
<tt>`/etc/init.d'</tt> и <tt>`/etc/rc2.d'</tt> для автоматического запуска сервера при загрузке
машины. Очевидно, что для установки необходимо обладать правами
пользователя <code>root</code>.

</P>
<P>
Для установки на HP-UX дистрибутива tar.gz на машине должен быть
установлен GNU <code>tar</code>.

</P>


<H4><A NAME="HP-UX_10.20" HREF="manual.ru_toc.html#HP-UX_10.20">2.6.6.2  Примечания к HP-UX версии 10.20</A></H4>

<P>
При компиляции MySQL на HP-UX существует пара небольших проблем. Мы
рекомендуем применять вместо собственного компилятора HP-UX <code>gcc</code>, потому
что код, созданный <code>gcc</code>, лучше!

</P>
<P>
Для HP-UX рекомендуется использование gcc 2.95. Не следует применять
высокие уровни оптимизации (наподобие -O6), поскольку на HP-UX это может
быть небезопасно.

</P>
<P>
Должна работать следующая строка конфигурации для gcc 2.95:

</P>

<pre>
CFLAGS="-DHPUX -I/opt/dce/include -fpic" \
CXXFLAGS="-DHPUX -I/opt/dce/include -felide-constructors -fno-exceptions \
-fno-rtti" CXX=gcc ./configure --with-pthread \
--with-named-thread-libs='-ldce' --prefix=/usr/local/mysql
--disable-shared
</pre>

<P>
Следующая строка конфигурации должна работать для gcc 3.1:

</P>

<pre>
CFLAGS="-DHPUX -I/opt/dce/include -O3 -fPIC" CXX=gcc \
CXXFLAGS="-DHPUX -I/opt/dce/include -felide-constructors -fno-exceptions \
-fno-rtti -O3 -fPIC" ./configure --prefix=/usr/local/mysql \
--with-extra-charsets=complex --enable-thread-safe-client \
--enable-local-infile  --with-pthread \
--with-named-thread-libs=-ldce --with-lib-ccflags=-fPIC
--disable-shared
</pre>



<H4><A NAME="HP-UX_11.x" HREF="manual.ru_toc.html#HP-UX_11.x">2.6.6.3  Примечания к HP-UX версий 11.x</A></H4>

<P>
Для HP-UX версий 11.x мы рекомендуем использовать MySQL не ниже 3.23.15.

</P>
<P>
Из-за некоторых критических ошибок в стандартных библиотеках HP-UX до
попытки запуска MySQL на HP-UX 11.0 необходимо установить следующие патчи:

</P>

<pre>
PHKL_22840 Streams cumulative
PHNE_22397 ARPA cumulative
</pre>

<P>
Применение данных патчей решит проблему получения <code>EWOULDBLOCK</code> от <code>recv()</code> и
<code>EBADF</code> от <code>accept()</code> в потоковых приложениях.

</P>
<P>
При использовании <code>gcc</code> 2.95.1 в системе, к которой не были применены патчи,
возникнет ошибка:

</P>

<pre>
In file included from /usr/include/unistd.h:11,
		 from ../include/global.h:125,
		 from mysql_priv.h:15,
		 from item.cc:19:
/usr/include/sys/unistd.h:184: declaration of C function ...
/usr/include/sys/pthread.h:440: previous declaration ...
In file included from item.h:306,
		 from mysql_priv.h:158,
		 from item.cc:19:
</pre>

<P>
Проблема заключается в том, что HP-UX существуют несовместимые определения
функции <code>pthreads_atfork()</code>. Конфликтующие прототипы находятся в
<tt>`/usr/include/sys/unistd.h'</tt>:184 и в <tt>`/usr/include/sys/pthread.h'</tt>:440
(подробности приведены ниже).

</P>
<P>
Одно из возможных решений заключается в том, чтобы скопировать
<tt>`/usr/include/sys/unistd.h'</tt> в <tt>`mysql/include'</tt> и отредактировать <tt>`unistd.h'</tt> так,
чтобы определение совпадало с определением из <tt>`pthread.h'</tt>. Ниже приведен
результат работы <code>diff</code>:

</P>

<pre>
183,184c183,184
&#60;      extern int pthread_atfork(void (*prepare)(), void (*parent)(),
&#60;                                                void (*child)());
---
&#62;      extern int pthread_atfork(void (*prepare)(void), void (*parent)(void),
&#62;                                                void (*child)(void));
</pre>

<P>
После этого должна работать конфигурационная программа со следующими
параметрами:

</P>

<pre>
CFLAGS="-fomit-frame-pointer -O3 -fpic" CXX=gcc \
CXXFLAGS="-felide-constructors -fno-exceptions -fno-rtti -O3" \
./configure --prefix=/usr/local/mysql --disable-shared
</pre>

<P>
Если вы используете MySQL 4.0.5 с компилятором HP-UX, то вам подойдет (проверено 
на cc B.11.11.04):

</P>


<pre>
CC=cc CXX=aCC CFLAGS=+DD64 CXXFLAGS=+DD64 ./configure --with-extra-character-set=complex
</pre>

<P>
Вы можете игнорировать ошибки, подобные этой: 

</P>

<pre>
aCC: warning 901: unknown option: `-3': use +help for online documentation
</pre>

<P>
При получении следующего сообщения об ошибке при работе <code>configure</code>

<pre>
checking for cc option to accept ANSI C... no
configure: error: MySQL requires a ANSI C compiler (and a C++ compiler).
Try gcc. See the Installation chapter in the Reference Manual.
</pre>

<P>
следует удостовериться, что путь к компилятору K&#38;R не указан раньше, чем
путь к компиляторам HP-UX C и C++.

</P>
<P>
Еще одна причина, по которой вы не сможете скомпилировать MySQL, заключается
в том, что вы забыли указать флаг <code>+DD64</code>, описанный выше. 

</P>


<H4><A NAME="IBM-AIX" HREF="manual.ru_toc.html#IBM-AIX">2.6.6.4  Примечания к IBM-AIX</A></H4>

<P>
<A NAME="IDX351"></A>

</P>
<P>
В Autoconf пропущено автоматическое определение <code>xlC</code>, поэтому при
компиляции MySQL следует задавать команду <code>configure</code> наподобие следующей (в
этом примере используется компилятор IBM):

</P>

<pre>
export CC="xlc_r -ma -O3 -qstrict -qoptimize=3 -qmaxmem=8192 "
export CXX="xlC_r -ma -O3 -qstrict -qoptimize=3 -qmaxmem=8192"
export CFLAGS="-I /usr/local/include"
export LDFLAGS="-L /usr/local/lib"
export CPPFLAGS=$CFLAGS
export CXXFLAGS=$CFLAGS

./configure --prefix=/usr/local \
		--localstatedir=/var/mysql \
		--sysconfdir=/etc/mysql \
		--sbindir='/usr/local/bin' \
		--libexecdir='/usr/local/bin' \
		--enable-thread-safe-client \
		--enable-large-files
</pre>

<P>
Здесь указаны опции, используемые для компиляции дистрибутива MySQL,
который находится по адресу <a HREF="http://www-frec.bull.com/">http://www-frec.bull.com/</a>.

</P>
<P>
Если в приведенных выше строках конфигурации вы изменяете <code>-O3</code> на <code>-O2</code>,
следует также удалить опцию <code>-qstrict</code> (это ограничение компилятора IBM C).

</P>
<P>
При использовании <code>gcc</code> или <code>egcs</code> для компиляции MySQL следует применять флаг
<code>-fno-exceptions</code>, потому что обработчик исключительных ситуаций в <code>gcc</code>/<code>egcs</code>
не безопасен в реализации потоков! (Это проверено на <code>egcs</code> 1.1.) Существуют
также некоторые известные проблемы с ассемблером IBM, которые могут
привести к генерации неудачного кода при использовании его с <code>gcc</code>.

</P>
<P>
Для использования <code>egcs</code> или <code>gcc</code> 2.95 на AIX мы рекомендуем следующую строку
конфигурирования:

</P>

<pre>
CC="gcc -pipe -mcpu=power -Wa,-many" \
CXX="gcc -pipe -mcpu=power -Wa,-many" \
CXXFLAGS="-felide-constructors -fno-exceptions -fno-rtti" \
./configure --prefix=/usr/local/mysql --with-low-memory
</pre>

<P>
Для того чтобы компиляция была успешной, здесь необходимо указывать ключи
<code>-Wa</code>,<code>-many</code>. В IBM известно о существовании данной проблемы, но ее
специалисты не торопятся исправлять ошибку, поскольку существует способ
обхода. Нам неизвестно, необходимо ли использование <code>-fno-exceptions</code> с <code>gcc</code>
2.95, но поскольку в MySQL нет обработчика исключительных ситуаций, а эта
опция способствует созданию более быстрого кода, мы рекомендуем всегда
использовать ее с <code>egcs</code>/<code>gcc</code>.

</P>
<P>
В случае возникновения проблем в программах на ассемблере необходимо
привести -mcpu=xxx в соответствие со своим процессором. Обычно достаточно
использовать power2, power или powerpc, но, возможно, необходимо будет
указать 604 или 604e. Хотя это и не приветствуется, но использование
"power" будет безопасным почти всегда, даже на power2-машинах.

</P>
<P>
Если вы не знаете, какой у вас процессор, следует запустить uname -m.
Данная команда возвращает строку наподобие "000514676700", формат которой
xxyyyyyymmss, где xx и ss всегда 0, yyyyyy - уникальный идентификатор
системы и mm - идентификатор процессора Planar. Карта этих значений
находится по адресу
<a HREF="http://publib.boulder.ibm.com/doc_link/en_US/a_doc_lib/cmds/aixcmds5/uname.htm">http://publib.boulder.ibm.com/doc_link/en_US/a_doc_lib/cmds/aixcmds5/uname.htm</a>.

</P>
<P>
В соответствии с данной картой можно узнать тип и модель машины, а уже по
ним -определить тип процессора.

</P>
<P>
Возникновение проблем с сигналами (MySQL неожиданно умирает при большой
нагрузке) может означать, что вы столкнулись с ошибкой операционной
системы в работе с потоками и сигналами. В этом случае можно запретить
MySQL использовать сигналы при помощи следующей строки конфигурации:

</P>

<pre>
shell&#62; CFLAGS=-DDONT_USE_THR_ALARM CXX=gcc \
       CXXFLAGS="-felide-constructors -fno-exceptions -fno-rtti \
       -DDONT_USE_THR_ALARM" \
       ./configure --prefix=/usr/local/mysql --with-debug --with-low-memory
</pre>

<P>
Это не повлияет на производительность MySQL, но приведет к побочному
эффекту, состоящему в невозможности оборвать работу клиента со спящим
соединением при помощи команд <code>mysqladmin kill</code> или <code>mysqladmin shutdown</code>.
Вместо этого клиент завершит работу при попытке послать следующую команду.

</P>
<P>
На некоторых версиях AIX линкование с <code>libbind.a</code> приводит к тому, что
getservbyname вызывает аварийную остановку программы с сохранением образа
памяти на диск (core dump). Это ошибка AIX и о ней следует сообщить в IBM.

</P>
<P>
Для AIX 4.2.1 и gcc необходимо сделать следующие изменения:

</P>
<P>
После конфигурации следует отредактировать файлы <tt>`config.h'</tt> и
<tt>`include/my_config.h'</tt>, а также изменить строку, содержащую

</P>

<pre>
#define HAVE_SNPRINTF 1
</pre>

<P>
на

</P>

<pre>
#undef HAVE_SNPRINTF
</pre>

<P>
И напоследок необходимо в файле <tt>`mysqld.cc'</tt> добавить прототип функции
<code>initgoups</code>.

</P>

<pre>
#ifdef _AIX41
extern "C" int initgroups(const char *,int);
#endif
</pre>

<P>
Если вам нужно выделить много памяти процессу mysqld, недостаточно 
указать <code>ulimit -d unlimited</code>. Вам также потребуется в <code>mysqld_safe</code> 
установить что-то вроде: 

</P>

<pre>
export LDR_CNTRL='MAXDATA=0x80000000'
</pre>

<P>
Больше информации об использовании большого количества памяти - здесь:
<a HREF="http://publib16.boulder.ibm.com/pseries/en_US/aixprggd/genprogc/lrg_prg_support.htm">http://publib16.boulder.ibm.com/pseries/en_US/aixprggd/genprogc/lrg_prg_support.htm</a>.

</P>



<H4><A NAME="SunOS" HREF="manual.ru_toc.html#SunOS">2.6.6.5  Примечания к SunOS 4</A></H4>

<P>
На SunOS 4 для компиляции MySQL необходимо использовать MIT-pthreads, что,
в свою очередь, влечет за собой необходимость в GNU <code>make</code>.

</P>
<P>
На некоторых SunOS 4 возникают проблемы с динамическими библиотеками и
<code>libtool</code>. Во избежание этих проблем можно использовать приведенную ниже
строку <code>configure</code>:

</P>

<pre>
shell&#62; ./configure --disable-shared --with-mysqld-ldflags=-all-static
</pre>

<P>
При компиляции <code>readline</code> могут выдаваться предупреждения о дублирующихся
определениях. На них можно не обращать внимания.

</P>
<P>
При компиляции <code>mysqld</code> возникают предупреждения об <code>implicit declaration of
function</code>. На них также можно не обращать внимания.

</P>


<H4><A NAME="Alpha-DEC-UNIX" HREF="manual.ru_toc.html#Alpha-DEC-UNIX">2.6.6.6  Примечания к Alpha-DEC-UNIX (Tru64)</A></H4>

<P>
При использовании egcs на Digital Unix необходимо обновить свою версию до
gcc 2.95.2, поскольку известно о нескольких серьезных ошибках в egcs для
DEC!

</P>
<P>
В документации рекомендуется для компиляции потоковых программ под Digital
Unix использовать опцию <code>-pthread</code> для <code>cc</code> и <code>cxx</code>, а также библиотеки <code>-lmach</code> 
<code>-lexc</code> (в дополнение к <code>-lpthread</code>). Запускать <code>configure</code> нужно в следующей
форме:

</P>

<pre>
CC="cc -pthread" CXX="cxx -pthread -O" \
./configure --with-named-thread-libs="-lpthread -lmach -lexc -lc"
</pre>

<P>
При компиляции <code>mysqld</code> может быть выдано несколько предупреждений наподобие
следующих:

</P>

<pre>
mysqld.cc: In function void handle_connections()':
mysqld.cc:626: passing long unsigned int *' as argument 3 of
accept(int,sockadddr *, int *)'
</pre>

<P>
На них можно не обращать внимания. Они возникают из-за того, что <code>configure</code>
может обнаруживать только ошибки, но не предупреждения.

</P>
<P>
При запуске сервера непосредственно из командной строки могут возникнуть
проблемы с тем, что он прекращает работу при выходе из системы (при выходе
из системы все процессы, запущенные вами во время работы, получают сигнал
<code>SIGHUP</code>). Если такое происходит, следует запускать сервер командой:

</P>

<pre>
shell&#62; nohup mysqld [options] &#38;
</pre>

<P>
При указании <code>nohup</code> следующая за ней команда будет игнорировать все сигналы
<code>SIGHUP</code>, посланные терминалом. В качестве альтернативного варианта можно
запускать сервер командой <code>safe_mysqld</code>, которая при запуске <code>mysqld</code> выполнит
вызов <code>nohup</code> вместо вас (see section <A HREF="manual.ru_MySQL_Database_Administration.html#safe_mysqld">4.7.2  <code>safe_mysqld</code>, оболочка <code>mysqld</code></A>).

</P>
<P>
Если вы столкнулись с проблемами компиляции <tt>`mysys/get_opt.c'</tt>, следует
просто удалить строку <code>#define _NO_PROTO</code> в начале этого файла!

</P>
<P>
Для компилятора CC от Compaq используйте следующий код:

</P>

<pre>
CC="cc -pthread"
CFLAGS="-O4 -ansi_alias -ansi_args -fast -inline speed all -arch host"
CXX="cxx -pthread"
CXXFLAGS="-O4 -ansi_alias -ansi_args -fast -inline speed all -arch host \
-noexceptions -nortti"
export CC CFLAGS CXX CXXFLAGS
./configure \
--prefix=/usr/local/mysql \
--with-low-memory \
--enable-large-files \
--enable-shared=yes \
--with-named-thread-libs="-lpthread -lmach -lexc -lc"
gnumake
</pre>

<P>
В случае возникновения проблем с libtool при компиляции с динамическими
библиотеками (как показано выше), при линковании <code>mysql</code> вы можете избежать
этих проблем с помощью:

</P>

<pre>
cd mysql
/bin/sh ../libtool --mode=link cxx -pthread -O3 -DDBUG_OFF \
-O4 -ansi_alias -ansi_args -fast -inline speed \
-speculate all \ -arch host -DUNDEF_HAVE_GETHOSTBYNAME_R \
-o mysql mysql.o readline.o sql_string.o completion_hash.o \
../readline/libreadline.a -lcurses \
../libmysql/.libs/libmysqlclient.so -lm
cd ..
gnumake
gnumake install
scripts/mysql_install_db
</pre>



<H4><A NAME="Alpha-DEC-OSF1" HREF="manual.ru_toc.html#Alpha-DEC-OSF1">2.6.6.7  Примечания к Alpha-DEC-OSF/1</A></H4>

<P>
В случае проблем компиляции при установленных DEC <code>CC</code> и <code>gcc</code> попробуйте
запустить <code>configure</code> следующим образом:

</P>

<pre>
CC=cc CFLAGS=-O CXX=gcc CXXFLAGS=-O3 \
./configure --prefix=/usr/local/mysql
</pre>

<P>
Если возникнут проблемы с файлом <tt>`c_asm.h'</tt>, можно создать и использовать
``фиктивный'' <tt>`c_asm.h'</tt> при помощи следующих команд:

</P>

<pre>
touch include/c_asm.h
CC=gcc CFLAGS=-I./include \
CXX=gcc CXXFLAGS=-O3 \
./configure --prefix=/usr/local/mysql
</pre>

<P>
Отметим, что перечисленные ниже проблемы с программой <code>ld</code> могут быть решены
путем загрузки последнего набора патчей от DEC (Compaq) с
<a HREF="http://ftp.support.compaq.com/public/unix/">http://ftp.support.compaq.com/public/unix/</a>.

</P>
<P>
При использовании OSF/1 4.0D и компилятора DEC C V5.6-071 на Digital Unix
V4.0 (Rev. 878) компилятор начинает вести себя странно (неопределенные
asm-символы). Кроме того, <code>/bin/ld</code> также, похоже, содержит ошибки (проблемы
с ошибками <code>_exit undefined</code> возникающими при линковании <code>mysqld</code>). На этих
системах нам удалось организовать компиляцию MySQL с помощью следующей
строки <code>configure</code>, заменив <code>/bin/ld</code> аналогичным файлом из версии OSF 4.0C:

</P>

<pre>
CC=gcc CXX=gcc CXXFLAGS=-O3 ./configure --prefix=/usr/local/mysql
</pre>

<P>
С Digital-компилятором "C++ V6.1-029" должно работать:

</P>

<pre>
CC=cc -pthread
CFLAGS=-O4 -ansi_alias -ansi_args -fast -inline speed -speculate all \
       -arch host
CXX=cxx -pthread
CXXFLAGS=-O4 -ansi_alias -ansi_args -fast -inline speed -speculate all \
         -arch host -noexceptions -nortti
export CC CFLAGS CXX CXXFLAGS
./configure --prefix=/usr/mysql/mysql
	    --with-mysqld-ldflags=-all-static \
            --disable-shared --with-named-thread-libs="-lmach -lexc -lc"
</pre>

<P>
В некоторых версиях OSF/1 испорчена функция <code>alloca()</code>. Ситуацию можно
поправить удалением из файла <tt>`config.h'</tt> строки, в которой определяется
<code>HAVE_ALLOCA</code>.

</P>
<P>
Может также существовать некорректный прототип для функции <code>alloca()</code> в
<tt>`/usr/include/alloca.h'</tt>. Предупреждение, вызванное этим, можно игнорировать.

</P>
<P>
<code>configure</code> будет автоматически использовать следующие потоковые библиотеки:
<code>--with-named-thread-libs="-lpthread -lmach -lexc -lc"</code>.

</P>
<P>
При использовании gcc можно попробовать запустить <code>configure</code> следующей
строкой:

</P>

<pre>
shell&#62; CFLAGS=-D_PTHREAD_USE_D4 CXX=gcc CXXFLAGS=-O3 ./configure ...
</pre>

<P>
Возникновение проблем с сигналами (MySQL неожиданно аварийно завершает
работу при большой нагрузке), может означать, что вы обнаружили ошибку при
работе операционной системы с потоками и сигналами. В данном случае можно
запретить MySQL использовать сигналы путем конфигурации его следующим
образом:

</P>

<pre>
shell&#62; CFLAGS=-DDONT_USE_THR_ALARM \
       CXXFLAGS=-DDONT_USE_THR_ALARM \
       ./configure ...
</pre>

<P>
Это не повлияет на производительность MySQL, но приведет к побочному
эффекту, который проявляется как невозможность оборвать работу клиента со
спящим соединением командами <code>mysqladmin kill</code> или <code>mysqladmin shutdown</code>.
Вместо этого клиент завершит работу при попытке послать следующую команду.

</P>
<P>
При использовании <code>gcc</code> 2.95.2 может возникать следующая ошибка компиляции:

</P>

<pre>
sql_acl.cc:1456: Internal compiler error in `scan_region', at except.c:2566
Please submit a full bug report.
</pre>

<P>
Чтобы выйти из положения в этом случае, следует перейти в каталог <tt>`sql'</tt> и
выполнить последнюю строку <code>gcc</code> (просто выделите ее, например, мышкой и
вставьте в терминал), изменив в ней <code>-O3</code> на <code>-O0</code> (или добавьте <code>-O0</code> 
непосредственно после <code>gcc</code>, если у вас в строке компиляции отсутствует
какая-либо опция <code>-O</code>). После выполнения указанных действий вернитесь в
каталог верхнего уровня и запустите <code>make</code> повторно.

</P>


<H4><A NAME="SGI-Irix" HREF="manual.ru_toc.html#SGI-Irix">2.6.6.8  Примечания к SGI Irix</A></H4>

<P>
При использовании Irix 6.5.3 или выше <code>mysqld</code> может создавать потоки только
в случае, если он запущен от имени пользователя с привилегиями
<code>CAP_SCHED_MGT</code> (подобными тем, что у <code>root</code>) или если такие привилегии даются
серверу <code>mysqld</code> следующей командой:

</P>

<pre>
shell&#62; chcap "CAP_SCHED_MGT+epi" /opt/mysql/libexec/mysqld
</pre>

<P>
Возможно, вам придется убрать некоторые определения из <tt>`config.h'</tt>. Это
делается после выполнения <code>configure</code>, но до компиляции.

</P>
<P>
В некоторых реализациях Irix неправильно реализована функция <code>alloca()</code>.
Если сервер <code>mysqld</code> аварийно завершает работу при выполнении некоторых
выражений <code>SELECT</code>, удалите из <tt>`config.h'</tt> строки, в которых определяются
<code>HAVE_ALLOC</code> и <code>HAVE_ALLOCA_H</code>. Если не работает <code>mysqladmin create</code>, удалите из
<tt>`config.h'</tt> строку, определяющую <code>HAVE_READDIR_R</code>. Можно также удалить строку,
содержащую <code>HAVE_TERM_H</code>.

</P>
<P>
SGI рекомендует установить все патчи, как указано на странице

</P>
<P>
<a HREF="http://support.sgi.com/surfzone/patches/patchset/6.2_indigo.rps.html">http://support.sgi.com/surfzone/patches/patchset/6.2_indigo.rps.html</a>.

</P>
<P>
Вам следует, как минимум, установить последние обновления (rollup) ядра,
последние обновления <code>rld</code> и последние обновления <code>libc</code>.

</P>
<P>
Для поддержки pthreads обязательно следует установить все патчи POSIX со
страницы:

</P>
<P>
<a HREF="http://support.sgi.com/surfzone/patches/patchset/6.2_posix.rps.html">http://support.sgi.com/surfzone/patches/patchset/6.2_posix.rps.html</a> 

</P>
<P>
Если при компиляции <tt>`mysql.cc'</tt> вы получили сообщение об ошибке наподобие:

</P>

<pre>
"/usr/include/curses.h", line 82: error(1084): invalid combination of type
</pre>

<P>
то необходимо выполнить следующие команды в каталоге верхнего уровня
дерева каталогов исходных текстов MySQL:

</P>

<pre>
shell&#62; extra/replace bool curses_bool &#60; /usr/include/curses.h \
     &#62; include/curses.h
shell&#62; make
</pre>

<P>
Мы получали также сообщения о проблемах управления. Если выполняется
только один поток, то работа идет очень медленно. Однако если запустить
еще одну программу-клиент, то можно получить ускорение в несколько раз (от
двукратного до десятикратного соответственно) и для других потоков.
Причины описанной проблемы с потоками в Irix пока неясны; возможно, вам
удастся найти временное решение, пока она не будет решена.

</P>
<P>
При компиляции с помощью <code>gcc</code> можно использовать следующую команду
<code>configure</code>:

</P>

<pre>
CC=gcc CXX=gcc CXXFLAGS=-O3 \
./configure --prefix=/usr/local/mysql --enable-thread-safe-client \
--with-named-thread-libs=-lpthread
</pre>

<P>
Сообщают, что для Irix 6.5.11 с собственными Irix C и C++ компиляторами
версии 7.3.1.2, должно работать:

</P>

<pre>
CC=cc CXX=CC CFLAGS='-O3 -n32 -TARG:platform=IP22 -I/usr/local/include \
-L/usr/local/lib' CXXFLAGS='-O3 -n32 -TARG:platform=IP22 \
-I/usr/local/include -L/usr/local/lib' ./configure \
--prefix=/usr/local/mysql --with-innodb --with-berkeley-db \
--with-libwrap=/usr/local \
--with-named-curses-libs=/usr/local/lib/libncurses.a
</pre>



<H4><A NAME="Caldera" HREF="manual.ru_toc.html#Caldera">2.6.6.9  Примечания к Caldera (SCO)</A></H4>

<P>
В настоящее время пакет тестировался только на системах ``sco3.2v5.0.4'' и
``sco3.2v5.0.5''. Заметный прогресс отмечается в отношении пакета на ``sco3.2v4.2''.

</P>
<P>
В настоящее время в качестве компилятора под OpenServer мы рекомендуем gcc
2.95.2. Используя его, можно скомпилировать MySQL при помощи следующей
строки:

</P>

<pre>
CC=gcc CXX=gcc ./configure ... (опции)
</pre>


<ol>
<LI>

На OpenServer 5.0.X необходимо использовать gcc-2.95.2p1 или более 
свежую версию от Skunkware - <a HREF="http://www.caldera.com/skunkware/">http://www.caldera.com/skunkware/</a> и 
выбрать пакет для OpenServer или получить его по ftp по адресу 
ftp2.caldera.com в каталоге pub/skunkware/osr5/devtools/gcc.

<LI>

Следует использовать портированную версию GCC 2.5.x для этого продукта
и систему Development. Они необходимы для данной версии Caldera (SCO)
Unix. Использовать просто систему GCC Dev нельзя.

<LI>

Необходимо загрузить пакет FSU Pthreads и установить его. Его можно
найти по адресу
<a HREF="http://www.cs.wustl.edu/~schmidt/ACE_wrappers/FSU-threads.tar.gz">http://www.cs.wustl.edu/~schmidt/ACE_wrappers/FSU-threads.tar.gz</a>. Можно
также получить уже скомпилированный пакет на 
<a HREF="http://www.mysql.com/Downloads/SCO/FSU-threads-3.5c.tar.gz">http://www.mysql.com/Downloads/SCO/FSU-threads-3.5c.tar.gz</a>.

<LI>

FSU Pthreads могут быть скомпилированы на Caldera (SCO) Unix 4.2 c
tcpip. На OpenServer 3.0 или Open Desktop 3.0 (OS 3.0 ODT 3.0) с
использованием Caldera (SCO) Development System вам понадобится хороший
пакет GCC 2.5.x ODT или OS 3.0. Однако при отсутствии хорошо портированной
версии возникнет масса проблем. Для портирования этой программы требуется
система SCO Unix Development. Без нее у вас не будет необходимых библиотек
и редактора связей.

<LI>

Для сборки FSU Pthreads в своей системе нужно выполнить следующие
действия:


<ol>
<LI>

Запустите <code>./configure</code> в каталоге <code>threads/src</code> и выберите опцию SCO
OpenServer. Эта команда скопирует <code>Makefile.SCO5</code> в <code>Makefile</code>.
<LI>

Запустите <code>make</code>.
<LI>

Для установки в каталог по умолчанию - <tt>`/usr/include'</tt> войдите в систему с
правами пользователя <code>root</code>, перейдите в каталог <code>thread/src</code> и запустите <code>make
install</code>.
</ol>

<LI>

Не забудьте использовать GNU <code>make</code> при сборке MySQL.

<LI>

При запуске <code>safe_mysqld</code> не с правами пользователя <code>root</code> вы получите
разрешение открывать одновременно только 110 файлов на процесс (это
значение установлено по умолчанию). <code>mysqld</code> сообщит об этом в файле
протокола.

<LI>

На SCO 3.2V5.0.5 вы должны использовать FSU Pthreads версии 3.5c или
выше, а также gcc 2.95.2 или более новую версию! Приведенная ниже команда
<code>configure</code> должна выполняться корректно:


<pre>
shell&#62; ./configure --prefix=/usr/local/mysql --disable-shared
</pre>

<LI>

На SCO 3.2V4.2 следует использовать FSU Pthreads версии 3.5c или выше.
Приведенная ниже команда <code>configure</code> должна выполняться корректно:


<pre>
shell&#62; CFLAGS="-D_XOPEN_XPG4" CXX=gcc CXXFLAGS="-D_XOPEN_XPG4" \
       ./configure \
       --prefix=/usr/local/mysql \
       --with-named-thread-libs="-lgthreads -lsocket -lgen -lgthreads" \
       --with-named-curses-libs="-lcurses"
</pre>

У вас могут возникнуть проблемы с некоторыми включаемыми файлами. В таком
случае новые, специфические для SCO включаемые файлы можно найти по адресу
<a HREF="http://www.mysql.com/Downloads/SCO/SCO-3.2v4.2-includes.tar.gz">http://www.mysql.com/Downloads/SCO/SCO-3.2v4.2-includes.tar.gz</a>. Этот архив
следует распаковать в каталог дерева исходных текстов MySQL с именем
<code>include</code>
</ol>

<P>
Замечания по разработке под Caldera (SCO):

</P>

<ul>
<LI>

MySQL должен автоматически обнаруживать FSU Pthreads и линковать <code>mysqld</code>
с использованием <code>-lgthreads -lsocket -lgthreads</code>.

<LI>

Библиотеки разработки в Caldera (SCO) реентрантны в FSU Pthreads.
Специалисты Caldera утверждают, что библиотечные функции Caldera
реентрантны, поэтому они должны быть реентрантны с FSU Pthreads. FSU
Pthreads на OpenServer пытаются использовать SCO-схему, чтобы создать
реентрантные библиотеки.

<LI>

FSU Pthreads (по крайней мере версия на <a HREF="http://www.mysql.com/">http://www.mysql.com/</a>)
поставляется как линкованная с GNU <code>malloc</code>. При возникновении проблем с
использованием памяти, убедитесь, что <tt>`gmalloc.o'</tt> включен в <tt>`libgthreads.a'</tt> и
<tt>`libgthreads.so'</tt>.

<LI>

В FSU Pthreads используют pthread следующие системные вызовы: <code>read()</code>,
<code>write()</code>, <code>getmsg()</code>, <code>connect()</code>, <code>accept()</code>, <code>select()</code>, and <code>wait()</code>.

<LI>

CSSA-2001-SCO.35.2 (в списках заказов патч упоминается как патч по
системе безопасности erg711905-dscr_remap) (версия 2.0.0) портит
FSU-потоки и вызывает неустойчивую работу <code>mysqld</code>. Если вы собираетесь
запускать <code>mysqld</code> на машине с установленным OpenServer 5.0.6, этот патч
применять не следует.
</ul>

<P>
Если необходимо установить DBI на Caldera (SCO), следует отредактировать
<code>Makefile</code> в DBI-xxx и каждом подкаталоге.

</P>
<P>
Для приведенного ниже кода подразумевается использование gcc 2.95.2 или
более новой версии:

</P>

<pre>
СТАРЫЙ:                               НОВЫЙ:
CC = cc                               CC = gcc
CCCDLFLAGS = -KPIC -W1,-Bexport       CCCDLFLAGS = -fpic
CCDLFLAGS = -wl,-Bexport              CCDLFLAGS =

LD = ld                               LD = gcc -G -fpic
LDDLFLAGS = -G -L/usr/local/lib       LDDLFLAGS = -L/usr/local/lib
LDFLAGS = -belf -L/usr/local/lib      LDFLAGS = -L/usr/local/lib

LD = ld                               LD = gcc -G -fpic
OPTIMISE = -Od                        OPTIMISE = -O1

OLD:
CCCFLAGS = -belf -dy -w0 -U M_XENIX -DPERL_SCO5 -I/usr/local/include

НОВЫЙ:
CCFLAGS = -U M_XENIX -DPERL_SCO5 -I/usr/local/include
</pre>

<P>
Это вызвано тем, что <code>dynaloader</code> из Perl не загружает DBI-модулей, если они
скомпилированы компиляторами <code>icc</code> или <code>cc</code>.

</P>
<P>
Perl будет работать лучше, если его скомпилировать компилятором <code>cc</code>.

</P>


<H4><A NAME="Caldera_Unixware" HREF="manual.ru_toc.html#Caldera_Unixware">2.6.6.10  Примечания к Caldera (SCO) Unixware Version 7.0</A></H4>

<P>
Вы должны использовать MySQL версий не ниже 3.22.13, поскольку в этой
версии исправлены некоторые проблемы, связанные с переносимостью под
Unixware.

</P>
<P>
Нам удалось скомпилировать MySQL следующей командой <code>configure</code> на Unixware
версии 7.0.1:

</P>

<pre>
CC=cc CXX=CC ./configure --prefix=/usr/local/mysql
</pre>

<P>
Если вы хотите использовать <code>gcc</code>, необходимо использовать <code>gcc</code> версии 2.95.2
или новее.

</P>
<P>
Caldera поставляет libsocket.so.2 с
<a HREF="ftp://stage.caldera.com/pub/security/tools">ftp://stage.caldera.com/pub/security/tools</a> для исправлений безопасности в
более ранних, чем OSR506, системах. Кроме того, исправление telnetd на
<a HREF="ftp://stage.caldera.com/pub/security/openserver/CSSA-2001-SCO.10/">ftp://stage.caldera.com/pub/security/openserver/CSSA-2001-SCO.10/</a> 
предназначено и для libsocket.so.2, и для libresolv.so.1. Там же
находятся инструкции для установки на более ранние, чем OSR506, системы.

</P>
<P>
Устанавливать вышеупомянутые патчи лучше до попытки
компиляции/использования MySQL.

</P>


<H3><A NAME="OS_2" HREF="manual.ru_toc.html#OS_2">2.6.7  Примечания к OS/2</A></H3>

<P>
В MySQL используется достаточно много открытых файлов. Поэтому в свой файл
<tt>`CONFIG.SYS'</tt> вам нужно добавить код вроде приведенного ниже:

</P>

<pre>
SET EMXOPT=-c -n -h1024
</pre>

<P>
В противном случае вы можете столкнуться со следующей ошибкой:

</P>

<pre>
File 'xxxx' not found (Errcode: 24)
</pre>

<P>
При использовании MySQL с OS/2 Warp 3 требуется FixPack 29 или выше, а с
OS/2 Warp 4 -FixPack 4 или выше. Это требуется для библиотеки Pthreads.
MySQL может быть установлен на файловой системе, поддерживающей длинные
имена, такой как HPFS, FAT32, и т.п.

</P>
<P>
Скрипт <tt>`INSTALL.CMD'</tt> должен запускаться из собственной оболочки OS/2 -
<tt>`CMD.EXE'</tt>; и может не работать в заменяющих ее оболочках, таких как
<tt>`4OS2.EXE'</tt>.

</P>
<P>
Скрипт <tt>`scripts/mysql-install-db'</tt> был переименован. Теперь он называется
<tt>`install'</tt>.cmd и является REXX-скриптом, который задает установки
безопасности MySQL по умолчанию и создает иконку WorkPlace Shell для
MySQL.

</P>
<P>
Поддержка динамических модулей скомпилирована, но полностью не проверена.
Динамические модули должны быть скомпилированы с использованием
динамической библиотеки Pthreads.

</P>

<pre>
gcc -Zdll -Zmt -Zcrtdll=pthrdrtl -I../include -I../regex -I.. \
    -o example udf_example.cc -L../lib -lmysqlclient udf_example.def
mv example.dll example.udf
</pre>

<P>
<strong>Примечание</strong>: в соответствии с ограничениями OS/2 размер основной части имен
модулей UDF не должен превышать 8-ми символов. Модули хранятся в каталоге
<tt>`/mysql2/udf'</tt>; скрипт s<tt>`afe-mysqld.cmd'</tt> помещает путь к этому каталогу в
переменную окружения <code>BEGINLIBPATH</code>. При использовании UDF-модулей
определенные расширения игнорируются - они все принимаются как <tt>`.udf'</tt>.
Например, в Unix динамический модуль может иметь имя <tt>`example.so'</tt> и функция
из него будет загружаться следующим образом:

</P>

<pre>
mysql&#62; CREATE FUNCTION metaphon RETURNS STRING SONAME "example.so";
</pre>

<P>
В OS/2 модуль будет иметь имя <tt>`example.udf'</tt>, но вы не должны определять
расширение модуля:

</P>

<pre>
mysql&#62; CREATE FUNCTION metaphon RETURNS STRING SONAME "example";
</pre>



<H3><A NAME="BeOS" HREF="manual.ru_toc.html#BeOS">2.6.8  Примечания к BeOS</A></H3>

<P>
Мы заинтересованы в том, чтобы MySQL работал в BeOS, но, к сожалению,
среди нас нет никого, кто знал бы BeOS или обладал временем для создания
портированной версии.

</P>
<P>
Если найдутся желающие создать портированную версию, то мы готовы оказать
им помощь в решении любых технических вопросов, которые могут возникнуть
при создании портированной версии.

</P>
<P>
У нас было предварительное общение с некоторыми разработчиками BeOS,
утверждавших, что на 80% создана портированная версия MySQL под BeOS,
однако уже на протяжении длительного времени мы не получали от них никаких
известий.

</P>


<H3><A NAME="Novell_Netware" HREF="manual.ru_toc.html#Novell_Netware">2.6.9  Примечания к Novell NetWare</A></H3>

<P>
Мы заинтересованы в том, чтобы MySQL работал на Novell NetWare, но, к
сожалению, среди нас нет никого, кто достаточно хорошо разбирался бы в
NetWare или обладал временем для создания портированной версии.

</P>
<P>
Мы хотели бы найти желающих создать портированную версию и готовы помочь
им в решении любых технических вопросов, которые могут возникнуть при
работе над ней.

</P>


<H2><A NAME="Perl_support" HREF="manual.ru_toc.html#Perl_support">2.7  Замечания по установке Perl</A></H2>

<P>
<A NAME="IDX352"></A>
<A NAME="IDX353"></A>

</P>



<H3><A NAME="Perl_installation" HREF="manual.ru_toc.html#Perl_installation">2.7.1  Установка Perl на Unix</A></H3>

<P>
Поддержка Perl для MySQL обеспечивается средствами клиентского интерфейса
<code>DBI</code>/<code>DBD</code>. See section <A HREF="manual.ru_Clients.html#Perl">8.2  Интерфейс Perl  API для MySQL</A>. Для клиентского кода Perl <code>DBD</code>/<code>DBI</code>
требуется версия Perl 5.004 или выше. При использовании более старой
версии Perl данный интерфейс <strong>не будет работать</strong>.

</P>
<P>
Для поддержки Perl в MySQL также требуется, чтобы была установлена
программная поддержка клиентов MySQL. Если вы установили MySQL из файлов
RPM, то клиентские программы находятся в RPM-пакете <code>MySQL-client</code>, а их
программная поддержка - в RPM-пакете <code>MySQL-devel</code>. Убедитесь, что у вас
установлена последняя версия RPM.

</P>
<P>
С версии 3.22.8 поддержка Perl поставляется отдельно от основного
дистрибутива MySQL. Если вы хотите установить поддержку Perl, то
необходимые файлы можно получить с
<a HREF="http://www.mysql.com/downloads/api-dbi.html">http://www.mysql.com/downloads/api-dbi.html</a>.

</P>
<P>
Дистрибутивы Perl поставляются  как  сжатые tar-архивы  с  именами 
наподобие <tt>`MODULE-VERSION.tar.gz'</tt>, где <code>MODULE</code> - имя модуля и <code>VERSION</code>
- номер  версии. Необходимо взять дистрибутивы <code>Data-Dumper</code>, <code>DBI</code> и
<code>Msql-Mysql-modules</code> и установить их в указанном порядке. Процедура
установки приведена ниже. Показанный пример приведен для модуля
<code>Data-Dumper</code>, но сама процедура одинакова для всех трех дистрибутивов:

</P>

<ol>
<LI>

Распакуйте дистрибутив в текущем каталоге:

<pre>
shell&#62; gunzip &#60; Data-Dumper-VERSION.tar.gz | tar xvf -
</pre>

Эта команда создает каталог с именем <tt>`Data-Dumper-VERSION'</tt>.

Перейдите в каталог, куда распаковался дистрибутив:

<pre>
shell&#62; cd Data-Dumper-VERSION
</pre>

Соберите дистрибутив и скомпилируйте:

<pre>
shell&#62; perl Makefile.PL
shell&#62; make
shell&#62; make test
shell&#62; make install
</pre>

</ol>

<P>
Команда <code>make test</code> является важной, поскольку она проверяет, работает ли
модуль. Следует учитывать, что если эта команда выполняется во время
установки <code>Msql-Mysql-modules</code> для проверки кода интерфейса, то сервер MySQL
при этом должен работать, или же данный тест потерпит неудачу.

</P>
<P>
Каждый раз при установке нового выпуска MySQL полезно создать заново и
переустановить дистрибутив <code>Msql-Mysql-modules</code>, особенно если замечаются
такие симптомы, как смерть скриптов <code>DBI</code> после модернизации MySQL (имеется
в виду coredump).

</P>
<P>
Если вы не обладаете правами установки модулей Perl в системном каталоге
или локальных модулей Perl, то для вас окажется полезной следующая ссылка:

</P>
<P>
<a HREF="http://www.iserver.com/support/contrib/perl5/modules.html">http://www.iserver.com/support/contrib/perl5/modules.html</a> 

</P>
<P>
Следует смотреть в рубрике <code>Installing New Modules that Require Locally
Installed Modules</code>.

</P>


<H3><A NAME="ActiveState_Perl" HREF="manual.ru_toc.html#ActiveState_Perl">2.7.2  Установка ActiveState Perl на Windows</A></H3>

<P>
<A NAME="IDX354"></A>
<A NAME="IDX355"></A>
<A NAME="IDX356"></A>

</P>
<P>
Для установки модуля <code>DBD</code> для MySQL под ActiveState Perl на Windows
необходимо выполнить следующие действия:

</P>

<ul>
<LI>

Получить ActiveState Perl с 
<a HREF="http://www.activestate.com/Products/ActivePerl/">http://www.activestate.com/Products/ActivePerl/</a> и установить его.
<LI>

Открыть оболочку DOS.
<LI>

Если это необходимо, то установить переменную HTTP_proxy. Например,
можно попытаться сделать следующее:


<pre>
set HTTP_proxy=my.proxy.com:3128
</pre>

<LI>

Запустить программу PPM:


<pre>
C:\&#62; c:\perl\bin\ppm.pl
</pre>

<LI>

Установить <code>DBI</code>, если этого еще не сделано:


<pre>
ppm&#62; install DBI
</pre>

<LI>

Если все прошло успешно, то запустить следующую команду:


<pre>
install \
ftp://ftp.de.uu.net/pub/CPAN/authors/id/JWIED/DBD-mysql-1.2212.x86.ppd
</pre>

</ul>

<P>
Эти команды должны работать по крайней мере с версией ActiveState Perl
5.6.

</P>
<P>
Если приведенные выше команды у вас не работают, то вместо этого
необходимо установить драйвер <code>MyODBC</code> и подключить сервер MySQL через ODBC:

</P>

<pre>
use DBI;
$dbh= DBI-&#62;connect("DBI:ODBC:$dsn","$user","$password") ||
  die "Got error $DBI::errstr when connecting to $dsn\n";
</pre>



<H3><A NAME="Windows_Perl" HREF="manual.ru_toc.html#Windows_Perl">2.7.3  Установка дистрибутива Perl для MySQL на Windows</A></H3>

<P>
Дистрибутив Perl для MySQL содержит <code>DBI</code>, <code>DBD:MySQL</code> и <code>DBD:ODBC</code>.

</P>

<ul>
<LI>

Загрузите дистрибутив Perl для Windows с
<a HREF="http://www.mysql.com/downloads/os-win32.html">http://www.mysql.com/downloads/os-win32.html</a>.
<LI>

Разархивируйте дистрибутив в <code>C:</code>, в результате чего вы получите
каталог <tt>`C:\PERL'</tt>.
<LI>

Добавьте в ваш путь каталог <tt>`C:\PERL\BIN'</tt>.
<LI>

Добавьте в ваш путь каталог <tt>`C:\PERL\BIN\MSWIN32-x86-thread'</tt> или
<tt>`C:\PERL\BIN\MSWIN32-x86'</tt>.
<LI>

Протестируйте работу <code>perl</code>, выполнив  команду <code>perl -v</code> в оболочке DOS.
</ul>



<H3><A NAME="Perl_support_problems" HREF="manual.ru_toc.html#Perl_support_problems">2.7.4  Проблемы использования интерфейса Perl <code>DBI</code>/<code>DBD</code></A></H3>

<P>
<A NAME="IDX357"></A>
<A NAME="IDX358"></A>

</P>
<P>
Если Perl сообщает, что не может найти модуль <tt>`../mysql/mysql.so'</tt>, то
проблема, возможно, заключается в том, что Perl не может найти
динамическую библиотеку <tt>`libmysqlclient.so'</tt>.

</P>
<P>
Эту проблему можно устранить, используя любой из следующих методов:

</P>

<ul>
<LI>

Для сборки дистрибутива <code>Msql-Mysql-modules</code> используйте <code>perl
Makefile.PL -static -config</code> вместо <code>perl Makefile.PL</code>.
<LI>

Скопируйте <tt>`libmysqlclient.so'</tt> в каталог, где находятся другие
динамические библиотеки (<tt>`/usr/lib'</tt> или <tt>`/lib'</tt>).
<LI>

Под Linux можно добавить путь к каталогу, где находится
<tt>`libmysqlclient.so'</tt> в файл <tt>`/etc/ld.so.conf'</tt>.

<A NAME="IDX359"></A>
<A NAME="IDX360"></A>

<LI>

Добавьте каталог, в котором находится <tt>`libmysqlclient.so'</tt>, в
переменную окружения <code>LD_RUN_PATH</code>.
</ul>

<P>
Если вы получаете от <code>DBD-mysql</code> представленные ниже ошибки, то, скорее
всего, у вас используется компилятор <code>gcc</code> (или старый бинарный код,
скомпилированный с <code>gcc</code>):

</P>

<pre>
/usr/bin/perl: can't resolve symbol '__moddi3'
/usr/bin/perl: can't resolve symbol '__divdi3'
</pre>

<P>
Добавьте  в  команду  линкования  при  сборке  библиотеки <tt>`mysql.so'</tt>, 
<code>-L/usr/lib/gcc-lib/... -lgcc</code> (нужно проверить вывод из <code>make</code> для 
<tt>`mysql.so'</tt> при компиляции клиента Perl). Опция <code>-L</code> должна указывать путь
к каталогу, где находится <tt>`libgcc.a'</tt> в вашей системе.

</P>
<P>
Еще одна причина появления ошибок может заключаться в том, что оба модуля
- Perl и MySQL не скомпилированы вместе компилятором <code>gcc</code>. В этом случае
данное несоответствие можно устранить, скомпилировав оба модуля
компилятором <code>gcc</code>.

</P>
<P>
Если при выполнении тестов вы получаете от модуля <code>Msql-Mysql-modules</code> 
следующие ошибки:

</P>

<pre>
t/00base............install_driver(mysql) failed:
Can't load '../blib/arch/auto/DBD/mysql/mysql.so' for module DBD::mysql:
../blib/arch/auto/DBD/mysql/mysql.so: undefined symbol:
uncompress at /usr/lib/perl5/5.00503/i586-linux/DynaLoader.pm line 169,
</pre>

<P>
то это означает, что в строку линкования необходимо включить библиотеку
сжатия <code>-lz</code>. Для этого необходимо внести следующее изменение в файл
<tt>`lib/DBD/mysql/Install.pm'</tt>:

</P>

<pre>
$sysliblist .= " -lm";

на

$sysliblist .= " -lm -lz";
</pre>

<P>
После этого необходимо выполнить команду <code>make realclean</code> и затем
повторить процесс инсталляции сначала.

</P>
<P>
Если вы хотите использовать эти модули в системе, которая не поддерживает
динамического линкования (вроде Caldera/SCO), то можно сгенерировать
статическую версию Perl, включающую <code>DBI</code> и <code>DBD-mysql</code>. Она будет работать
следующим образом: нужно создать версию Perl, слинкованную с кодом <code>DBI</code>, и
установить ее поверх текущего Perl. Затем эта версия используется для
сборки версии Perl, которая дополнительно включает слинкованный код DBD, <code>и</code>
устанавливается уже она.

</P>
<P>
В операционной системе Caldera (SCO) необходимо иметь следующий набор
переменных окружения:

</P>

<pre>
shell&#62; LD_LIBRARY_PATH=/lib:/usr/lib:/usr/local/lib:/usr/progressive/lib
или
shell&#62; LD_LIBRARY_PATH=/usr/lib:/lib:/usr/local/lib:/usr/ccs/lib:\
       /usr/progressive/lib:/usr/skunk/lib
shell&#62; LIBPATH=/usr/lib:/lib:/usr/local/lib:/usr/ccs/lib:\
       /usr/progressive/lib:/usr/skunk/lib
shell&#62; MANPATH=scohelp:/usr/man:/usr/local1/man:/usr/local/man:\
       /usr/skunk/man:
</pre>

<P>
Вначале следует создать модуль Perl, включающий статически слинкованный
<code>DBI</code>. Это делается  путем выполнения следующих команд в каталоге, где
располагается дистрибутив <code>DBI</code>:

</P>

<pre>
shell&#62; perl Makefile.PL -static -config
shell&#62; make
shell&#62; make install
shell&#62; make perl
</pre>

<P>
Затем необходимо установить новый модуль Perl. Вывод команды <code>make perl</code> 
укажет точную команду <code>make</code>, которую необходимо будет выполнить для
завершения установки. Для Caldera (SCO) это  будет  команда  <code>make -f 
Makefile.aperl inst_perl MAP_TARGET=perl</code>.

</P>
<P>
Затем нужно использовать только что созданный модуль Perl для создания еще
одного модуля Perl, который также включает в себя статически слинкованный
модуль <code>DBD::mysql</code>. Это делается путем выполнения следующих команд в
каталоге, где располагается дистрибутив <code>Msql-Mysql-modules</code>:

</P>

<pre>
shell&#62; perl Makefile.PL -static -config
shell&#62; make
shell&#62; make install
shell&#62; make perl
</pre>

<P>
И в завершение осталось установить этот новый модуль Perl. Какую команду
для этого использовать, вы опять узнаете из вывода <code>make perl</code>.
<P><HR><P>
Go to the <A HREF="manual.ru_Introduction.html">first</A>, <A HREF="manual.ru_Introduction.html">previous</A>, <A HREF="manual.ru_Tutorial.html">next</A>, <A HREF="manual.ru_Concept_Index.html">last</A> section, <A HREF="manual.ru_toc.html">table of contents</A>.
 </BODY>
 </HTML>
