<!doctype HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><html><head><TITLE>Сообщение об Ошибке</TITLE>
<meta http-equiv="Content-Language" content="ru"><meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<LINK REL="stylesheet" HREF="style.css"></HEAD>
<body><TABLE BORDER="0" WIDTH="100%" HEIGHT="100%"><TR><TD COLSPAN="3">
<TABLE BGCOLOR="#CCCCFF" BORDER="0" WIDTH="100%"><TR><TD><TABLE WIDTH="100%" BORDER="0" CELLPADDING="3"><TR>
<TH COLSPAN="3">Учебник РНР</TH></TR><TR><TD WIDTH="10%">
<A HREF="database.html">Назад</A></TD><th WIDTH="80%">Глава 4. Безопасность</th>
<TD WIDTH="10%" ALIGN="right"><A HREF="registerglobals.html">Вперёд</A></TD></TR></TABLE></TD></TR><TR BGCOLOR="#333366"><TD>
<IMG SRC="imag/spacer.gif" BORDER="0" width="1" height="1"><BR></TD></TR></TABLE></TD></TR><TR><TD><IMG SRC="imag/spacer.gif" WIDTH="10" HEIGHT="1"></TD>
<TD HEIGHT="100%" VALIGN="TOP" WIDTH="100%"><H1><a name="security.errors">Сообщение об ошибке</a></H1>
<P>При использовании системы безопасности PHP имеются две стороны сообщения об ошибках.<br>
Одна это преимущества от повышения уровня безопасности, другая - вред.</P>
<P>Стандартная тактика нападения включает профилирование системы для введения 
в неё несоответствующих данных и проверка вида ошибок и контекста, в котором 
они возвращаются. Это даёт взломщику системы возможность испробовать 
информацию о сервере для определения возможных дыр.
Например, если взломщик собрал информацию о странице на основе предыдущей 
отправки формы, он может попытаться переопределить значения или модифицировать их:<TABLE WIDTH="100%" BORDER="0"><TR><TD>
<h5><A NAME="AEN3279"></A>Пример 4-11. Атака на переменные HTML-страницей</h5><TABLE BORDER="0" BGCOLOR="#E0E0E0" CELLPADDING="5">
<TR><TD><PRE>&#60;form method="post" action="attacktarget?username=badfoo&#38;password=badfoo"&#62;
&#60;input type="hidden" name="username" value="badfoo"&#62;
&#60;input type="hidden" name="password" value="badfoo"&#62;
&#60;/form&#62;</PRE></TD></TR></TABLE></TD></TR></TABLE>
<P>Ошибки PHP, которые нормально возвращаются, могут помочь разработчику при 
отладке скриптов, указывая на такие вещи, как неудачно выполненная функция или файл PHP, в котором была неудача,
и номер строки, в которой возникла ошибка. Эта информация и будет использоваться.<br>
Для разработчика php привычно использовать <A HREF="f/show-source.html"><B>show_source()</B></A>,
<A HREF="f/highlight-string.html"><B>highlight_string()</B></A> или
<A HREF="f/highlight-file.html"><B>highlight_file()</B></A> как средство отладки,
но на действующем сайте это может обнаружить скрытые 
переменные, непроверяемый синтаксис и другую опасную информацию. Особенно 
опасно запускать код из известных источников со встроенными обработчиками 
отладки или использовать обычную технику отладки. Если хакер сможет 
определить, какую технику вы используете, он может попытаться грубо форсировать страницу,
отправляя разные обычные строки отладки:<TABLE WIDTH="100%" BORDER="0"><TR><TD><h5><A NAME="AEN3286"></A>Пример 4-12. Использование обычных переменных отладки</h5>
<TABLE BORDER="0" BGCOLOR="#E0E0E0" CELLPADDING="5"><TR><TD><PRE>&#60;form method="post" action="attacktarget?errors=Y&#38;amp;showerrors=1"&#38;debug=1"&#62;
&#60;input type="hidden" name="errors" value="Y"&#62;
&#60;input type="hidden" name="showerrors" value="1"&#62;
&#60;input type="hidden" name="debug" value="1"&#62;
&#60;/form&#62;</PRE></TD></TR></TABLE></TD></TR></TABLE></P>
<P>Независимо от метода обработки ошибок, возможность проверки системы на 
наличие ошибок приведёт к снабжению хакера дополнительной информацией.</P>
<P>Например, стиль общей PHP-ошибки указывает систему, на которой запущен PHP. 
Если хакер просмотрит .html-страницу и захочет проверить её (найти известные 
утечки в системе), заполнив её неправильными данными, он сможет определить, что система построена с PHP.</P>
<P>Ошибка функции может указать, запущена ли на системе конкретная машина БД, 
или дать ключ к тому, как web-страница сконструирована или запрограммирована. 
Это позволит глубоко внедриться в открытый порт БД или найти специфический bug или утечку в web-странице.<br>
Вводя разные блоки неверных данных, например, хакер может определить порядок 
аутентификации в скрипте (по номерам строк с ошибками), а также попробовать 
использовать то, что может иметься в разных частях скрипта.</P>
<P>Ошибка файловой системы или общая ошибка PHP может указать на то, какие 
привилегии имеет web-сервер, а также на структуру и организацию файлов на web-сервере. 
Записанный разработчиком код ошибки может усугубить эту проблему, приведя к 
лёгкому способу использования ранее "скрытой" информации.</P>
<P>Есть три основных способа решения этой проблемы:<br>
<br>
Первый - структурировать все функции и попытаться компенсировать объём ошибок.<br>
Второй - полностью отключить в работающем коде сообщения об ошибках.<br>
Третий - использовать специальные функции PHP по обработке ошибок для создания вашего собственного обработчика ошибок.<br>
<br>
В зависимости от используемой вами политики безопасности, вы может применить все три способа в вашей ситуации.</P>
<P>Одним из способов решения этой проблемы является использование собственного
<B> <A HREF="f/error-reporting.html">error_reporting()</A></B> РНР, чтобы помочь вам обезопасить ваш код и 
скрыть использование переменных, которое может представлять опасность. Тестируя ваш код с помощью E_ALL до публикации, вы сможете быстро обнаружить 
области, где ваши переменные могут оказаться открытыми для модификации другими 
способами. Если вы уже готовы опубликовать,
используя E_NONE вы отключите возможность проверки вашего кода.<TABLE WIDTH="100%" BORDER="0"><TR><TD>
<h5>
<A NAME="AEN3296"></A>Пример 4-13. Обнаружение опасных переменных с помощью E_ALL</h5>
<TABLE BORDER="0" BGCOLOR="#E0E0E0" CELLPADDING="5"><TR><TD><PRE>&#60;?php
if ($username) {  // не инициализируется или проверяется перед использованием
    $good_login = 1;
}
if ($good_login == 1) { // Если предыдущий тест терпит неудачу, не инициализируется
			//или проверяется перед использованием
    fpassthru ("/highly/sensitive/data/index.html");
}
?&#62;</PRE></TD></TR></TABLE></TD></TR></TABLE>
</TD><TD><IMG SRC="imag/spacer.gif" WIDTH="10" HEIGHT="1"></TD></TR><TR><TD COLSPAN="3">
<TABLE BGCOLOR="#CCCCFF" BORDER="0" WIDTH="100%"><TR BGCOLOR="#333366"><TD>
<IMG SRC="imag/spacer.gif" BORDER="0" width="1" height="1"><BR></TD></TR><TR><TD>
<TABLE WIDTH="100%" BORDER="0" CELLPADDING="3"><TR><TD WIDTH="33%" VALIGN="top">
<A HREF="database.html">Назад</A></TD><th WIDTH="34%" VALIGN="top">
<A HREF="index.html">Оглавление</A></th><TD WIDTH="33%" ALIGN="right" VALIGN="top">
<A HREF="registerglobals.html">Вперёд</A></TD></TR><TR><TD WIDTH="33%" VALIGN="top">Безопасность БД</TD>
<th WIDTH="34%" VALIGN="top"><a href="security.html">Вверх</a></th><TD WIDTH="33%" ALIGN="right" VALIGN="top">Использование Register_Globals</TD>
</TR></TABLE></TD></TR></TABLE></TD></TR></TABLE></BODY></HTML>