<!doctype HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><html><head><meta http-equiv="Content-Language" content="ru"><meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<TITLE>PHP и COM</TITLE>
<LINK REL="stylesheet" HREF="style.css"></HEAD>
<body><TABLE BORDER="0" WIDTH="100%" HEIGHT="100%"><TR><TD COLSPAN="3">
<TABLE BGCOLOR="#CCCCFF" BORDER="0" WIDTH="100%"><TR><TD><TABLE WIDTH="100%" BORDER="0" CELLPADDING="3">
<TR><TH COLSPAN="3">Учебник РНР</TH></TR><TR><TD WIDTH="10%">
<A HREF="html.html">Назад</A></TD><TD WIDTH="80%"></TD>
<TD WIDTH="10%" ALIGN="right"><A HREF="languages.html">Вперёд</A></TD></TR></TABLE>
</TD></TR><TR BGCOLOR="#333366"><TD><IMG SRC="imag/spacer.gif" BORDER="0" width="1" height="1"><BR>
</TD></TR></TABLE></TD></TR><TR><TD><IMG SRC="imag/spacer.gif" WIDTH="10" HEIGHT="1"></TD>
<TD HEIGHT="100%" VALIGN="TOP" WIDTH="100%"><H1><A NAME="faq.com">Глава 52. PHP 
и COM</A></H1><P>PHP может использоваться для доступа к COM и DCOM-объектам на платформе Win32.</P><DL>
<DT>1. <A HREF="#faq.com.q1">Я построил DLL для расчётов. Есть ли способ запустить эту DLL под PHP ?</A></DT>
<DT>2. <A HREF="#faq.com.q2">Что означает 'Unsupported variant type: xxxx (0xxxxx)' ?</A></DT>
<DT>3. <A HREF="#faq.com.q3">Можно ли манипулировать визуальными объектами в PHP ?</A></DT>
<DT>4. <A HREF="#faq.com.q4">Могу ли я сохранить COM-объект в сессии ?</A></DT>
<DT>5. <A HREF="#faq.com.q5">Как я могу отловить COM-ошибки ?</A></DT>
<DT>6. <A HREF="#faq.com.q6">Могу ли я генерировать DLL-файлы в PHP-скриптах, как я это делаю в Perl ?</A></DT>
<DT>7. <A HREF="#faq.com.q7">Что означает 'Unable to obtain IDispatch interface for CLSID {xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx}' ?</A></DT>
<DT>8. <A HREF="#faq.com.q8">Как я могу запустить COM-объект с удалённого сервера ?</A></DT>
<DT>9. <A HREF="#faq.com.q9">Я получил 'DCOM is disabled in C:\path...\scriptname.php on line 6', что я могу сделать ?</A></DT>
<DT>10. <A HREF="#faq.com.q10">Можно ли загрузить/манипулировать ActiveX-объектом на странице с помощью РНP ?</A></DT>
<DT>11. <A HREF="#faq.com.q11">Можно ли получить работающий экземпляр компонента ?</A></DT>
<DT>12. <A HREF="#faq.com.q12">Есть ли способ обработать событие, посланное от COM-объекта ?</A></DT>
<DT>13. <A HREF="#faq.com.q13">У меня появились проблемы при попытке вызвать метод COM-объекта, имеющего 
не один интерфейс. Что можно предпринять ?</A></DT>
<DT>14. <A HREF="#faq.com.q14">Итак, PHP работает COM, а как насчёт COM+ ?</A></DT>
<DT>15. <A HREF="#faq.com.q15">Если PHP может манипулировать COM-объектами, можно ли представить 
использование MTS для обслуживания ресурсов компонентов в соединении с PHP ?</A></DT>
</DL><B><P><A NAME="faq.com.q1"></A>
<B>1. </B>Я построил DLL для расчётов. Есть ли способ запустить эту DLL под PHP ?</P></B>
<P>Если это простая DLL, то пока нет способа запустить её из PHP. Если DLL-библиотека 
содержит COM-сервер, вы можете получить к ней доступ, если она реализует интерфейс IDispatch.</P>
<B><P><A NAME="faq.com.q2"></A><B>2. </B>Что означает 'Unsupported variant type: xxxx (0xxxxx)' ?</P></B>
<P>Имеются десятки типов VARIANT и их комбинаций. Большинство из них уже 
поддерживается, но некоторые ещё ждут своей реализации.
Массивы поддерживаются неполностью. Только одномерные массивы можно передавать между PHP и COM.
Если вы обнаружили другие типы, которые не поддерживаются, сообщите, 
пожалуйста, о них как о bug (если это ещё не сделано) и предоставьте как можно более подробную информацию.</P>
<B><P><A NAME="faq.com.q3"></A><B>3. </B>Можно ли манипулировать визуальными объектами в PHP ?</P></B>
<P>Вообще-то да, но, поскольку PHP в основном используется как язык web-скриптинга, 
он работает в контексте web-серверов; таким образом, визуальные объекты 
никогда не появляются на рабочем столе серверов.
Если вы используете PHP для скриптинга приложений, например, в соединении 
с PHP-GTK, нет никаких ограничений при доступе и манипуляциях с визуальными объектами через COM.</P>
<B><P><A NAME="faq.com.q4"></A><B>4. </B>Могу ли я сохранить COM-объект в сессии ?</P></B>
<P>Нет, не можете. COM-экземпляры рассматриваются как ресурсы, и поэтому они могут 
быть доступны только в контексте отдельного скрипта.</P>
<B><P><A NAME="faq.com.q5"></A><B>5. </B>Как я могу отловить COM-ошибки ?</P></B>
<P>В настоящее время невозможно отлавливать COM-ошибки другими способами, помимо 
тех, которые предоставлены в самом PHP (@, track_errors, ..), но мы думаем над реализацией этого.</P>
<B><P><A NAME="faq.com.q6"></A><B>6. </B>Могу ли я генерировать DLL-файлы в PHP-скриптах, как я это делаю в Perl ?</P></B>
<P>Нет, к сожалению, такой утилиты для PHP нет.</P>
<B><P><A NAME="faq.com.q7"></A><B>7. </B>Что означает 'Unable to obtain IDispatch interface for CLSID {xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx}' ?</P></B>
<P>Эта ошибка может появиться по разным причинам:<UL><LI><P>неправильный CLSID</P></LI>
<LI><P>запрошенная DLL отсутствует</P></LI><LI><P>запрошенный компонент не реализует интерфейс IDispatch</P></LI>
</UL><B><P><A NAME="faq.com.q8"></A><B>8. </B>Как я могу запустить COM-объект с удалённого сервера ?</P></B>
<P>Точно так же, как вы запускаете локальные объекты. Вы только должны передать IP 
удалённой машины как второй параметр COM-конструктору.</P>
<P>Убедитесь, что вы установили <TT>com.allow_dcom=true</TT> в вашем <TT>php.ini</TT>.</P>
<B><P><A NAME="faq.com.q9"></A ><B>9. </B>Я получил 'DCOM is disabled in C:\path...\scriptname.php on line 6', что я 
могу сделать ?</P></B><P>Отредактируйте ваш <TT>php.ini</TT> и установите <TT>com.allow_dcom=true</TT>.</P>
<B><P><A NAME="faq.com.q10"></A><B>10. </B>Можно ли загрузить/манипулировать ActiveX-объектом на странице с помощью РНP ?</P></B>
<P>В PHP ничего сделать нельзя. ActiveX-объекты загружаются на стороне клиента, 
если запрашиваются HTML-документом. Никакой связи с PHP-скриптом нет, и, 
следовательно, нет возможности прямого взаимодействия на сервере.</P>
<B><P><A NAME="faq.com.q11"></A><B>11. </B>Можно ли получить работающий экземпляр компонента ?</P></B>
<P>Это можно сделать с помощью клички/moniker. Если вы хотите получить несколько 
ссылок на один экземпляр word, вы можете создать этот экземпляр так:</P>
<TABLE BORDER="0" BGCOLOR="#E0E0E0" CELLPADDING="5"><TR><TD><PRE>$word = new COM("C:\docs\word.doc");</PRE>
</TD></TR></TABLE><P>Это создаст новый экземпляр, если нет доступного работающего экземпляра, 
или буде возвращён дескриптор/handle работающего экземпляра, если он имеется.</P>
<B><P><A NAME="faq.com.q12"></A><B>12. </B>Есть ли способ обработать событие, посланное от COM-объекта ?</P></B>
<P>Пока нет.</P><B><P><A NAME="faq.com.q13"></A><B>13. </B>У меня появились проблемы при попытке вызвать метод COM-объекта, имеющего 
не один интерфейс. Что можно предпринять ?</P></B><P>Ни шиша. Я точно не знаю, но думаю, что ничего.
Если кто-нибудь имеет информацию об этом, пожалуйста, дайте <a href="mailto:harald.radi@nme.at">мне</a> знать.</P>
<B><P><A NAME="faq.com.q14"></A><B>14. </B>Итак, PHP работает COM, а как насчёт COM+ ?</P></B>
<P>COM+ расширяет COM с помощью каркаса для обслуживания компонентов через MTS 
и MSMQ, но нет ничего специального для обслуживания таких компонентов в PHP.</P>
<B><P><A NAME="faq.com.q15"></A><B>15. </B>Если PHP может манипулировать COM-объектами, можно ли представить 
использование MTS для обслуживания ресурсов компонентов в соединении с PHP ?</P></B>
<P>Сам PHP ещё не может обслуживать транзакции. Таким образом, если возникает 
ошибка, откат не инициируется. Если вы используете компоненты, которые 
поддерживают транзакции, вам нужно будет реализовать обслуживание транзакций 
самостоятельно.</P></TD><TD><IMG SRC="imag/spacer.gif" WIDTH="10" HEIGHT="1"></TD></TR><TR><TD COLSPAN="3">
<TABLE BGCOLOR="#CCCCFF" BORDER="0" WIDTH="100%"><TR BGCOLOR="#333366"><TD>
<IMG SRC="imag/spacer.gif" BORDER="0" width="1" height="1"><BR></TD></TR><TR><TD>
<TABLE WIDTH="100%" BORDER="0" CELLPADDING="3"><TR><TD WIDTH="33%" VALIGN="top">
<A HREF="html.html">Назад</A></TD><th WIDTH="34%" VALIGN="top">
<A HREF="index.html">Оглавление</A></th><TD WIDTH="33%" ALIGN="right" VALIGN="top">
<A HREF="languages.html">Вперёд</A></TD></TR><TR><TD WIDTH="33%" VALIGN="top">PHP и HTML</TD>
<th WIDTH="34%" VALIGN="top"><a href="faq.html">Вверх</a></th><TD WIDTH="33%" ALIGN="right" VALIGN="top">
PHP и другие языки</TD></TR></TABLE></TD></TR></TABLE></TD></TR></TABLE>
</BODY></HTML>