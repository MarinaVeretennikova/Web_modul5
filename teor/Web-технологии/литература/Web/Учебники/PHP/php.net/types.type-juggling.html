<!doctype HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><html><head><meta http-equiv="Content-Language" content="ru"><meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<TITLE>Трюки с Типами</TITLE>
<LINK REL="stylesheet" HREF="style.css"></HEAD>
<body><TABLE BORDER="0" WIDTH="100%" HEIGHT="100%"><TR><TD COLSPAN="3">
<TABLE BGCOLOR="#CCCCFF" BORDER="0" WIDTH="100%"><TR><TD>
<TABLE WIDTH="100%" BORDER="0" CELLPADDING="3"><TR><TH COLSPAN="3">Учебник РНР</TH></TR><TR>
<TD WIDTH="10%"><A HREF="types.null.html">Назад</A></TD>
<th WIDTH="80%">Глава 6. Типы</th><TD WIDTH="10%" ALIGN="right">
<A HREF="variables.html">Вперёд</A></TD></TR></TABLE></TD></TR><TR BGCOLOR="#333366"><TD>
<IMG SRC="imag/spacer.gif" BORDER="0" width="1" height="1"><BR></TD></TR></TABLE></TD></TR><TR><TD>
<IMG SRC="imag/spacer.gif" WIDTH="10" HEIGHT="1"></TD><TD HEIGHT="100%" VALIGN="TOP" WIDTH="100%">
<H1><a name="language.types.type-juggling">Трюки с типами</a></H1>
<P>PHP не требует (и не поддерживает) явного определения типа при объявлении 
переменной; тип переменной определяется по контексту, в котором она 
используется. То есть, если вы присваиваете строковое значение переменной <TT><I>var</I></TT>,
<TT><I>var</I></TT> становится строкой. Если вы затем присваиваете переменной <TT><I>var</I></TT>
целочисленное значение, она становится целым числом.</P>
<P>Примером автоматической конвертации в PHP является операция сложения '+'. 
Если любой из операндов float, то все операнды вычисляются как float, и результат также будет
float. Если же операнды интерпретируются как целые числа, то и результат будет целочисленным.<br>
Обратите внимание, что при этом НЕ изменяются типы самих операндов; это 
делается только на этапе вычисления операндов.</p><A NAME="AEN3983"></A><TABLE BORDER="0" BGCOLOR="#E0E0E0" CELLPADDING="5"><TR><TD>
<PRE>$foo = "0";  // $foo это строка (ASCII 48)

$foo += 2;   // теперь $foo это integer (2)
$foo = $foo + 1.3;  // теперь $foo это float (3.3)
$foo = 5 + "10 Little Piggies"; // $foo это integer (15)
$foo = 5 + "10 Small Pigs";     // $foo это integer (15)</PRE></TD></TR></TABLE>
<P>Если последние два примера непонятны, см.
<a href="types.string.html#language.types.string.conversion"> Конвертация строк</a>.</P>
<P>Если вы хотите форсировать вычисление переменной как имеющей определённый тип,
см. раздел <a href="#language.types.typecasting">Приведение типов</a>. Если вы хотите изменить тип переменной, см.
<A HREF="f/settype.html"><B>settype()</B></A>.</P>
<P>Если вы хотите протестировать любой из примеров этого раздела, вы можете использовать функцию
<A HREF="f/var-dump.html"><B>var_dump()</B></A>.</P><BLOCKQUOTE><P><B>Примечание: </B>
  поведение автоматической конвертации для массива в настоящее время не определено.</p><A NAME="AEN3994"></A><TABLE BORDER="0" BGCOLOR="#E0E0E0" CELLPADDING="5"><TR><TD>
<PRE>$a = 1;       // $a это integer
$a[0] = "f";  // $a становится массивом, а $a[0] содержит "f"</PRE></TD></TR></TABLE>
<P>Предыдущий пример кажется похожим на следующий, делая
$a массивом, первый элемент которого содержит 'f'. Теперь рассмотрим:</p><A NAME="AEN3997"></A><TABLE BORDER="0" BGCOLOR="#E0E0E0" CELLPADDING="5"><TR><TD><PRE>$a = "1";     // $a это string
$a[0] = "f";  // Что будет со смещением строки? Что произойдёт?</PRE></TD></TR></TABLE>
<P>Поскольку PHP поддерживает индексирование в строках через смещение с 
использованием того же синтаксиса, что и при индексировании массива, 
вышеприведённый пример создаст проблему: должна ли $a становиться массивом с первым элементом
"f", или "f" должен стать первым символом строки $a?</P>
<P>Исходя из этого, как указано в PHP 3.0.12 и PHP 4.0b3-RC4, результат этой 
автоматической конвертации рассматривается как неопределённый/undefined. Пути разрешения, однако, обсуждаются.</P></BLOCKQUOTE>
<H2><a name="language.types.typecasting">Приведение типов</a></H2>
<P>Приведение типов в PHP работает так же, как и в C: имя нужного типа 
записывается в скобках перед переменной, которая к этому новому типу приводится.</p><A NAME="AEN4004"></A><TABLE BORDER="0" BGCOLOR="#E0E0E0" CELLPADDING="5"><TR>
<TD><PRE>$foo = 10;   		// $foo это integer
$bar = (float) $foo;    // $bar это float</PRE></TD></TR></TABLE>
<P>Допускаются следующие приведения типов:<UL><LI><P>(int), (integer) - приведение к integer</P></LI>
<LI><P>(bool), (boolean) - приведение к boolean</P></LI>
<LI><P>(float), (double), (real) - приведение к float</P></LI>
<LI><P>(string) - приведение к string</P></LI>
<LI><P>(array) - приведение к array</P></LI>
<LI><P>(object) - приведение к object</P></LI></UL><BLOCKQUOTE><P><B>Примечание: </B>
  вместо приведения переменной к строке, вы можете также заключить переменную в двойные кавычки.</P></BLOCKQUOTE>
<P>Заметьте, что табуляции и пробелы допускаются внутри скобок, поэтому 
следующие варианты функционально эквивалентны:</p><A NAME="AEN4023"></A><TABLE BORDER="0" BGCOLOR="#E0E0E0" CELLPADDING="5"><TR><TD><PRE>$foo = (int) $bar;
$foo = ( int ) $bar;</PRE></TD></TR></TABLE>
<P>Возможно сейчас не очевидно, что происходит при приведении конкретных типов. Дополнительно см. разделы:
<UL><LI><P><a href="types.boolean.html#language.types.boolean.casting">
Конвертация в boolean</a></P></LI>
<LI><P><a href="types.integer.html#language.types.integer.casting">Конвертация в integer</a></P></LI></UL>
<P>При приведении или форсировании конвертации из массива в строку, результатом станет слово
<TT>Array</TT>. При приведении или форсировании конвертации из объекта в строку, результатом
станет слово <TT>Object</TT>.</P>
<P>При приведении скалярной или строковой переменной к массиву, переменная 
станет первым элементом этого массива:</p><TABLE BORDER="0" BGCOLOR="#E0E0E0" CELLPADDING="5">
<TR><TD><PRE>$var = 'ciao';
$arr = (array) $var;
echo $arr[0];  // выведет 'ciao'</PRE></TD></TR></TABLE>
<P>При приведении скалярной или строковой переменной к объекту, переменная 
станет атрибутом этого объекта; имя атрибута будет 'scalar':</p><A NAME="AEN4040"></A><TABLE BORDER="0" BGCOLOR="#E0E0E0" CELLPADDING="5"><TR>
<TD><PRE>$var = 'ciao';
$obj = (object) $var;
echo $obj-&#62;scalar;  // выведет 'ciao'</PRE></TD></TR></TABLE>
</TD><TD><IMG SRC="imag/spacer.gif" WIDTH="10" HEIGHT="1"></TD></TR><TR><TD COLSPAN="3">
<TABLE BGCOLOR="#CCCCFF" BORDER="0" WIDTH="100%"><TR BGCOLOR="#333366"><TD>
<IMG SRC="imag/spacer.gif" BORDER="0" width="1" height="1"><BR></TD></TR><TR><TD>
<TABLE WIDTH="100%" BORDER="0" CELLPADDING="3"><TR><TD WIDTH="33%" VALIGN="top">
<A HREF="types.null.html">Назад</A></TD><th WIDTH="34%" VALIGN="top">
<A HREF="index.html">Оглавление</A></th><TD WIDTH="33%" ALIGN="right" VALIGN="top">
<A HREF="variables.html">Вперёд</A></TD></TR><TR><TD WIDTH="33%" VALIGN="top">NULL</TD>
<th WIDTH="34%" VALIGN="top"><a href="types.html">Вверх</a></th>
<TD WIDTH="33%" ALIGN="right" VALIGN="top">Переменные</TD></TR></TABLE></TD></TR></TABLE></TD></TR></TABLE>
</BODY></HTML>