<!doctype HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><html><head><TITLE>Сообщение об Ошибках</TITLE>
<meta http-equiv="Content-Language" content="ru"><meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<LINK REL="stylesheet" HREF="style.css"></HEAD>
<body><TABLE BORDER="0" WIDTH="100%" HEIGHT="100%"><TR><TD COLSPAN="3">
<TABLE BGCOLOR="#CCCCFF" BORDER="0" WIDTH="100%"><TR><TD><TABLE WIDTH="100%" BORDER="0" CELLPADDING="3"><TR>
<TH COLSPAN="3">Учебник РНР</TH></TR><TR><TD WIDTH="10%"><A HREF="parser.html">Назад</A></TD>
<th WIDTH="80%">Приложение B. Переход от PHP 3 к PHP 4</th><TD WIDTH="10%" ALIGN="right">
<A HREF="initializers.html">Вперёд</A></TD></TR></TABLE></TD></TR><TR BGCOLOR="#333366"><TD>
<IMG SRC="imag/spacer.gif" BORDER="0" width="1" height="1"><BR></TD></TR></TABLE></TD></TR><TR><TD>
<IMG SRC="imag/spacer.gif" WIDTH="10" HEIGHT="1"></TD><TD HEIGHT="100%" VALIGN="TOP" WIDTH="100%">
<H1><a name="migration4.error-reporting">Сообщение об ошибке</a></H1>
<H2><a name="migration4.error-reporting.config">Изменения конфигурации</a></H2>
<P>В PHP 3 уровень серьёзности ошибки устанавливался как простое цифровое 
значение, образуемое суммированием чисел, относящихся к ошибкам разных 
уровней. Обычно это были значения 15 для сообщения обо всех ошибках и 7 для простых уведомляющих сообщений.</P>
<P>В PHP 4 имеется большой набор уровней ошибок и предупреждений, а также 
разборщик конфигурации, который позволяет теперь использовать символьные константы для установки нужного поведения.</P>
<P>Уровни сообщений теперь должны конфигурироваться явно с отделением уровней 
предупреждений, которые не должны генерировать сообщения об ошибках, x-ируя их из символьной константы
<TT>E_ALL</TT>. Звучит сложно? Хорошо, скажем, вы хотите, чтобы система сообщений об ошибках 
выводила всё, кроме предупреждений простого стиля, которые категоризированы символьной константой
<TT>E_NOTICE</TT>. Затем вы хотите поместить в ваш <TT>php.ini</TT> следующее: <TT>error_reporting = E_ALL &#38; ~ ( E_NOTICE )</TT>.
Если вы хотите подавить также и предупреждения, вы добавляете в 
соответствующую константу скобки и используете бинарную операцию '|':<br>
<TT>error_reporting= E_ALL &#38; ~ ( E_NOTICE | E_WARNING)</TT>.</P>
<TABLE CLASS="warning" BORDER="1" WIDTH="100%"><TR><th>Предупреждение!</th></TR><TR><TD>
<P>Использование старых значений 7 и 15 для установки сообщений об ошибках 
это плохая идея, так как при этом подавляются некоторые новые 
добавленные классы ошибок, в том числе - ошибки разборщика. Это может 
привести к весьма странному поведению, так как скрипты не смогут 
больше работать без показа сообщений об ошибках.</P>
<P>В прошлом это приводило также к появлению большого количества 
невоспроизводимых сообщений о bug'ах, когда 
люди сообщали о проблемах машины скриптов, которые невозможно было 
отследить, поскольку <TT><B>TRUE</B></TT> case обычно имел отсутствующий символ '}' в нужном файле, о чём разборщик не 
мог сообщить по причине неправильно сконфигурированной системы сообщений об ошибках.</P>
<P>Поэтому проверка установок системы сообщений об ошибках это первое, что 
нужно сделать, если ваш скрипт тихо умирает/die. Zend-машину можно 
считать в данное время в достаточной степени доработанной, чтобы не получать такого странного поведения.</P></TD>
</TR></TABLE><H2><a name="migration4.error-reporting.additions">Дополнительные предупреждения</a></H2>
<P>В большом количестве существующего кода PHP 3 используются конструкции 
языка, которые должны рассматриваться как очень плохой стиль 
программирования, поскольку работа этого кода может быть легко нарушена 
изменениями в других местах. PHP 4 ввёл большое количество уведомляющих 
сообщений в ситуациях, где PHP 3 этого не делал.  Это легко исправить, 
отключив сообщения E_NOTICE, но обычно лучше скорректировать код.</P>
<P>Наиболее общий случай вывода уведомлений теперь - это использование 
незакавыченных строковых констант в качестве индексов массивов. PHP 3 и 4 
не интерпретируют эти строки, если не известно ключевое слово или константа 
с этим именем, но если константа с этим именем была определена где-нибудь 
ещё в коде, это может нарушить работу вашего скрипта. Это может даже 
представлять опасность для защиты, если взломщик переопределяет строковые 
константы способом, когда скрипты дают права доступа, которые не 
предполагались. Так, PHP 4 будет теперь предупреждать вас об использовании незакавыченной строковой константы, как, например, в <TT>$_SERVER[REQUEST_METHOD]</TT>. Изменение этого на
<TT>$_SERVER['REQUEST_METHOD']</TT> осчастливит разборщик и значительно улучшит стиль и повысит безопасность 
вашего кода.</P><P>Другое, о чём сейчас также сообщает PHP 4, это использование 
неинициализированных переменных или элементов массива.</P></TD><TD><IMG SRC="imag/spacer.gif" WIDTH="10" HEIGHT="1"></TD>
</TR><TR><TD COLSPAN="3"><TABLE BGCOLOR="#CCCCFF" BORDER="0" WIDTH="100%"><TR BGCOLOR="#333366"><TD>
<IMG SRC="imag/spacer.gif" BORDER="0" width="1" height="1"></TD></TR><TR><TD>
<TABLE WIDTH="100%" BORDER="0" CELLPADDING="3"><TR><TD WIDTH="33%" VALIGN="top">
<A HREF="parser.html">Назад</A></TD><th WIDTH="34%" VALIGN="top"><A HREF="index.html">Оглавление</A>
</th><TD WIDTH="33%" ALIGN="right" VALIGN="top"><A HREF="initializers.html">Вперёд</A></TD></TR>
<TR><TD WIDTH="33%" VALIGN="top">Поведение разборщика</TD><th WIDTH="34%" VALIGN="top">
<a href="appendix.migration4.html">Вверх</a></th><TD WIDTH="33%" ALIGN="right" VALIGN="top">Инициализаторы</TD></TR></TABLE></TD></TR></TABLE></TD></TR></TABLE>
</BODY></HTML>