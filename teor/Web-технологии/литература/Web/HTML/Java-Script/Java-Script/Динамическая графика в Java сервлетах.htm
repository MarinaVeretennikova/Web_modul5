<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0060)http://www.citforum.ru/internet/javascript/javaservlet.shtml -->
<HTML><HEAD><TITLE>Динамическая графика в Java сервлетах</TITLE>
<META content="text/html; charset=windows-1251" http-equiv=Content-Type>
<META 
content="Информационные технологии,java,программирование,счетчик,графика,график,диаграмма,сервлет,библиотека,формат,gif,jpg,интернет,код,примеры,приложение,класс,окно, " 
name=KeyWords>
<META content=all name=Robots>
<META content="http://www.citforum.ru, Динамическая графика в Java сервлетах" 
name=Description>
<META content=Static name=Document-state><LINK 
href="Динамическая графика в Java сервлетах.files/forum.css" rel=stylesheet 
type=text/css>
<META content="MSHTML 5.00.2614.3401" name=GENERATOR></HEAD>
<BODY aLink=#800000 bgColor=#ffffff link=#006890 text=#000000 topMargin=0 
vLink=#003860 marginheight="0"><A name=top></A>
<TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
  <TBODY>
  <TR>
    <TD>
      <TABLE border=0 cellPadding=5 cellSpacing=0 width="100%">
        <TBODY>
        <TR>
          <TD>
            <P><FONT face="Arial, sans-serif" size=2><B><A 
            href="http://www.citforum.ru/">http://www.citforum.ru/</A></B></FONT></P></TD>
          <TD><!--TopList COUNTER-->
            <SCRIPT language=JavaScript><!--
d=document;js=10;a=';r='+escape(d.referrer)
//--></SCRIPT>

            <SCRIPT language=JavaScript1.1><!--
js=11;a+=';j='+navigator.javaEnabled()
//--></SCRIPT>

            <SCRIPT language=JavaScript1.2><!--
js=12;s=screen;a+=';s='+s.width+'*'+s.height
a+=';d='+(s.colorDepth?s.colorDepth:s.pixelDepth)
//--></SCRIPT>

            <SCRIPT language=JavaScript1.3><!--
js=13//--></SCRIPT>

            <SCRIPT language=JavaScript><!--
d.write('<img src="http://top.list.ru/counter'+
'?id=26978;js='+js+a+'" alt="" height=1 width=1>')
if(js>11)d.write('<'+'!-- ')//--></SCRIPT>
            <NOSCRIPT><IMG alt="" height=1 
            src="Динамическая графика в Java сервлетах.files/counter.gif" 
            width=1></NOSCRIPT>
            <SCRIPT 
            language=JavaScript><!--
if(js>11)d.write('--'+'>')
//--></SCRIPT>
<!--TopList COUNTER--></TD>
          <TD align=right>
            <P><FONT size=2><A href="http://www.citforum.ru/">Сервер</A> 
            содержит море(!) аналитической 
      информации!</FONT></P></TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD bgColor=#008080>
      <TABLE border=0 cellPadding=1 cellSpacing=1 width="100%">
        <TBODY>
        <TR>
          <TD align=middle bgColor=#daecd7><A class=head 
            href="http://www.citforum.ru/search.shtml">Поиск</A></TD>
          <TD align=middle bgColor=#daecd7><A class=head 
            href="http://www.citforum.ru/rubricator/">Рубрикатор</A></TD>
          <TD align=middle bgColor=#daecd7><A class=head 
            href="http://www.citforum.ru/news.shtml">Новости сервера</A></TD>
          <TD align=middle bgColor=#daecd7><A class=head 
            href="http://www.citmgu.ru/">Учебный центр</A></TD>
          <TD align=middle bgColor=#daecd7><A class=head 
            href="http://www.mistral.ru/">Книжный магазин</A></TD>
          <TD align=middle bgColor=#daecd7><A class=head 
            href="http://www.citforum.ru/advertising/">Реклама на 
        сервере</A></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
<TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
  <TBODY>
  <TR>
    <TD><IMG border=0 height=5 
      src="Динамическая графика в Java сервлетах.files/1x1.gif" width=1></TD></TR>
  <TR>
    <TD align=middle>
      <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
        <TBODY>
        <TR>
          <TD><IMG alt=Logo border=0 height=60 
            src="Динамическая графика в Java сервлетах.files/citlogo6.gif" 
            width=160></TD>
          <TD width="100%"><IMG border=0 height=60 
            src="Динамическая графика в Java сервлетах.files/1x1.gif" 
width=5></TD>
          <TD><IMG border=0 height=60 
            src="Динамическая графика в Java сервлетах.files/adv.gif" 
          width=15></TD>
          <TD><!-- Russian LinkExchange code START -->
            <SCRIPT language=JavaScript>
<!--
var a3=Math.floor(Math.random()*100000000);
document.write("<iframe src=http://www.linkexchange.ru/cgi-bin/erle.cgi?026012?" + a3 + " frameborder=0 vspace=0 hspace=0 width=468 height=60  marginwidth=0  marginheight=0 scrolling=no><a href=http://www.linkexchange.ru/users/026012/goto.map target=_top><img src=http://www.linkexchange.ru/cgi-bin/rle.cgi?026012?" + a3 + " alt=\"RLE Banner Network\" border=0 height=60 width=468></a></iframe>");
//-->
</SCRIPT>
<!-- Russian LinkExchange code END --></TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD><IMG border=0 height=5 
      src="Динамическая графика в Java сервлетах.files/1x1.gif" 
  width=1></TD></TR></TBODY></TABLE>
<TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
  <TBODY>
  <TR>
    <TD bgColor=#daecd7><IMG border=0 height=4 
      src="Динамическая графика в Java сервлетах.files/1x1.gif" 
  width=1></TD></TR></TBODY></TABLE><!--top adv-->
<TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
  <TBODY>
  <TR>
    <TD bgColor=#daecd7>
      <TABLE border=0 cellPadding=0 cellSpacing=1 width="100%">
        <TBODY>
        <TR vAlign=top>
          <TD bgColor=#ffffff width="50%">
            <TABLE border=0 cellPadding=3 cellSpacing=0 width="100%">
              <TBODY>
              <TR vAlign=top>
                <TD><A href="http://www.mistral.ru/content/16151.shtml"><IMG 
                  align=left alt="Black Cat logo" border=0 height=45 
                  src="Динамическая графика в Java сервлетах.files/black_cat_72x45.gif" 
                  width=72></A>
                  <DIV align=center><FONT size=2><FONT size=3><A 
                  href="http://www.mistral.ru/content/16151.shtml"><B>Black Cat 
                  Linux 6.2</B></A></FONT><BR>(4 CD + краткое руководство) 
                  -<BR>в интернет-магазине <B><A 
                  href="http://www.mistral.ru/">"Мистраль"</A></B>! 
                </FONT></DIV></TD></TR></TBODY></TABLE></TD>
          <TD bgColor=#ffffff width="50%">
            <TABLE border=0 cellPadding=3 cellSpacing=0 width="100%">
              <TBODY>
              <TR vAlign=top>
                <TD><A href="http://www.citmgu.ru/ab_2.html"><IMG align=left 
                  alt=mcse border=0 height=38 
                  src="Динамическая графика в Java сервлетах.files/mcp_se_c.gif" 
                  width=110></A>
                  <DIV align=center><FONT size=2><B>Учебная программа<BR><FONT 
                  size=3><A href="http://www.citmgu.ru/ab_2.html">"Статус MCSE 
                  под ключ!"</A></B></FONT></FONT></DIV></TD></TR>
              <TR>
                <TD align=middle><FONT size=2><B>Занятия начнутся 24 июля! 
                  </B></FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
<TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
  <TBODY>
  <TR>
    <TD bgColor=#daecd7><IMG border=0 height=4 
      src="Динамическая графика в Java сервлетах.files/1x1.gif" 
  width=1></TD></TR></TBODY></TABLE><!--/top adv-->
<TABLE border=0 cellPadding=5 cellSpacing=0 width="100%">
  <TBODY>
  <TR>
    <TD>
      <P><FONT face="Tahoma, Arial, sans-serif" size=1><B><A 
      href="http://www.citforum.ru/">CITFORUM.RU</A> &gt;&gt;&gt; <A 
      href="http://www.citforum.ru/internet/">INTERNET</A> &gt;&gt;&gt; <A 
      href="http://www.citforum.ru/internet/javascript/javaservlet.shtml">/internet/javascript/javaservlet.shtml</A></B></FONT></P></TD></TR></TBODY></TABLE>
<P>&nbsp; <!-- start -->
<H3 align=center>Динамическая графика в Java сервлетах</H3>
<P align=center><I>Кен МакКрэри,<BR><A href="mailto:victor@uwc.ru">Перевод на 
русский © Виктор Смирнов, 2000</A><BR><A href="http://www.javable.com/">Оригинал 
статьи опубликован на сайте Javable.com</A></I> 
<P><I>Server-Side Java</I> 
<P><B>Обзор</B> 
<UL>
  <P align=justify>Как создать графический счетчик посещений? Диаграмму, 
  изображающую загруженность канала до провайдера или количество писем в 
  очереди? Одним словом, как сформировать изображение динамически по запросу 
  пользователя? В своей статье Ken McCrary предлагает варианты решения этой 
  задачи. (2500 слов) </P></UL>
<P align=justify>Графики и диаграммы позволяют облегчить восприятие 
аналитической информации. Представьте, например, таблицу измерений параметров 
загруженности канала, проводимых каждые пять минут. Трудно поверить, что у вас 
хватит терпения просматривать ее хотя бы раз в неделю. Тогда как, 
соответствующая диаграмма представляется вполне удобоваримой и исчерпывающей. Во 
многих случаях изображения должны создаваться в реальном времени по запросу 
пользователя. Потребность в этом может быть обусловлена природой отображаемых 
данных, в случае, когда данные поступают непрерывно или меняются со временем, 
или же возможностью значительно уменьшить используемое дисковое пространство. 
Конечно же, не всегда уместно (технически осуществимо) конструировать 
изображения динамически, но, там, где это действительно необходимо, 
использование удачных технологических решений может привести к значительному 
выигрышу в производительности и качестве сервиса. 
<H4>Чтение и запись изображений, требования к JDK</H4>
<P align=justify>Для того чтобы сервлет - приложение, выполняемое на сервере, 
которое обрабатывает запросы пользователей,- мог динамически создавать 
изображения, прежде всего, необходим механизм чтения и записи графических 
файлов. Точнее, сервлет должен уметь отправить полученную картинку в ответ на 
запрос пользователя. Основные библиотеки (Core API) для Java не предоставляют 
средств, используя которые можно было бы сохранить полученное в памяти 
изображение в одном из графических форматов. Есть библиотеки Sun для Java 1.1 и 
лицензированные Sun библиотеки для Java 1.2. Поскольку, они расположены в пакете 
com.sun они не относятся ни к основным библиотекам, ни к стандартным расширениям 
(standard extension), поэтому использующие их приложения нельзя считать 
переносимыми (portable). Другими словами, они могут и не работать на виртуальной 
машине, выпущенной другой компанией. Стоит отметить, что утвержденный запрос 
Java Specification Request JSR-000015 на стандартное расширение Java 2 содержит 
описание механизма для чтения и записи графических файлов; когда он будет 
реализован, можно будет писать переносимые программы, осуществляющие ввод/вывод 
изображений. 
<P>Для этой статьи я подготовил примеры, работающие на платформах Java 1.1 и 
Java 1.2. 
<H4>Форматы изображений</H4>
<P align=justify>Формат GIF - самый распространенный формат графических файлов в 
Веб. Он широко поддерживается броузерами, в том числе и самыми первыми. К 
сожалению, написание программ, генерирующих изображения в этом формате, 
потенциально затруднено патентом на алгоритм сжатия данных. Программ, 
приведенные в этой статье, создают изображения в формате JPEG и PNG. Формат JPEG 
выбран, прежде всего, из тех соображений, что реализация Sun Java 1.2 позволяет 
формировать изображения этого типа без применения дополнительных библиотек. (В 
примере приложения для JDK 1.1 можно получить файл не только в формате PNG, но и 
во многих других, в том числе - JPEG и GIF - прим. переводчика) 
<P align=justify>Одно из различий между форматами JPEG и GIF состоит в том, что 
алгоритм сжатия данных, используемый в GIF, в отличие от алгоритма, 
используемого в JPEG, не искажает изображение. Обычно, артефакты в JPEG 
картинках не сильно заметны. (Следует отметить, что формат JPEG лучше 
справляется с представлением фотографий, нежели текста, диаграмм или 
изображений, содержащих тонкие линии и четкие границы цветовых переходов - прим. 
переводчика) Второй пример применяет формат PNG с алгоритмом сжатия без потери 
данных и, к тому же, свободный от правовых затруднений. 
<H4>Архитектура сервлета</H4>
<P align=justify>Разобьем нашу программу на две части. Первая часть - сервлет - 
отвечает за обработку HTTP запроса и возвращает клиенту требуемое изображение, 
если это возможно. Вторая часть, класс, формирующий картинку. Для простоты 
реализации, в качестве параметра при обращении к сервлету будет передаваться имя 
используемого класса. Соответствующий Java класс должен реализовывать 
определенный интерфейс для общения с сервлетом. Приведем описание этого 
интерфейса: <PRE><B>public interface ImageProducer {</B>
        /**
         * MIME тип создаваемого изображения.
         *
         * @return MIME тип изображения.
         */
        public String <B>getMIMEType();</B>
        /**
         * Создает изображение и записывает его в указанный поток.
         *
         * @param stream Куда писать картинку.
         */
        public void <B>createImage</B>(OutputStream <B>stream</B>)
                 <B>throws</B> IOException;
}
</PRE>
<P align=justify>Интерфейс ImageProducer содержит метод для определения типа 
изображения и метод для формирования изображения. Полученная картинка 
отправляется клиенту. 
<P>Следующий код демонстрирует, как сервлет работает с классами, реализующими 
интерфейс ImageProducer: <PRE>ImageProducer <B>imageProducer =</B>
        (ImageProducer)
     <B>Class.forName(request.getQueryString()).newInstance();
response.setContentType(imageProducer.getMIMEType());
imageProducer.createImage(response.getOutputStream());</B>
</PRE>
<P align=justify>Сервлет создает (загружается) класс с именем, указанным в 
параметрах запроса - части URL справа после "?". Полученный класс приводится к 
типу ImageProducer. Затем, обращаясь к соответствующим методам, сервлет получает 
тип и формирует изображение. В случае если нет ошибок, картинка пересылается 
клиенту. 
<P align=justify>Приведенный код может вызвать несколько исключений, наиболее 
распространенные из них: ClassNotFoundException и ClassCastException. Первое 
вызвано тем, что класс, имя которого передано в качестве параметра запроса, не 
доступен загрузчику (ClassLoader), второе же тем, что указанный класс не 
реализует интерфейс ImageProducer. В случае ошибки клиент, конечно же, не 
получает картинку, и броузер выводит изображение, показывающее, что сервер не 
ответил на запрос. Программа тестировалась с использованием Java Server Web 
Development Kit (JSWDK 1.0.1), но вы должны получить аналогичные результаты на 
большинстве других Веб серверах, поддерживающих Java. 
<H4>Создание изображений в Java 1.1</H4>
<P align=justify>Для своего первого примера я подготовил код, который будет 
работать на платформе Java 1.1. Хотя виртуальные машины JVM 1.2 достаточно 
распространены, не все могут размещать программы на этой платформе. К сожалению, 
провайдеры не сильно спешат обновлять виртуальные машины на своих серверах. Как 
следствие, приходится разрабатывать сервлеты, работающие на платформе Java 1.1. 
Это не сильно затруднят задачу; тем не менее, есть некоторые сложности, 
связанные с формированием изображений, которые мы обсудим ниже. 
<P align=justify>Будем строить круговую диаграмму (pie chart), которую мы, для 
полноты картины, раскрасим и подпишем. На диаграмме будут изображены напитки, 
употребляемые разработчиками программного обеспечения. Посмотрим, как можно это 
сделать. 
<P align=justify>Для операций ввода/вывода изображений в Java 1.1 Sun предлагает 
библиотеку Jimi. Sun приобрел ее у небольшой компании. Перед тем, как начать 
распространять эту библиотеку, компания Sun перенесла классы в пакет com.sun, а 
в остальном ничего не изменила. 
<P>Следующие шаги необходимо проделать для формирования PNG изображения с 
использованием Jimi. 
<OL>
  <LI>Создать окно приложения(Frame для получения изображения. 
  <LI>Использую AWT изображение, создать реализацию класса Graphics. 
  <LI>Нарисовать картинку с помощью объекта Graphics. 
  <LI>Создать объект JimiWriter на основе потока данных, передаваемых клиенту. 
  <LI>Преобразовать изображение в соответствующий формат и отправить его 
  клиенту. </LI></OL>
<P align=justify>Для формирования и модификации изображений на платформе Java 
1.1 необходимо использовать активную AWT компоненту. Как правило, сервлет не 
должен создавать AWT компоненты, которые обычно используются в приложениях с 
графическим интерфейсом пользователя. В этом случае, вам нужен графический (AWT) 
объект для того, что бы получить объект класса Graphics, с помощью которого 
можно рисовать новые картинки. Придется смириться с маленьким окошком на консоли 
Веб сервера. Если вам известны способы создания изображения в Java 1.1 без 
использования AWT компонент, пожалуйста, сообщите мне. Один из возможных 
вариантов, загрузить с диска сервера заранее подготовленный шаблон, например 
методом java.awt.Toolkit.createImage(). После того, как вы создали AWT 
изображение, вы можете получить реализацию класса Graphics и использовать ее для 
рисования. Имея в своем распоряжении объект Graphics, вы можете закрыть ненужное 
окно на консоли сервера. Я оставлю этот эксперимент заинтересованным читателям. 
<P align=justify>Напомню, что для связи с классом, рисующим круговую диаграмму, 
сервлет использует интерфейс ImageProducer. Поэтому наш класс JIMIProducer 
должен реализовывать этот интерфейс. Прежде всего, создадим AWT окно, AWT 
изображения и, наконец, объект Graphics: <PRE>        Frame <B>f</B> = new Frame<B>();</B>
        <B>f.setVisible(</B>true<B>;
        image = f.createImage(ImageWidth, ImageHeight);
        graphics = image.getGraphics();
        f.setVisible(</B>false<B>);</B>
</PRE>
<P align=justify>Ключевой метод класса JIMIProducer - drawSlice. Получая на 
входе метку и величину сегмента в градусах, этот метод рисует сегмент диаграммы, 
раскрашивает его и подписывает. Далее, я расскажу подробней, как это происходит. 

<P align=justify>Будем заполнять "внутренности" диаграммы по часовой стрелке, 
начиная с положения "три часа", то есть первую линию проведем из центра к 
окружности ограничивающей диаграмму в положении часовой стрелки в три часа дня 
(или ночи, как вам больше нравиться). Отступим по часовой стрелке необходимое 
количество градусов и нарисуем вторую линию, ограничивающую сегмент диаграммы. И 
так далее. Приведенный ниже код получает на входе величину сегмента в градусах и 
рисует границу этого сегмента. Он вызывается последовательно для всех сегментов, 
при этом предполагается, что в сумме угловые величины составят 360 градусов. <PRE>        //*************************************************
        // Преобразуем угол в радианы
        // 1 градус = pi/180 радиан
        //*************************************************
        double<B>theta = degrees * (3.14/180);
        currentTheta += theta;</B>
        //*************************************************
        // Переводим в декартовы координаты
        // x = r cos @
        // y = r sin @
        //*************************************************
        double <B>x = Radius * Math.cos(currentTheta);</B>
        double <B>y = Radius * Math.sin(currentTheta);</B>
        Point <B>mark2</B> = newPoint<B>(center);
        mark2.translate((</B>int<B>)x,(</B>int<B>)y);
        graphics.drawLine
                 (center.x, center.y, mark2.x, mark2.y);</B>
</PRE>
<P>Затем, нужно раскрасить сегменты диаграммы. Для этого можно воспользоваться 
очень полезным методом fillArc(): <PRE>        <B>graphics.setColor(colors[colorIndex++]);
        graphics.fillArc(Inset,
                        Inset,
                        PieWidth,
                        PieHeight,
                        -1 * lastAngle,
                        -1 * degrees);</B>
</PRE>
<P align=justify>Последняя задача метода drawSlice() нарисовать метки сегментов. 
Расположение надписи рассчитывается, основываясь на метрике используемого 
шрифта. Окончательный вариант диаграммы можно посмотреть на рисунке. 
<P align=center><IMG border=0 height=370 
src="Динамическая графика в Java сервлетах.files/javaservlet_01.gif" width=370> 
<P align=center>Рис. 1. Окончательный вариант круговой диаграммы. (Не все 
броузеры показывают файлы формата PNG, поэтому здесь мы поставили GIF файл.) 
<H4>Создание изображений в Java 1.2</H4>
<P>Практически все интересуются сейчас курсами акций на бирже. Нарисуем (всем на 
радость) на нашей диаграмме курс акций компании Sun за одну из недель марта. 
<P align=justify>Для создания изображений в формате JPEG используется класс 
com.sun.image.codec.jpeg.JPEGImageEncoder. Повторюсь, что принадлежность к 
пакету com.sun означает, что этот класс не является частью основного API и к 
нему относятся все соответствующие предупреждения. 
<P align=justify>Класс JPEGImageEncoder "понимает", как перекодировать 
изображение java.awt.image.BufferedImage, так что его и будем использовать. Для 
создания класса BufferedImage нужно указать требуемые размеры изображения. После 
создания, класс BufferedImage предоставляет класс ava.awt.Graphics2D, который 
можно использовать для рисования на соответствующей классу BufferedImage 
картинке. Все просто? Итак, основные шаги, необходимые для формирования 
изображения в формате JPEG: 
<OL>
  <LI>Создаем класс JPEGImageEncoder, предоставляя ему поток OutputStream данных 
  передаваемых клиенту. 
  <LI>Создаем класс BufferedImage необходимых размеров. 
  <LI>Используем реализацию класса Graphics2D, предоставляемую классом 
  BufferedImage, для рисования диаграммы. 
  <LI>С помощью полученного ранее класса JPEGImageEncoder перекодируем 
  нарисованное изображение в формат JPEG и пишем его в поток, отправляемый 
  клиенту. </LI></OL>
<P>Обсудим некоторые детали рисования с использованием Graphics2D. 
<P align=justify>Для создания графика курса акций нужно, собственно, нарисовать 
несколько линий. Пакет Java 2D, java.awt.geom, содержит все необходимые для 
этого классы. Абстрактный класс Line2D определяет отрезок прямой. Он имеет две 
реализации, отличающиеся типом используемых координат. Класс Line2D.Double 
применяет примитивный тип double, а класс Line2D.Float - вещественные числа с 
плавающей точкой. Высокая точность совершенно излишня для нашего графика, но я 
не буду экономить и создам отрезки прямой классом Line2D.Double. 
<P>Приведем, в качестве примера, участок программы, рисующий горизонтальную ось 
графика: <PRE>        <B>horAxis = </B>new <B>Line2D.Double(HorzInset,
                        ImageHeight - VertInset,
                        ImageWidth -  HorzInset,
                        ImageHeight - VertInset);
        graphics.draw(horAxis);</B>
</PRE>
<P align=justify>Горизонтальная ось строится с небольшим отступом от границы 
экрана, предоставляя место для разметки. После создания вы рисуете линю, 
обращаясь к методу draw() объекта Graphics2D. Напомню, что вы получили его от 
реализации класса BufferedImage. Класс Graphics2D содержит методы для рисования 
графических примитивов, для наших целей более чем достаточно. На рисунке 2 
приведен окончательный вариант графика. 
<P align=center><IMG border=0 height=300 
src="Динамическая графика в Java сервлетах.files/javaservlet_02.gif" width=310> 
<P align=center>Рис. 2. Окончательный вариант графика курса акций. 
<H4>Производительность</H4>
<P align=justify>Плохая производительность - одно из основных обвинений 
противников Java. Я не разделяю этой позиции. Я убежден в том, что от можно 
добиться хорошей производительности для программы,написанной на Java, 
динамически создающей изображения. Как разработчик программного обеспечения, я 
могу дать вам совет: если вас не устраивает производительность, покупайте более 
совершенные компьютеры. 
<H4>Заключение</H4>
<P align=justify>В этой статье я показал, как можно создавать в программах на 
языке Java простые изображения, и воспользовался этой техникой для написания 
сервлета, формирующего картинку по запросу пользователя. Эта технология имеет 
огромное количество приложений, ограниченное, разве что, рамками воображения. 
Два вопроса стоит иметь в виду, разрабатывая приложения на основе изложенных 
идей: производительность алгоритма, создающего изображение, и ограничение 
пропускной способности канала связи сервера. Для решения последней проблемы, 
очевидно, нужно максимально уменьшить размер картинки, в первом случае применять 
стандартные методы оптимизации приложений. 
<P><B>Об авторе</B> 
<P align=justify>KenMcCrary, сертифицированный Sun Java developer, живет в 
Нью-Йорке, Research Triangle Park. Он работал над большим количеством Java 
проектов. Вы можете посетить его сайт <A 
href="http://www.kenmccrary.com/">http://www.kenmccrary.com/</A> 
<P><B>Ресурсы</B> 
<UL>
  <LI>Оригинальные исходные тексты:<BR><A 
  href="http://www.javaworld.com/jw-05-2000/servlets/Servlets.zip">http://www.javaworld.com/jw-05-2000/servlets/Servlets.zip</A> 

  <LI>Слегка подправленный вариант с комментариями на русском:<BR><A 
  href="http://www.javable.com/javaworld/05_00/01/is.zip">is.zip</A> 
  <LI>Круговая диаграмма в формате PNG:<BR><A 
  href="http://www.javaworld.com/jw-05-2000/images/piechart.png">http://www.javaworld.com/jw-05-2000/images/piechart.png</A> 

  <LI>Информация по зопросу JSR-00015:<BR><A 
  href="http://java.sun.com/aboutJava/communityprocess/jsr/jsr_015_iio.html">http://java.sun.com/aboutJava/communityprocess/jsr/jsr_015_iio.html</A> 

  <LI>нформация по пакету JPEG:<BR><A 
  href="http://java.sun.com/products/jdk/1.2/docs/guide/2d/api-jpeg/" 
  package-summary.html jpeg codec image sun 
  com>http://java.sun.com/products/jdk/1.2/docs/guide/2d/api-jpeg/</A> 
  <LI>Информация по библиотеке Jimi:<BR><A 
  href="http://java.sun.com/products/jimi/">http://java.sun.com/products/jimi/</A> 

  <LI>Информация по PNG:<BR><A 
  href="http://www.w3.org/Graphics/PNG/">http://www.w3.org/Graphics/PNG/</A> 
  <OL></OL>
  <P><I>Reprinted with permission from the March 2000 edition of JavaWorld 
  magazine.<BR>Copyright © ITworld.com, Inc., an IDG Communications 
  company.<BR>View the original article at: <A 
  href="http://www.javaworld.com/javaworld/" jw-0505-servlets.html 
  jw-05-2000>http://www.javaworld.com/javaworld/</A></I> 
  <P>&nbsp; <!-- end -->
  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
    <TBODY>
    <TR>
      <TD bgColor=#daecd7><IMG border=0 height=4 
        src="Динамическая графика в Java сервлетах.files/1x1.gif" width=1></TD></TR>
    <TR>
      <TD><IMG border=0 height=5 
        src="Динамическая графика в Java сервлетах.files/1x1.gif" 
    width=1></TD></TR></TBODY></TABLE>
  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
    <TBODY>
    <TR>
      <TD bgColor=#008080>
        <TABLE border=0 cellPadding=1 cellSpacing=1 width="100%">
          <TBODY>
          <TR>
            <TD align=middle bgColor=#daecd7><A class=head 
              href="http://www.citforum.ru/">В начало</A></TD>
            <TD align=middle bgColor=#daecd7><A class=head 
              href="http://www.citforum.ru/internet/javascript/javaservlet.shtml#top">Наверх</A></TD>
            <TD align=middle bgColor=#daecd7><A class=head 
              href="http://www.citforum.ru/search.shtml">Поиск</A></TD>
            <TD align=middle bgColor=#daecd7><A class=head 
              href="http://www.citforum.ru/rubricator/">Рубрикатор</A></TD>
            <TD align=middle bgColor=#daecd7><A class=head 
              href="http://www.citforum.ru/news.shtml">Новости сервера</A></TD>
            <TD align=middle bgColor=#daecd7><A class=head 
              href="http://www.citmgu.ru/">Учебный центр</A></TD>
            <TD align=middle bgColor=#daecd7><A class=head 
              href="http://www.mistral.ru/">Книжный магазин</A></TD>
            <TD align=middle bgColor=#daecd7><A class=head 
              href="http://www.citforum.ru/advertising/">Реклама на 
            сервере</A></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
    <TBODY>
    <TR>
      <TD><IMG border=0 height=5 
        src="Динамическая графика в Java сервлетах.files/1x1.gif" 
    width=1></TD></TR></TBODY></TABLE>
  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
    <TBODY>
    <TR>
      <TD>
        <FORM action=http://www.citforum.ru/cgi-bin/Click.cgi method=get></TD>
      <TD><INPUT name=Banner type=hidden value=Bottom></TD>
      <TD align=right width="100%"><FONT size=2>Быстрый переход &gt;&gt;&gt; 
        </FONT><SELECT name=Target size=1> <OPTION selected 
          value=http://www.citforum.ru/index.html>Индексная 
          страница</OPTION>&nbsp; <OPTION 
          value=http://www.citforum.ru/internet/index.shtml>Internet-технологии</OPTION>&nbsp; 
          <OPTION value=http://www.citforum.ru/nets/index.shtml>Сетевые 
          технологии</OPTION>&nbsp; <OPTION 
          value=http://www.citforum.ru/database/index.shtml>Базы 
          данных</OPTION>&nbsp; <OPTION 
          value=http://www.citforum.ru/operating_systems/index.shtml>Операционные 
          системы</OPTION>&nbsp; <OPTION 
          value=http://www.citforum.ru/programming/index.shtml>Программирование</OPTION>&nbsp; 
          <OPTION value=http://www.citforum.ru/hardware/index.shtml>Аппаратные 
          платформы</OPTION>&nbsp; <OPTION 
          value=http://www.citforum.ru/seminars/index.shtml>Материалы 
          конференций</OPTION>&nbsp; <OPTION 
          value=http://www.citforum.ru/mcp/index.shtml>MS-сертификация</OPTION>&nbsp; 
          <OPTION value=http://www.citforum.ru/pp/index.shtml>Пользователям и 
          преподавателям</OPTION>&nbsp; <OPTION 
          value=http://www.citforum.ru/cfin/index.shtml>Корпоративные 
          ресурсы</OPTION>&nbsp;</SELECT> <INPUT name=Referer type=hidden 
        value=Bottom><INPUT type=submit value=Go!></TD>
      <TD></FORM></TD></TR></TBODY></TABLE>
  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
    <TBODY>
    <TR>
      <TD><IMG border=0 height=5 
        src="Динамическая графика в Java сервлетах.files/1x1.gif" width=1></TD></TR>
    <TR>
      <TD bgColor=#daecd7><IMG border=0 height=4 
        src="Динамическая графика в Java сервлетах.files/1x1.gif" 
    width=1></TD></TR></TBODY></TABLE>
  <TABLE border=0 cellPadding=4 cellSpacing=0 width="100%">
    <TBODY>
    <TR>
      <TD><FONT size=2>Комментарии: <A 
        href="mailto:info@citmgu.ru?Subject='From bottom of CIT FORUM'">mailto:info@citmgu.ru?Subject='From 
        bottom of CIT FORUM'</A></FONT></TD>
      <TD>&nbsp;</TD>
      <TD><!-- SpyLOG v2 f:0211 -->
        <SCRIPT language=javascript>
u="u266.74.spylog.com";d=document;nv=navigator;na=nv.appName;t="";p=1;
sz=" width=88 height=31 ";
hl=history.length;d.cookie="b=b";c=0;
bv=Math.round(parseFloat(nv.appVersion)*100);
if (d.cookie) c=1;n=(na.substring(0,2)=="Mi")?0:1;
if((n==0)||(bv >= 300)){rn=Math.random();t=(new Date()).getTimezoneOffset();} else {rn=0;}
z="p="+p+"&rn="+rn+"&t="+t+"&c="+c+"&hl="+hl;
if (self != top) { fr=1;} else { fr=0;}
r=escape(d.referrer);r1="";
sl="1.0";h=0;
</SCRIPT>

        <SCRIPT language=javascript1.1>
pl="";sl="1.1";
if((n==1) && (bv >= 300))
{ for(var i = 0; i < nv.plugins.length; i++)
pl += nv.plugins[i].name+":"; }
j = (navigator.javaEnabled() ? "Y" : "N");
</SCRIPT>

        <SCRIPT language=javascript1.2>
sl="1.2";s=screen;wh=s.width+'x'+s.height;
px=(n==0)?screen.colorDepth:screen.pixelDepth;z+="&wh="+wh+"&px="+px;
</SCRIPT>

        <SCRIPT language=javascript1.3>
sl="1.3"
</SCRIPT>

        <SCRIPT language=javascript>
y="";
y+="<a href='http://"+u+"/cnt?f=3&p="+p+"&rn="+rn+"' target=_blank>";
y+="<img src='http://"+u+"/cnt?";
y+=z+"&j="+j+"&sl="+sl+"&r="+r+"&r1="+r1+"&fr="+fr+"&pg="+escape(window.location.href)+"&pl="+escape(pl);
y+="' border=0 "+sz+" alt='SpyLOG'>";
y+="</a>";
d.write(y);
</SCRIPT>

        <SCRIPT language=javascript1.2><!--
if (n == 0) { d.write("<");d.write("!--"); }
//--></SCRIPT>
        <NOSCRIPT><A href="http://u266.74.spylog.com/cnt?f=3&amp;p=1" 
        target=_blank><IMG alt=SpyLOG border=0 height=31 
        src="Динамическая графика в Java сервлетах.files/cnt.gif" 
        width=88></A></NOSCRIPT>
        <SCRIPT language=javascript1.2><!--
if (n == 0) { d.write("--");d.write(">"); }
//--></SCRIPT>
<!-- SpyLOG --></TD>
      <TD align=right vAlign=top>Copyright © <A 
        href="http://citforum.ru/cgi-bin/Click.cgi?Banner=cit_key.gif&amp;Target=http://www.citmgu.ru/&amp;Referer=TOP_INLINER"><IMG 
        border=0 height=38 
        src="Динамическая графика в Java сервлетах.files/logo_cit.gif" 
        width=134></A></TD></TR></TBODY></TABLE>
  <TABLE border=0 cellPadding=0 cellSpacing=0 width="100%">
    <TBODY>
    <TR>
      <TD bgColor=#daecd7><IMG border=0 height=4 
        src="Динамическая графика в Java сервлетах.files/1x1.gif" width=1></TD></TR>
    <TR>
      <TD align=right><FONT face="Arial, sans-serif" size=1>Design by <A 
        href="mailto:ame@citmgu.ru">Andre M. 
  Erofeev</A></FONT></TD></TR></TBODY></TABLE></P></LI></UL></BODY></HTML>
