<HTML>



<!--



Author:	Paul Khramtsov



Date:	May 17, 1998



-->



<HEAD>



<title>Web-engineering (Introduction to the JavaScript. Focus.)</title>



<link rel="stylesheet" type="text/css" href="page.css" tppabs="http://webclass.polyn.kiae.su/classes/css/page.css">



<!--Charset-->



<script language=JavaScript src="jsc.pgm" tppabs="http://webclass.polyn.kiae.su/classes/css/jsc.pgm"></script>



<script language=JavaScript src="jsc.pgm" tppabs="http://webclass.polyn.kiae.su/classes/css/jsc.pgm"></script>

<script language=JavaScript>

<!--







// -->



</script>



</HEAD>



<body style="color:navy;background-color:white;background-image:url(../images/main/rope.gif);" onLoad="jump();">







<SCRIPT SRC="count.js" tppabs="http://counter.hotlog.ru/cgi-bin/hotlog/count.js"></SCRIPT>
<SCRIPT LANGUAGE="JavaScript">js=0</SCRIPT>
<SCRIPT LANGUAGE="JavaScript1.1">js=1</SCRIPT>
<SCRIPT LANGUAGE="JavaScript1.2">js=2</SCRIPT>
<SCRIPT LANGUAGE="JavaScript1.3">js=3</SCRIPT>
<SCRIPT LANGUAGE="JavaScript">HotLOG(1686,js)</SCRIPT>
<noscript><img src="count-s=1686" tppabs="http://hit.hotlog.ru/cgi-bin/hotlog/count?s=1686" border=0 width=1 height=1></noscript>
<!-- Логотип -->



<div class=logo>

<table border=0 cellpadding=0 cellspacing=0 width=560>

<tr><td><img src="sea003.gif" tppabs="http://webclass.polyn.kiae.su/classes/images/main/sea003.gif" width=560 height=5 border=0 hspace=0 vspace=0 align=left></td></tr>

<tr><td><img src="sea000.gif" tppabs="http://webclass.polyn.kiae.su/classes/images/main/sea000.gif" width=560 height=15 border=0 hspace=0 vspace=0 align=left></td></tr>
<!--
<tr><td><a href=../homef.htm onMouseover="document.sea001.src='../images/main/hweb.gif';return true;" onMouseout="document.sea001.src='../images/main/sea001.gif';return true;"><img name=sea001 src=../images/main/sea001.gif width=560 height=15 border=0 hspace=0 vspace=0 align=left></a></td></tr>
-->
<tr><td><img name=sea001 src="sea001.gif" tppabs="http://webclass.polyn.kiae.su/classes/images/main/sea001.gif" width=560 height=15 border=0 hspace=0 vspace=0 align=left></td></tr>

<tr><td><img src="sea002.gif" tppabs="http://webclass.polyn.kiae.su/classes/images/main/sea002.gif" width=560 height=5 border=0 hspace=0 vspace=0 align=left></td></tr>

</table>

</div>



<!-- Конец логотипа -->



<!-- Главное меню -->



<div class=menu>

<table border=0 cellpadding=0 cellspacing=0 width=560>

<tr>

<td><a href="jsid.htm" tppabs="http://webclass.polyn.kiae.su/classes/jsi/jsid.htm"><img src="manual.gif" tppabs="http://webclass.polyn.kiae.su/classes/images/main/manual.gif" border=0 hspace=0 vspace=0 height=20 width=81 alt=Конспект></a></td>

<td><img src="ref.gif" tppabs="http://webclass.polyn.kiae.su/classes/images/main/ref.gif" border=0 hspace=0 vspace=0 height=20 width=81 alt=Справочник></td>

<td><img src="work.gif" tppabs="http://webclass.polyn.kiae.su/classes/images/main/work.gif" border=0 hspace=0 vspace=0 height=20 width=81 alt=Задания></td>

<td><img src="ex.gif" tppabs="http://webclass.polyn.kiae.su/classes/images/main/ex.gif" border=0 hspace=0 vspace=0 height=20 width=81 alt=Примеры></td>

<td><a href="focust.htm" tppabs="http://webclass.polyn.kiae.su/classes/jsi/test/focust.htm"><img src="tests.gif" tppabs="http://webclass.polyn.kiae.su/classes/images/main/tests.gif" border=0 hspace=0 vspace=0 height=20 width=81 alt=Контроль></a></td>

<td><img src="coach.gif" tppabs="http://webclass.polyn.kiae.su/classes/images/main/coach.gif" border=0 hspace=0 vspace=0 height=20 width=81 alt=Тьютор></td>

<td><a href="javascript:if(confirm('http://webclass.polyn.kiae.su/classes/fsub.htm  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://webclass.polyn.kiae.su/classes/fsub.htm'" tppabs="http://webclass.polyn.kiae.su/classes/fsub.htm"><img src="lcheck.gif" tppabs="http://webclass.polyn.kiae.su/classes/images/main/lcheck.gif" border=0 hspace=0 vspace=0 height=20 width=74 alt=Подписка></a></td>

</tr>

</table>

</div>



<!-- Конец главного меню -->



<!-- Навигационное дерево -->



<div class=navy>
<table border=0 cellspacing=0 cellpadding=0 width=560>
<tr>
<td height=15 class=tree>
<a class=tree href="javascript:if(confirm('http://webclass.polyn.kiae.su/classes/homef.htm  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://webclass.polyn.kiae.su/classes/homef.htm'" tppabs="http://webclass.polyn.kiae.su/classes/homef.htm">Web-инжиниринг(Оглавление)</a>
</td>
<tr>
<td height=15 class=tree>
<img src="treetc-1.gif" tppabs="http://webclass.polyn.kiae.su/classes/images/main//treetc.gif" border=0 hspace=2 align=top width=15 height=15 vspace=0>
Объектная модель в World Wide Web. Динамический HTML
</td>
</tr>
<tr>
<td height=15 class=tree>
<img name=down src="treevl.gif" tppabs="http://webclass.polyn.kiae.su/classes/images/main/treevl.gif" border=0 hspace=2 align=top width=15 height=15 vspace=0>
<img src="treetc.gif" tppabs="http://webclass.polyn.kiae.su/classes/images/main/treetc.gif" border=0 hspace=2 align=top width=15 height=15 vspace=0>
<a class=tree id=current href="treejsi.htm" tppabs="http://webclass.polyn.kiae.su/classes/jsi/treejsi.htm">Введение в JavaScript</a>
</td>
</tr>
</table>
</div>

<!-- Конец навигационного дерева -->



<!-- Меню последовательного просмотра -->



<div class=next>



<map name=top_menu>



<area shape=rect coords="500,0,560,15" href="hform.htm" tppabs="http://webclass.polyn.kiae.su/classes/jsi/hform.htm">



</map>



<img src="menu_l.gif" tppabs="http://webclass.polyn.kiae.su/classes/images/main/menu_l.gif" width=560 height=15 vspace=0 hspace=0 border=0 usemap=#top_menu>



</div>



<!-- Конец меню последовательного просмотра -->



<!-- Начало текста документа -->



<div class=main name=main>



<a name=top></a>



<span class=myheader>Управление фокусом</span>



<p class=just>



<span class=letter>Ф</span>окус - это характеристика текущего окна, фрейма или поля формы. В каждом из разделов, описывающем программирование этих объектов мы так или иначе касаемся вопроса фокуса. Под фокусом понимают возможность активации свойств и методов объекта. Например, окно в фокусе, если оно является текущим окном, т.е. лежит поверх всех других окон, и исполняются его методы или можно получить доступ к его свойствам.



<p class=just>



В данном разделе мы рассмотрим управление фокусом в:



<ul>



<li><a href=#window>окнах</a>



<li><a href=#frame>фреймах</a>



<li><a href=#fform>полях формы</a>



</ul>



<p class=just>



совместно. Следует сразу заметить, что фреймы - это тоже объекты класса Window, и многие решения, разработанные для окон справедливы и для фреймов.



<a name=window></a>



<p><em>Управляем фокусом в окнах</em>



<p class=just>



Для управления фокусом у объекта класса окно существуют два метода focus() и blur(). Первый передает фокус в окно, в то время как второй фокус из окна убирает. Рассмотрим простенький пример:



<p><span class=tags>



function hide_window()<br>



{<br>



wid=window.open("","kuku","width=400,height=200");<br>



wid.opener.focus();<br>



wid.document.open();<br>



...



wid.document.close();<br>



}<br>



<script>



function hide_window()



{



wid=window.open("","kuku","width=400,height=200");



wid.opener.focus();



wid.document.open();



wid.document.write("<html><head></head><body bgcolor=whitesmoke><center>");



wid.document.write("<form><input type=button value='Close the window' onClick='window.close()';></form>");



wid.document.write("</center></body></html>");



wid.document.close();



}



</script>



<form><input type=button value="Скрытое окно" onClick="hide_window();"></form>



</span>



<p class=just>



В данном примере новое окно сразу после своего открытия теряет фокус. Прячется за основным окном-родителем. Если при первичном нажатии на кнопку оно еще всплывает и только после этого прячется, то при повторном нажатии пользователь не видит появления нового окна, т.к. оно уже открыто и меняется только его содержание.



<p class=just>



Для того чтобы этого не происходило нужно после открытия передавать фокус на новое окно:



<p><span class=tags>



function visible_window()<br>



{<br>



wid=window.open("","kuku","width=400,height=200");<br>



wid.focus();<br>



wid.document.open();<br>



...



wid.document.close();<br>



}<br>



<script>



function visible_window()



{



wid=window.open("","kuku","width=400,height=200");



wid.focus();



wid.document.open();



wid.document.write("<html><head></head><body bgcolor=whitesmoke><center>");



wid.document.write("<form><input type=button value='Close the window' onClick='window.close()';></form>");



wid.document.write("</center></body></html>");



wid.document.close();



}



</script>



<form><input type=button value="Видимое окно" onClick="visible_window();"></form>



</span>



<p class=just>



Если теперь нажимать попеременно кнопки "Скрытое окно" и "Видимое окно", то окно то будет появляться, то исчезать. При этом новых окон не появляется, т.к. с одним и тем же именем может быть открыто только одно окно.



<p class=just>



Невидимое окно может доставить неприятности пользователю, из которых самая безобидная - отсутствие реакции на его действия. Код просто записывается в невидимое окно. Но ведь в скрытом окне можно что-нибудь и запустить. Для этого стоит только проверить, существует ли данное окно или нет, и если оно есть и не в фокусе, то активировать в нем какую-нибудь программу.



<p class=just>



Для реализации такого сценария достаточно использовать метод окна onblur(). Его можно также задать в контейнере BODY в качестве обработчика события onBlur, но в этом случае он видим пользователю. Мы воспользуемся этим методом в лоб:



<p><span class=tags>



window.onblur = new Function("window.defaultStatus = 'Background started...';");<br>



window.onfocus = new Function("window.defaultStatus = 'Document:Done';");<br>



<script>



window.onblur = new Function("window.defaultStatus = 'Background started...';");



window.onfocus = new Function("window.defaultStatus = 'Document:Done';");



</script>



<form><input type=button value="Видимое окно" onClick="visible_window();"></form>



</span>



<p class=just>



Обратите внимание на поле статуса браузера. Оно демонстрирует возможность выполнения функции в фоновом режиме. Кроме того onblur() в этом виде не отрабатывает в Exlorer. Причина кроется в прототипе объекта и возможности его переназначения программистом.

<p class=just>

Конечно, когда придумывали всю эту конструкцию думали не о том, как насолить пользователю, а о том как сократить ресурсы, необходимые браузеру для отображения нескольких окон. Ведь можно выполнить все то же самое с точностью до наоборот: запускать, например часы в фокусе и останавливать их в фоне. Но этот пример мы рассмотрим в контексте фреймов.



<!-- В начало страницы -->



<p align=right><a href=#top class=tree id=home><img src="treeup.gif" tppabs="http://webclass.polyn.kiae.su/classes/images/main/treeup.gif" border=0 align=top hspace=2><br>начало страницы<img src="treeru.gif" tppabs="http://webclass.polyn.kiae.su/classes/images/main/treeru.gif" border=0 align=top hspace=2></a><br>



<!-- Конец перехода -->



<a name=frame></a>



<p><em>Управление фокусом во фреймах</em>



<p class=just>



Фрейм - это такое же окно, как и само окно браузера. Точнее - это объект того же класса. К нему применимы те же методы, что и к обычному объекту окно:



<p><span class=tags>



var flag=1;<br>



function clock()<br>



{<br>



 if(flag==0)<br>



   {<br>



    d=new Date();<br>



    s=d.getHours()+':'+d.getMinutes()+':'+d.getSeconds();<br>



    window.document.forms[0].elements[0].value=s;<br>



   }<br>



 setTimeout('clock();',100);<br>



}<br>



window.onblur = new Function('this.flag = 1;');<br>



window.onfocus = new Function('this.flag = 0;');<br>



window.onload = clock;<br>



<script>



function fr()



{



 wid=window.open("","kuku","width=400,height=100");



 wid.focus();



 wid.document.open();



 wid.document.write("<html><head>");



 wid.document.write("</head>");



 wid.document.write("<frameset cols='50%,*' border=0>");



 wid.document.write("<frame name=left src='focus1.htm'/*tpa=http://webclass.polyn.kiae.su/classes/jsi/focus1.htm*/>");



 wid.document.write("<frame name=right src='focus1.htm'/*tpa=http://webclass.polyn.kiae.su/classes/jsi/focus1.htm*/>");



 wid.document.write("</frameset>");



 wid.document.write("</html>");



 wid.document.close();



}



</script>



<form><input type=button value="Окно с фреймами" onClick="fr();"></form>



</span>



<p class=just>



Данный фрагмент кода размещен в каждом из двух фреймов, которые отображаются в примере. А их ровно два. Просто ширина границы набора фреймов установлена в 0. Если окно примера разделить мысленно примерно пополам и "кликнуть" мышью в одну из половин, то пойдут часы в этой половине. Если теперь переместиться в другой фрейм и "кликнуть" мышью в нем, то часы пойдут в поле формы этого фрейма, а в другом фрейме остановятся.



<!-- В начало страницы -->



<p align=right><a href=#top class=tree id=home><img src="treeup.gif" tppabs="http://webclass.polyn.kiae.su/classes/images/main/treeup.gif" border=0 align=top hspace=2><br>начало страницы<img src="treeru.gif" tppabs="http://webclass.polyn.kiae.su/classes/images/main/treeru.gif" border=0 align=top hspace=2></a><br>



<!-- Конец перехода -->



<a name=fform></a>



<p><em>Фокус в полях формы</em>



<p class=just>



Управление фокусом в полях формы кроме этого раздела изложено еще и в разделе <a href="input.htm#input" tppabs="http://webclass.polyn.kiae.su/classes/jsi/input.htm#input">"Текст в полях ввода"</a>. Здесь мы рассматриваем этот вопрос в контексте общего применения методов blur() и focus(). Эти методы определены для любого поля формы, а не только для полей ввода. Рассмотрим простой пример:



<form>



<table border=0>



<tr>



<td>Фамилия:</td><td><input value='Иванов' onFocus="this.blur();"></td>



</tr>



<tr>



<td>Имя:</td><td><input value='Иван' onFocus="this.blur();"></td>



</tr>



<tr>



<td>Отчество:</td><td><input value='Иванович' onFocus="this.blur();"></td>



</tr>



<tr>



<td>Пол:</td><td><select onFocus="this.blur();"><option>мужской<option selected>женский</select></td>



</tr>



</table>



<p class=just>



Попробуйте изменить в этой форме значение любого из полей. Вряд ли это будет возможно. Обработчик события Focus (onFocus) уводит фокус из поля на произвольное место страницы.



<!-- В начало страницы -->



<p align=right><a href=#top class=tree id=home><img src="treeup.gif" tppabs="http://webclass.polyn.kiae.su/classes/images/main/treeup.gif" border=0 align=top hspace=2><br>начало страницы<img src="treeru.gif" tppabs="http://webclass.polyn.kiae.su/classes/images/main/treeru.gif" border=0 align=top hspace=2></a><br>



<!-- Конец перехода -->



<p><!-- Конец текста документа -->



<!-- Меню последовательного просмотра(нижнее) -->



<map name=bmenu>



<area shape=rect coords="0,0,60,15" href="state.htm" tppabs="http://webclass.polyn.kiae.su/classes/jsi/state.htm">



<area shape=rect coords="500,0,560,15" href="hform.htm" tppabs="http://webclass.polyn.kiae.su/classes/jsi/hform.htm">



</map>



<p>



<img src="bottom_l.gif" tppabs="http://webclass.polyn.kiae.su/classes/images/main/bottom_l.gif" border=0 width=560 height=15 border=0 usemap=#bmenu hspace=0 vspace=0><br>



<!-- Конец меню последовательного просмотра(нижнее) -->



<!-- Нижний логотип -->



<a href="javascript:if(confirm('http://www.citmgu.ru/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://www.citmgu.ru/'" tppabs="http://www.citmgu.ru/"><img src="bottom.gif" tppabs="http://webclass.polyn.kiae.su/classes/images/main/bottom.gif" border=0 width=560 height=15></a>
<!-- SpyLOG v2 f:0211 -->
<script language="javascript">
u="http://webclass.polyn.kiae.su/classes/jsi/u686.25.spylog.com";d=document;nv=navigator;na=nv.appName;p=1;
bv=Math.round(parseFloat(nv.appVersion)*100);
n=(na.substring(0,2)=="Mi")?0:1;rn=Math.random();z="p="+p+"&rn="+rn;y="";
y+="<a href='http://"+u+"/cnt?f=3&p="+p+"&rn="+rn+"' target=_blank>";
y+="<img src='http://"+u+"/cnt?"+z+"&r="+escape(d.referrer)+"&pg="+escape(window.location.href)+"' border=0  width=0 height=0  alt='SpyLOG'>";
y+="</a>"; d.write(y);if(!n) { d.write("<"+"!--"); }//--></script><noscript>
<a href="javascript:if(confirm('http://u686.25.spylog.com/cnt?f=3&p=1  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://u686.25.spylog.com/cnt?f=3&p=1'" tppabs="http://u686.25.spylog.com/cnt?f=3&p=1" target=_blank>
<img src="cnt-p=1" tppabs="http://u686.25.spylog.com/cnt?p=1" alt='SpyLOG' border='0'  width=0 height=0 >
</a></noscript><script language="javascript1.2"><!--
if(!n) { d.write("--"+">"); }//--></script>
<!-- SpyLOG  -->

<!-- Конец нижнего логотипа -->



</div>



</BODY>



</HTML>



