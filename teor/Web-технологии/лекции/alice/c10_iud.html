<html>
<title>Инструкции INSERT, UPDATE и DELETE</title>
<meta name=keywords content="СУБД реляционные базы данных SQL SELECT GROUP BY HAVING COUNT AVG SUM MIN MAX INSERT UPDATE DELETE">


<body>
<table align=center width=90%>
<tr><td>

<table align=center width=100%>
<tr>
<td width=33%><a href="c10_sel.html" tppabs="http://alice.stup.ac.ru/~dvn/uproc/books/site_tarasov/c10_sel.html">Инструкция SELECT</a>
<td width=33% align=center><a href="index.html" tppabs="http://alice.stup.ac.ru/~dvn/uproc/books/site_tarasov/index.html">Оглавление</a>
<td width=33% align=right><a href="c10_agr.html" tppabs="http://alice.stup.ac.ru/~dvn/uproc/books/site_tarasov/c10_agr.html">Агрегирующие функции</a>
</table>




  <h3>INSERT, UPDATE и DELETE</h3>
  Вы научились получать информацию из базы данных, теперь мы переходим к вставке, редактированию
  и удалению данных. Эти операции производятся тремя инструкциями INSERT, UPDATE и DELETE соответственно.
  Рассмотрим их по порядку. Для проведения экспериментов нам понадобятся копии таблиц gb и message.
  Перейдите в раздел  "Таблицы", щелкните мышкой на таблице gb, в меню "Правка" выберите пункт
  "Копировать", а затем "Вставить". Сохраните таблицу вместе с данными под именем gb2.
  То же самое проделайте с таблицей message.
  Инструкция INSERT имеет следующий синтаксис:
  <pre>
  INSERT int имя_таблицы [ имя_столбца1 [, имя_столбца2] ...]
  VALUES ( значение1 [, значение2] ...)
  </pre>
  Для регистрации новой гостевой книги и вставки записи в таблицу gb мы будем использовать
  следующий запрос: INSERT INTO gb2 (name, http, email, quantity, description, it_date)
VALUES('Vasya Pupkin', 'pupkin.ru', 'pupkin@pupkin.ru', 7, 'Гостевая книга для сайта Васи Пупкина', NOW()).
Этот запрос вставляет в таблицу gb2 новую запись. Обратите внимание, как вставляется дата.
В базе данных есть ряд функций, которые можно использовать в SQL-запросах. Функция NOW(), как вы
догадались, возвращает текущее время. Список функций зависит от конкретной СУБД, наиболее
распространенные будут рассмотрены в этой книге. Инструкция UPDATE - редактирование
группы  записей -  имеет следующий синтаксис:
<pre>
UPDATE имя_таблицы 
SET имя_столбца1=значение1, имя_столбца2=значение2, ... 
WHERE условие
</pre>
Например, мы хотим изменить адрес электронной почты и количество записей, выводимых на одной странице для
гостевой книги Васи Пупкина. Это можно сделать командой UPDATE gb2 SET email='vasya@itsoft.ru', quantity=9 WHERE gb_id=25
или UPDATE gb2 SET email='vasya@itsoft.ru', quantity=9 WHERE name='Vasya Pupkin'.
Первый SQL-запрос более правильный, он изменит значения ячеек записи с идентификатором 25.
Второй запрос изменит все записи, у которых в поле name стоит Vasya Pupkin. 
Будьте осторожны, не забывайте писать условия, иначе будут модифицированы все записи.
И наконец, последняя инструкция DELETE - удаление группы записей, ее синтаксис:
<pre>
DELETE FROM имя_таблицы WHERE условие
</pre>
Для того чтобы удалить гостевую книгу Васи Пупкина, дайте команду
DELETE FROM gb2 WHERE gb_id=25. Если вы забудете указать условие, то будут удалены все записи.
Дайте команду DELETE FROM gb2, и все записи будут удалены. Выполните эту команду.
А теперь восстановим данные при помощи инструкции INSERT. Дело в том, что инструкцию INSERT
можно использовать совместно с инструкцией SELECT: INSERT INTO gb2 SELECT * FROM gb. 
Выполните эту команду, и все записи будут восстановлены.

<h3>Упражнения</h3>
Напишите SQL-запросы:
<ol>
<li> Добавления своей гостевой книги.
<li> Изменения количества выводимых сообщений на страницу с 10 штук на 9.
<li> Удаления записей с пустыми полями name или email или description.
<li> Добавления сообщения в свою гостевую книгу, т.е. вставки записи в таблицу message2.
<li> Редактирования сообщения из своей гостевой книги.
<li> Удаления сообщения из своей гостевой книги.
<li> Удаления гостевой своей гостевой книги.
</ol>

  
  
</td></tr>
</table>
<table width="700" border="0" cellspacing="0" cellpadding="0" align="center" bgcolor="#FFFFFF">
  <tr> 
    <td align="left" rowspan="2" valign=bottom>
    <a href="javascript:if(confirm('http://rb2.design.ru/cgi-bin/href/itsoft?6367  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://rb2.design.ru/cgi-bin/href/itsoft?6367'" tppabs="http://rb2.design.ru/cgi-bin/href/itsoft?6367" target=_top>
    <img src="itsoft-6367" tppabs="http://rb2.design.ru/cgi-bin/banner/itsoft?6367" width=100 height=100 border=0 alt="RB2 Network.">
    </a>
    <td align="center">

<script language="JavaScript">js=10;</script><script language="JavaScript1.1">
js=11;</script><script language="JavaScript1.2">js=12</script>
<script language="JavaScript1.3">js=13;</script>

<script language="JavaScript">
d=document;n=navigator;s=screen;d.cookie="testparam=testvalue";
d.write('<img width=1 height=1 src="http://itsoft.ru/common/counter?id=1' +
'&r='+escape(d.referrer)+
'&n='+escape(n.appName)+
'&v='+escape(navigator.appVersion)+
'&c='+(d.cookie?"1":"0")+
'&f='+((self!=top)?"1":"0")+
'&j='+(n.javaEnabled()?"1":"0")+
'&x='+s.width+
'&y='+s.height+
'&d='+(s.colorDepth?s.colorDepth:s.pixelDepth)+
'&js='+js+
'&o='+n.platform+'&'+Math.random()+'">');
</script>


<!--TopList COUNTER--> 
      <script language="JavaScript" type="text/javascript"><!--
d=document;js=10;a='';a+=';r='+escape(d.referrer)
//--></script>
      <script language="JavaScript1.1" type="text/javascript"><!--
js=11;a+=';j='+navigator.javaEnabled()
//--></script>
      <script language="JavaScript1.2" type="text/javascript"><!--
js=12;s=screen;a+=';s='+s.width+'*'+s.height
a+=';d='+(s.colorDepth?s.colorDepth:s.pixelDepth)
//--></script>
      <script language="JavaScript1.3" type="text/javascript"><!--
js=13//--></script>
      <script language="JavaScript" type="text/javascript"><!--
d.write('<img src="http://top.list.ru/counter'+
'?id=50234;js='+js+a+'" alt="" height=1 width=1>')
if(js>11)d.write('<'+'!-- ')//--></script>
      <noscript><img
src="counter-js=na;id=50234" tppabs="http://top.list.ru/counter?js=na;id=50234"
height=1 width=1 alt=""></noscript> 
      <script language="JavaScript" type="text/javascript"><!--
if(js>11)d.write('--'+'>')
//--></script>
      <!--TopList COUNTER-->

</td>
<td align="right"  rowspan="2" valign=bottom>
    <a href="javascript:if(confirm('http://rb2.design.ru/cgi-bin/href/itsoft?6367  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://rb2.design.ru/cgi-bin/href/itsoft?6367'" tppabs="http://rb2.design.ru/cgi-bin/href/itsoft?6367" target=_top>
    <img src="itsoft-6367" tppabs="http://rb2.design.ru/cgi-bin/banner/itsoft?6367" width=100 height=100 border=0 alt="RB2 Network.">
    </a>
    
</td>
  </tr>
<tr><td align="center" style="font-size:9px; font-family:Verdana, Arial, Helvetica, sans-serif;">
<iframe src="itsoft-6367-1" tppabs="http://rb1.rotabanner.com/cgi-bin/iframe/itsoft?6367"
 width=468 height=60 marginwidth=0 marginheight=0 scrolling=no 
 frameborder=0><a href="javascript:if(confirm('http://rb1.rotabanner.com/cgi-bin/href/itsoft?6367  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?'))window.location='http://rb1.rotabanner.com/cgi-bin/href/itsoft?6367'" tppabs="http://rb1.rotabanner.com/cgi-bin/href/itsoft?6367" 
 target=_top><img src="itsoft-6367-2" tppabs="http://rb1.rotabanner.com/cgi-bin/banner/itsoft?6367" 
 alt="RB1" width=468 height=60 border=0 ismap></a></iframe>

</body>
</html>