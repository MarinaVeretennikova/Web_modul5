<html>
<title>Инструкция SELECT</title>
<meta name=keywords content="СУБД реляционные базы данных SQL SELECT GROUP BY HAVING COUNT AVG SUM MIN MAX INSERT UPDATE DELETE">


<body>
<table align=center width=90%>
<tr><td>

<table align=center width=100%>
<tr>
<td width=33%><a href="c10_sql.html" tppabs="http://alice.stup.ac.ru/~dvn/uproc/books/site_tarasov/c10_sql.html">Язык SQL</a>
<td width=33% align=center><a href="index.html" tppabs="http://alice.stup.ac.ru/~dvn/uproc/books/site_tarasov/index.html">Оглавление</a>
<td width=33% align=right><a href="c10_iud.html" tppabs="http://alice.stup.ac.ru/~dvn/uproc/books/site_tarasov/c10_iud.html">Инструкции INSERT, UPDATE и DELETE</a>
</table>


 <h3>Инструкция SELECT</h3>
  Давайте выполним первый SQL-запрос. Для этого
  перейдите в раздел "Запросы". Выберите создание запроса в режиме
  конструктора. В появившемся диалоговом окне 
  <img src="c10dlg.jpg" tppabs="http://alice.stup.ac.ru/~dvn/uproc/books/site_tarasov/images/c10dlg.jpg">
  <p align="justify">
  нажмите кнопку "Закрыть". Далее в меню "Вид" выберите пункт "Режим SQL". У вас должно появится
  на экране окно для ввода SQL запросов. Введите: 
  SELECT * FROM message WHERE gb_id=1. В меню "Запрос" выберите пункт "Запуск" или нажмите иконку
  с восклицательным знаком на экране. 
  Появится результат обработки этого запроса. 
  <img src="c10sq.jpg" tppabs="http://alice.stup.ac.ru/~dvn/uproc/books/site_tarasov/images/c10sq.jpg">
  <p align="justify">
  Это таблица, содержащая все сообщения, относящиеся к 
  гостевой книге с идентификатором 1. Как вы видите, некоторые столбцы не содержат полезной
  информации. Оператор SELECT позволяет указать нужные нам столбцы. С помощью меню "Вид->РежимSQL"
  вернитесь в предыдущее окно и введите SELECT message_id as id,name, http, email, subj, it_text, it_date FROM message WHERE gb_id=1.
  Нажмите "Выполнить запрос" и вы увидите теперь только перечисленные столбцы. Обратите внимание, что
  мы переименовали первый столбец. Он показывается под именем id, а не message_id.
  Теперь, давайте отсортируем по дате в порядке убывания: SELECT message_id as id,name, http, 
  email, subj, it_text, it_date FROM message WHERE gb_id=1 ORDER BY it_date DESC.
  <img src="c10sq.jpg" tppabs="http://alice.stup.ac.ru/~dvn/uproc/books/site_tarasov/images/c10sq.jpg">
  <p align="justify">
  
  Язык SQL довольно простой и интуитивно понятный. Рассмотрим синтаксис инструкции SELECT в общем случае.
  <pre>
  SELECT [DICTINCT] имя_столбца [as новое_имя], имя_столбца2 [as новое_имя2], ...
  FROM таблица1 | имя_курсора1, таблица2 | имя_курсора2, ...
  [WHERE условие]
  [GROUP BY имя_столбца1, имя_столбца2, ...]
    [HAVING условие]
  [ORDER BY имя_столбца1 [DESC], имя_столбца2 [DESC2], ...]  
  </pre>
  
  <p align="justify">
   О курсорах, GROUP BY и HAVING будет рассказано чуть позже, после того, как вы познакомитесь с
   инструкциями добавления, редактирования и удаления данных. А пока
   рассмотрим на частных примерах использование инструкции SELECT во всех остальных случаях.
   Начнем с ключевого слова DISTINCT. Использование этого атрибута позволяет нам
   избежать повторяющихся записей. Допустим, мы хотим посмотреть всех авторов сообщений во 
   всех гостевых книгах: SELECT name, http, email FROM message ORDER BY name.
   Обратите внимание, что теперь нет фильтра - инструкции WHERE, т.к. нас интересуют абсолютно 
   все сообщения, вернее их авторы. Сортировка стоит по имени автора сообщения. Нас интересует сортировка
   по алфавиту(от меньшего к большему), поэтому атрибут DESC, который означает сортировать в обратном порядке мы
   не указываем. Результатом этого запроса будет таблица:
   <img src="c10sq2.jpg" tppabs="http://alice.stup.ac.ru/~dvn/uproc/books/site_tarasov/images/c10sq2.jpg">
  <p align="justify">
   Вы видите, что в результате мы получили повторяющиеся записи, т.к. один человек мог написать
   несколько сообщений. Теперь добавьте слово DISTINCT: SELECT DISTINCT  name, http, email FROM message ORDER BY name,
   и вы увидите, что дублей больше нет.
   <img src="c10sq3.jpg" tppabs="http://alice.stup.ac.ru/~dvn/uproc/books/site_tarasov/images/c10sq3.jpg">
   
  <p align="justify">
  Наиболее интересным и сложным является инструкция WHERE. 
  Мы будем рассматривать инструкцию: 
  SELECT gb_id as id, name, quantity as q, description, it_date  FROM gb,
  т.е. выборку идентификаторов гостевых книг,  владельцев, количества сообщений, выводимых 
  на одну страницу, описание и дату. Некоторые условия не имеют какого-либо осмысленного
  описания. Они приводятся в демонстративных целях. 
   Для задания условия можно 
  использовать:
  <ul>
  <li> Операторы + - * / = < <= > >= <> !=.  WHERE (gb_id+2)/2=10.
  <li> Комбинирование условий AND OR NOT. WHERE gb_id=1 OR NOT quantity=10.
  <li> Диапазоны: BETWEEN, NOT BETWEEN. WHERE gb_id NOT  BETWEEN 10 AND 15.
  <li> Списки: IN, NOT IN. WHERE name IN ('Игорь Тарасов', 'Евгений').
  <li> Нулевые значения: IS NULL, IS NOT NULL. WHERE name IS NULL
  <li> Поиск по подстрокам: LIKE, NOT LIKE.  WHERE description LIKE '*книга*'. 
  Звездочка обозначает любое количество символов. В большинстве баз данных используется %,
  а не звездочка, как в MS Access.
  </ul>
  Выполните все приведенные примеры, поварьируйте параметры, чтобы лучше усвоить материал.
  <h3>Упражнения</h3>
  Напишите следующие запросы:
  <ol>
  <li> Выбрать из таблицы гостевых книг все записи.
  <li> --"-- все записи, кроме столбца description.
  <li> --"-- записи с идентификатором больше 10 и количеством страниц выводимых на страницу равным 10.
  <li> --"-- записи с непустым адресом электронной почты.
  <li> --"-- записи с непустым адресом электронной почты или полем http, но чтобы их
   идентификатор был больше 1 и не больше 5 или же не меньше 12 и меньше 19, сортировка должна 
   производится по полям http, email
  <li> Придумайте сами 20 запросов к таблице message и опубликуйте их в нашем форуме на сайте http://itsoft.ru.  
  </ol> 
  
  
</td></tr>
</table>
<table width="700" border="0" cellspacing="0" cellpadding="0" align="center" bgcolor="#FFFFFF">
  <tr> 
    <td align="left" rowspan="2" valign=bottom>
<!-- Russian LinkExchange code START - BANNER #1 (100x100)-->
  <iframe src="erle.cgi-69019-bn=0-6674" tppabs="http://10e2.linkexchange.ru/cgi-bin/erle.cgi?69019-bn=0?6674" 
  frameborder=0 vspace=0 hspace=0 width=100 height=100 
  marginwidth=0 marginheight=0 scrolling=no>
  <a href="javascript:if(confirm('http://10e2.linkexchange.ru/users/069019/goto.map?bn=0  \n\nThis file was not retrieved by Teleport Pro, because it did not meet the project\'s file type specifications.  \n\nDo you want to open it from the server?'))window.location='http://10e2.linkexchange.ru/users/069019/goto.map?bn=0'" tppabs="http://10e2.linkexchange.ru/users/069019/goto.map?bn=0" target=_top> 
  <img src="rle.cgi-69019-bn=0-6674" tppabs="http://10e2.linkexchange.ru/cgi-bin/rle.cgi?69019-bn=0?6674"
  alt="RLE Banner Network" border=0 height=100 width=100></a> 
  </iframe> 
<!-- Russian LinkExchange code END --> 
    <td align="center">

<script language="JavaScript">js=10;</script><script language="JavaScript1.1">
js=11;</script><script language="JavaScript1.2">js=12</script>
<script language="JavaScript1.3">js=13;</script>

<script language="JavaScript">
d=document;n=navigator;s=screen;d.cookie="testparam=testvalue";
d.write('<img width=1 height=1 src="http://itsoft.ru/common/counter?id=1' +
'&r='+escape(d.referrer)+
'&n='+escape(n.appName)+
'&v='+escape(navigator.appVersion)+
'&c='+(d.cookie?"1":"0")+
'&f='+((self!=top)?"1":"0")+
'&j='+(n.javaEnabled()?"1":"0")+
'&x='+s.width+
'&y='+s.height+
'&d='+(s.colorDepth?s.colorDepth:s.pixelDepth)+
'&js='+js+
'&o='+n.platform+'&'+Math.random()+'">');
</script>


<!--TopList COUNTER--> 
      <script language="JavaScript" type="text/javascript"><!--
d=document;js=10;a='';a+=';r='+escape(d.referrer)
//--></script>
      <script language="JavaScript1.1" type="text/javascript"><!--
js=11;a+=';j='+navigator.javaEnabled()
//--></script>
      <script language="JavaScript1.2" type="text/javascript"><!--
js=12;s=screen;a+=';s='+s.width+'*'+s.height
a+=';d='+(s.colorDepth?s.colorDepth:s.pixelDepth)
//--></script>
      <script language="JavaScript1.3" type="text/javascript"><!--
js=13//--></script>
      <script language="JavaScript" type="text/javascript"><!--
d.write('<img src="http://top.list.ru/counter'+
'?id=50234;js='+js+a+'" alt="" height=1 width=1>')
if(js>11)d.write('<'+'!-- ')//--></script>
      <noscript><img
src="counter-js=na;id=50234" tppabs="http://top.list.ru/counter?js=na;id=50234"
height=1 width=1 alt=""></noscript> 
      <script language="JavaScript" type="text/javascript"><!--
if(js>11)d.write('--'+'>')
//--></script>
      <!--TopList COUNTER-->

</td>
<td align="right"  rowspan="2" valign=bottom>
<!-- Russian LinkExchange code START - BANNER #2 (100x100)-->
  <iframe src="erle.cgi-69019-bn=1-Rnd_Num" tppabs="http://10e2.linkexchange.ru/cgi-bin/erle.cgi?69019-bn=1?Rnd_Num" 
  frameborder=0 vspace=0 hspace=0 width=100 height=100 
  marginwidth=0 marginheight=0 scrolling=no>
  <a href="javascript:if(confirm('http://10e2.linkexchange.ru/users/069019/goto.map?bn=1  \n\nThis file was not retrieved by Teleport Pro, because it did not meet the project\'s file type specifications.  \n\nDo you want to open it from the server?'))window.location='http://10e2.linkexchange.ru/users/069019/goto.map?bn=1'" tppabs="http://10e2.linkexchange.ru/users/069019/goto.map?bn=1" target=_top> 
  <img src="rle.cgi-69019-bn=1-Rnd_Num" tppabs="http://10e2.linkexchange.ru/cgi-bin/rle.cgi?69019-bn=1?Rnd_Num" 
  alt="RLE Banner Network" border=0 height=100 width=100></a> 
  </iframe> 
<!-- Russian LinkExchange code END --> 
    
</td>
  </tr>
<tr><td align="center" style="font-size:9px; font-family:Verdana, Arial, Helvetica, sans-serif;">
<iframe src="erle.cgi-51599-6674" tppabs="http://www.linkexchange.ru/cgi-bin/erle.cgi?51599?6674" frameborder=0 
    vspace=0 hspace=0 width=468 height=60 marginwidth=0 marginheight=0 scrolling=no>
    <a href="javascript:if(confirm('http://www.linkexchange.ru/users/goto.map  \n\nThis file was not retrieved by Teleport Pro, because it did not meet the project\'s file type specifications.  \n\nDo you want to open it from the server?'))window.location='http://www.linkexchange.ru/users/goto.map'" tppabs="http://www.linkexchange.ru/users/goto.map" target=_top>
    <img src="rle.cgi-51599-6674" tppabs="http://www.linkexchange.ru/cgi-bin/rle.cgi?51599?6674" alt="RLE Banner Network" border=0 height=60 width=468></a>
    </iframe>

<!-- Russian LinkExchange code START - BANNER #1 (120x60)-->
  <iframe src="erle.cgi-69021-bn=0-6674" tppabs="http://btn2.linkexchange.ru/cgi-bin/erle.cgi?69021-bn=0?6674"
  frameborder=0 vspace=0 hspace=0 width=120 height=60 
  marginwidth=0 marginheight=0 scrolling=no>
  <a href="javascript:if(confirm('http://btn2.linkexchange.ru/users/069021/goto.map?bn=0  \n\nThis file was not retrieved by Teleport Pro, because it did not meet the project\'s file type specifications.  \n\nDo you want to open it from the server?'))window.location='http://btn2.linkexchange.ru/users/069021/goto.map?bn=0'" tppabs="http://btn2.linkexchange.ru/users/069021/goto.map?bn=0" target=_top> 
  <img src="rle.cgi-69021-bn=0-6674" tppabs="http://btn2.linkexchange.ru/cgi-bin/rle.cgi?69021-bn=0?6674"
  alt="RLE Banner Network" border=0 height=60 width=120></a> 
  </iframe> 
<!-- Russian LinkExchange code END --> 
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
<!-- Russian LinkExchange code START - BANNER #2 (120x60)-->
  <iframe src="erle.cgi-69021-bn=1-6674" tppabs="http://btn2.linkexchange.ru/cgi-bin/erle.cgi?69021-bn=1?6674"
  frameborder=0 vspace=0 hspace=0 width=120 height=60 
  marginwidth=0 marginheight=0 scrolling=no>
  <a href="javascript:if(confirm('http://btn2.linkexchange.ru/users/069021/goto.map?bn=1  \n\nThis file was not retrieved by Teleport Pro, because it did not meet the project\'s file type specifications.  \n\nDo you want to open it from the server?'))window.location='http://btn2.linkexchange.ru/users/069021/goto.map?bn=1'" tppabs="http://btn2.linkexchange.ru/users/069021/goto.map?bn=1" target=_top> 
  <img src="rle.cgi-69021-bn=1-6674" tppabs="http://btn2.linkexchange.ru/cgi-bin/rle.cgi?69021-bn=1?6674"
  alt="RLE Banner Network" border=0 height=60 width=120></a> 
  </iframe> 
<!-- Russian LinkExchange code END --> 
</td></tr>
</table>

</body>
</html>